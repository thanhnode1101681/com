(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],2:[function(require,module,exports){(function(global,setImmediate){!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n():"function"==typeof define&&define.amd?define(n):n()}(0,function(){"use strict";function e(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){return n.reject(t)})})}function n(){}function t(e){if(!(this instanceof t))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],u(e,this)}function o(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,t._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var o;try{o=t(e._value)}catch(f){return void i(n.promise,f)}r(n.promise,o)}else(1===e._state?r:i)(n.promise,e._value)})):e._deferreds.push(n)}function r(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if(n instanceof t)return e._state=3,e._value=n,void f(e);if("function"==typeof o)return void u(function(e,n){return function(){e.apply(n,arguments)}}(o,n),e)}e._state=1,e._value=n,f(e)}catch(r){i(e,r)}}function i(e,n){e._state=2,e._value=n,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&t._immediateFn(function(){e._handled||t._unhandledRejectionFn(e._value)});for(var n=0,r=e._deferreds.length;r>n;n++)o(e,e._deferreds[n]);e._deferreds=null}function u(e,n){var t=!1;try{e(function(e){t||(t=!0,r(n,e))},function(e){t||(t=!0,i(n,e))})}catch(o){if(t)return;t=!0,i(n,o)}}var c=setTimeout;t.prototype["catch"]=function(e){return this.then(null,e)},t.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new function(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}(e,t,r)),r},t.prototype["finally"]=e,t.all=function(e){return new t(function(n,t){function o(e,f){try{if(f&&("object"==typeof f||"function"==typeof f)){var u=f.then;if("function"==typeof u)return void u.call(f,function(n){o(e,n)},t)}r[e]=f,0==--i&&n(r)}catch(c){t(c)}}if(!e||"undefined"==typeof e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return n([]);for(var i=r.length,f=0;r.length>f;f++)o(f,r[f])})},t.resolve=function(e){return e&&"object"==typeof e&&e.constructor===t?e:new t(function(n){n(e)})},t.reject=function(e){return new t(function(n,t){t(e)})},t.race=function(e){return new t(function(n,t){for(var o=0,r=e.length;r>o;o++)e[o].then(n,t)})},t._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){c(e,0)},t._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var l=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"Promise"in l?l.Promise.prototype["finally"]||(l.Promise.prototype["finally"]=e):l.Promise=t})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("timers").setImmediate)},{timers:3}],3:[function(require,module,exports){(function(setImmediate,clearImmediate){var nextTick=require("process/browser.js").nextTick;var apply=Function.prototype.apply;var slice=Array.prototype.slice;var immediateIds={};var nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)};exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)};exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()};function Timeout(id,clearFn){this._id=id;this._clearFn=clearFn}Timeout.prototype.unref=Timeout.prototype.ref=function(){};Timeout.prototype.close=function(){this._clearFn.call(window,this._id)};exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId);item._idleTimeout=msecs};exports.unenroll=function(item){clearTimeout(item._idleTimeoutId);item._idleTimeout=-1};exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;if(msecs>=0){item._idleTimeoutId=setTimeout(function onTimeout(){if(item._onTimeout)item._onTimeout()},msecs)}};exports.setImmediate=typeof setImmediate==="function"?setImmediate:function(fn){var id=nextImmediateId++;var args=arguments.length<2?false:slice.call(arguments,1);immediateIds[id]=true;nextTick(function onNextTick(){if(immediateIds[id]){if(args){fn.apply(null,args)}else{fn.call(null)}exports.clearImmediate(id)}});return id};exports.clearImmediate=typeof clearImmediate==="function"?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utilities_1=require("./Utilities");var CommunicationWrapper_1=require("./Wrappers/CommunicationWrapper");var GameFocusWrapper_1=require("./Wrappers/GameFocusWrapper");var GolWrapper_1=require("./Wrappers/GolWrapper");var ServiceWrapper_1=require("./Wrappers/ServiceWrapper");var DataManager=function(){function DataManager(){}DataManager.removeDebug=function(){$("#DebugTxt").remove();$("#DebugTxt").remove()};DataManager.adjustGameCode=function(gameCode){if(typeof gameCode!=="undefined"){switch(gameCode.toLowerCase()){case"SlotMachine_MermaidFortunes".toLowerCase():gameCode="SlotMachine_PreciousTreasures";break;case"SlotMachine_TwistedSlot".toLowerCase():gameCode="SlotMachine_ReelCircus";break;case"SlotMachine_UnreelFighters".toLowerCase():gameCode="SlotMachine_ReelFighters";break;case"SlotMachine_TabooSlot".toLowerCase():gameCode="SlotMachine_ForbiddenSlot";break;case"SlotMachine_PondOfKoi".toLowerCase():gameCode="SlotMachine_PondOfKoi";break;case"SlotMachine_WealthOfTheMonkey".toLowerCase():gameCode="SlotMachine_WealthOfTheMonkey";break;case"SlotMachine_StripToWin".toLowerCase():gameCode="SlotMachine_StripToWin";break;case"SlotMachine_PeonyLadies".toLowerCase():gameCode="SlotMachine_PeonyLadies";break;case"SlotMachine_EmpiresWarlords".toLowerCase():gameCode="SlotMachine_EmpiresWarlords";break;case"SlotMachine_JadeConnection".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.GameCodeIdentifier="SlotMachine_JadeConnection";break;case"SlotMachine_UndyingPassion".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.GameCodeIdentifier="SlotMachine_UndyingPassion";break;case"SlotMachine_YearOfLuck".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.GameCodeIdentifier="SlotMachine_YearOfLuck";break}}return gameCode};DataManager.adjustWinSpeed=function(){if(ServiceWrapper_1.ServiceWrapper.isWhow){switch(ServiceWrapper_1.ServiceWrapper.paramJson.GameCodeIdentifier.toLowerCase()){case"SlotMachine_LilithPassion".toLowerCase():case"SlotMachine_8LuckyCharmsXtreme".toLowerCase():case"SlotMachine_HuntingTreasures".toLowerCase():case"SlotMachine_HuntingTreasuresDeluxe".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.normalWinLengthFactor=.25;break;case"SlotMachine_SnowingLuck".toLowerCase():case"SlotMachine_RevivingLove".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.normalWinLengthFactor=.2;break;case"SlotMachine_WildHeist".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.normalWinLengthFactor=.4;break;case"SlotMachine_TikiRainbow".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.normalWinLengthFactor=.3;break;case"SlotMachine_DemiGods2".toLowerCase():ServiceWrapper_1.ServiceWrapper.paramJson.normalWinLengthFactor=.25;ServiceWrapper_1.ServiceWrapper.paramJson.bigWinLengthFactor=.5;break}if(ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode==="SlotMachine_HuntingTreasures"||ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode==="SlotMachine_HuntingTreasuresDeluxe"){ServiceWrapper_1.ServiceWrapper.paramJson.turboMode=1}if(ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode==="SlotMachine_HuntingTreasuresDeluxe"){ServiceWrapper_1.ServiceWrapper.paramJson.skipMainSplash=1}}};DataManager.init=function(){if(!DataManager.initiated){DataManager.initiated=true;DataManager.removeDebug();new GameFocusWrapper_1.GameFocusWrapper;var query=ServiceWrapper_1.ServiceWrapper.getUrlVars();if(!ServiceWrapper_1.ServiceWrapper.isNullOrEmpty(query["isReal"])){ServiceWrapper_1.ServiceWrapper.isReal=query["isReal"]}else{ServiceWrapper_1.ServiceWrapper.isReal=window.location.pathname.includes("Real")}ServiceWrapper_1.ServiceWrapper.gameToken=ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken;if(ServiceWrapper_1.ServiceWrapper.IsBspot){ServiceWrapper_1.ServiceWrapper.gameToken=BSpotWrapper.urlVars.gameToken}ServiceWrapper_1.ServiceWrapper.paramJson.IsUsingDebugTickets=Number(query["IsUsingDebugTickets"])===1?true:false;ServiceWrapper_1.ServiceWrapper.paramJson.langCode=ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage;ServiceWrapper_1.ServiceWrapper.paramJson.gameCode=ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode;if(ServiceWrapper_1.ServiceWrapper.IsBspot){ServiceWrapper_1.ServiceWrapper.paramJson.gameCode=BSpotWrapper.Model.GameCode}ServiceWrapper_1.ServiceWrapper.paramJson.GameCodeIdentifier=DataManager.adjustGameCode(ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode);ServiceWrapper_1.ServiceWrapper.paramJson.gameToken=ServiceWrapper_1.ServiceWrapper.gameToken;if(query["showgameloader"]==="true"||query["showgameloader"]===true){ServiceWrapper_1.ServiceWrapper.paramJson.showBrandedLoader=0}ServiceWrapper_1.ServiceWrapper.paramJson.platform=""+1;ServiceWrapper_1.ServiceWrapper.paramJson.allowChangeFullScreen=ServiceWrapper_1.ServiceWrapper.isFullScreenSupported()?1:0;if(ServiceWrapper_1.ServiceWrapper.isMobile()){ServiceWrapper_1.ServiceWrapper.paramJson.platform=""+2;ServiceWrapper_1.ServiceWrapper.paramJson.allowChangeFullScreen=0}if(GolWrapper_1.GolWrapper.isActive){ServiceWrapper_1.ServiceWrapper.paramJson.allowChangeFullScreen=0}ServiceWrapper_1.ServiceWrapper.paramJson.partnerId=ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId;if(!ServiceWrapper_1.ServiceWrapper.isNullOrEmpty(query["roulettePartnerId"])){ServiceWrapper_1.ServiceWrapper.paramJson.partnerId=query["roulettePartnerId"]}if(query["brandLogoUrl"]){ServiceWrapper_1.ServiceWrapper.paramJson.brandLogoUrl=decodeURIComponent(query["brandLogoUrl"])}if(ServiceWrapper_1.ServiceWrapper.paramJson.gameCode==="Table_EuropeanRoulette_BR"){ServiceWrapper_1.ServiceWrapper.paramJson.brandLogoUrl=ServiceWrapper_1.ServiceWrapper.ExternalComponentPath+"pics/logos/"+ServiceWrapper_1.ServiceWrapper.paramJson.partnerId+".png?rnd="+Utilities_1.Utilities.MakeId()}else if(ServiceWrapper_1.ServiceWrapper.paramJson.gameCode.startsWith("Table_")&&ServiceWrapper_1.ServiceWrapper.paramJson.gameCode.indexOf("Roulette")!==-1){ServiceWrapper_1.ServiceWrapper.paramJson.brandLogoUrl=ServiceWrapper_1.ServiceWrapper.ExternalComponentPath+"pics/logos/"+ServiceWrapper_1.ServiceWrapper.paramJson.gameCode+".png?rnd="+Utilities_1.Utilities.MakeId()}var home=query["HomeUrl"];if(typeof home!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.HomeUrl=decodeURIComponent(home);ServiceWrapper_1.ServiceWrapper.homeUrl=ServiceWrapper_1.ServiceWrapper.paramJson.HomeUrl}if(typeof query["historyUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.historyUrl=decodeURIComponent(query["historyUrl"])}if(typeof query["HistoryUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.historyUrl=decodeURIComponent(query["HistoryUrl"])}if(typeof query["CashierUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.CashierUrl=decodeURIComponent(query["CashierUrl"]);ServiceWrapper_1.ServiceWrapper.cashierUrl=ServiceWrapper_1.ServiceWrapper.paramJson.CashierUrl}if(typeof query["PlayForRealUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.PlayForRealUrl=decodeURIComponent(query["PlayForRealUrl"]);ServiceWrapper_1.ServiceWrapper.playForRealUrl=ServiceWrapper_1.ServiceWrapper.paramJson.PlayForRealUrl}if(typeof query["PlayForFunUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.PlayForRealUrl=decodeURIComponent(query["PlayForFunUrl"]);ServiceWrapper_1.ServiceWrapper.playForFunUrl=ServiceWrapper_1.ServiceWrapper.paramJson.PlayForFunUrl}if(typeof query["LobbyUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.LobbyUrl=decodeURIComponent(query["LobbyUrl"])}if(typeof query["mode"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.mode=query["mode"]}else{ServiceWrapper_1.ServiceWrapper.paramJson.mode=ServiceWrapper_1.ServiceWrapper.isInIframe?0:1}if(typeof query["baseUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.ReloadUrl=decodeURIComponent(query["baseUrl"])}if(typeof query["originalLangCode"]!=="undefined"&&!!query["originalLangCode"]){ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode=query["originalLangCode"]}if(typeof query["sound"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.soundOn=query["sound"]==="0"?0:1;ServiceWrapper_1.ServiceWrapper.IsSoundOn=!!ServiceWrapper_1.ServiceWrapper.paramJson.soundOn}if(typeof query["turbo"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.turboMode=query["turbo"]==="0"?0:1}if(query["partnerId"]==="pokermatch"){ServiceWrapper_1.ServiceWrapper.paramJson.turboMode=1}if(typeof query["externalId"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.externalId=query["externalId"]}if(typeof query["disableKeyboard"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.disableKeyboardInput=query["disableKeyboard"]==="1"?1:0}if(ServiceWrapper_1.ServiceWrapper.isWhow&&!ServiceWrapper_1.ServiceWrapper.isMobile()&&ServiceWrapper_1.ServiceWrapper.paramJson.turboMode===0&&ServiceWrapper_1.ServiceWrapper.paramJson.gameCode!=="SlotMachine_DemiGods2"){ServiceWrapper_1.ServiceWrapper.paramJson.turboMode=1}if(typeof query["skipMainSplash"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.skipMainSplash=query["skipMainSplash"]==="1"?1:0}if(typeof query["winSpeed"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.normalWinLengthFactor=parseFloat(query["winSpeed"])}if(typeof query["bigWinSpeed"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.bigWinLengthFactor=parseFloat(query["bigWinSpeed"])}if(typeof query["plId"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.playerId=query["plId"]}if(typeof query["lobbyToken"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.lobbyToken=query["lobbyToken"]}if(typeof query["mode"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.mode=query["mode"]}else{ServiceWrapper_1.ServiceWrapper.paramJson.mode=ServiceWrapper_1.ServiceWrapper.isInIframe?0:1}if(typeof query["CrossLaunchUrl"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.CrossLaunchUrl=decodeURIComponent(query["CrossLaunchUrl"]);if(typeof query["imsgame"]!=="undefined"){ServiceWrapper_1.ServiceWrapper.CrossLaunchUrl=ServiceWrapper_1.ServiceWrapper.CrossLaunchUrl.replace("[game]",decodeURIComponent(query["imsgame"]))}var ctrlKeyDown_1=false;var checkDisableF5=function(e){if((e.which||e.keyCode)===116||(e.which||e.keyCode)===82&&ctrlKeyDown_1){e.preventDefault();ServiceWrapper_1.ServiceWrapper.moveToPage(ServiceWrapper_1.ServiceWrapper.CrossLaunchUrl)}else if((e.which||e.keyCode)===17){ctrlKeyDown_1=true}};var checkCtrlKeyUp=function(e){if((e.which||e.keyCode)===17){ctrlKeyDown_1=false}};$(document).on("keydown",checkDisableF5);$(document).on("keyup",checkCtrlKeyUp)}if(ServiceWrapper_1.ServiceWrapper.isMobile()){var detectSubPlatform_1=function(){if(ServiceWrapper_1.ServiceWrapper.isPortrait){ServiceWrapper_1.ServiceWrapper.subPlatformId="1"}else{ServiceWrapper_1.ServiceWrapper.subPlatformId="2"}};ServiceWrapper_1.ServiceWrapper.platformId="2";window.addEventListener("resize",function(){detectSubPlatform_1()});detectSubPlatform_1()}else{ServiceWrapper_1.ServiceWrapper.platformId="1";ServiceWrapper_1.ServiceWrapper.subPlatformId="0"}ServiceWrapper_1.ServiceWrapper.partnerId=ServiceWrapper_1.ServiceWrapper.paramJson.partnerId;ServiceWrapper_1.ServiceWrapper.gameCode=ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode;if(ServiceWrapper_1.ServiceWrapper.IsBspot){ServiceWrapper_1.ServiceWrapper.gameCode=BSpotWrapper.Model.GameCode}DataManager.adjustWinSpeed();ServiceWrapper_1.ServiceWrapper.paramJson.ribbonLogo=smallRibbonLogo;ServiceWrapper_1.ServiceWrapper.paramJson.loadingLogo=loaderSmallLogo;ServiceWrapper_1.ServiceWrapper.paramJson.pathUrl=relativePath;if(typeof LogicJs!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.LogicJs=LogicJs}if(typeof logicPath!=="undefined"){ServiceWrapper_1.ServiceWrapper.paramJson.LogicJs=logicPath}ServiceWrapper_1.ServiceWrapper.paramJson.fontPath=fontPath;window.dispatchEvent(new CustomEvent("error-screen-init"));ServiceWrapper_1.ServiceWrapper.paramJson.allowRefreshBalance=0;if(query["balanceRefresh"]&&query["balanceRefresh"]==="true"){ServiceWrapper_1.ServiceWrapper.paramJson.allowRefreshBalance=1}if(query["ctest"]&&ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment){ServiceWrapper_1.ServiceWrapper.paramJson.ctest=1}ServiceWrapper_1.ServiceWrapper.paramJson.allowSkipAuto=ServiceWrapper_1.ServiceWrapper.isWhow?1:0;if(typeof query["skip"]!=="undefined"&&query["skip"]==="true"&&ServiceWrapper_1.ServiceWrapper.paramJson.allowSkipAuto===0){ServiceWrapper_1.ServiceWrapper.paramJson.allowSkipAuto=1}if(GolWrapper_1.GolWrapper.isActive){GolWrapper_1.GolWrapper.adjustParams()}new CommunicationWrapper_1.CommunicationWrapper;if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment){require("./Wrappers/GandalfWrapper")}if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment&&ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsCertified){require("./Wrappers/OldTicketGeneratorWrapper");window.DebugWrapper.Activate()}}};DataManager.onGameStart=function(){Utilities_1.Utilities.SendC2Message("ReadExternalGameParams",ServiceWrapper_1.ServiceWrapper.paramJson);if(ServiceWrapper_1.ServiceWrapper.isMobile()){ServiceWrapper_1.ServiceWrapper.attachOrientation()}};DataManager.initiated=false;return DataManager}();exports.DataManager=DataManager},{"./Utilities":22,"./Wrappers/CommunicationWrapper":28,"./Wrappers/GameFocusWrapper":34,"./Wrappers/GandalfWrapper":35,"./Wrappers/GolWrapper":36,"./Wrappers/OldTicketGeneratorWrapper":38,"./Wrappers/ServiceWrapper":41}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ILemurDoesVegasWheelWinType;(function(ILemurDoesVegasWheelWinType){ILemurDoesVegasWheelWinType[ILemurDoesVegasWheelWinType["Win"]=0]="Win";ILemurDoesVegasWheelWinType[ILemurDoesVegasWheelWinType["FreeSpins"]=1]="FreeSpins"})(ILemurDoesVegasWheelWinType=exports.ILemurDoesVegasWheelWinType||(exports.ILemurDoesVegasWheelWinType={}));var ClassId;(function(ClassId){ClassId[ClassId["SlotMachine_BuffaloRampage"]=107]="SlotMachine_BuffaloRampage";ClassId[ClassId["SlotMachine_FruitsDeluxe"]=53]="SlotMachine_FruitsDeluxe";ClassId[ClassId["SlotMachine_Spinoween"]=73]="SlotMachine_Spinoween";ClassId[ClassId["SlotMachine_NovaGems"]=81]="SlotMachine_NovaGems";ClassId[ClassId["SlotMachine_FruitsDeluxe_FWE"]=84]="SlotMachine_FruitsDeluxe_FWE";ClassId[ClassId["SlotMachine_CupidsStrike"]=49]="SlotMachine_CupidsStrike";ClassId[ClassId["SlotMachine_DemiGods3"]=61]="SlotMachine_DemiGods3";ClassId[ClassId["SlotMachine_DemiGods3_15E"]=101]="SlotMachine_DemiGods3_15E";ClassId[ClassId["SlotMachine_PoseidonsRising"]=105]="SlotMachine_PoseidonsRising";ClassId[ClassId["SlotMachine_PoseidonsRising_15E"]=128]="SlotMachine_PoseidonsRising_15E";ClassId[ClassId["SlotMachine_PoseidonsRising_EE"]=139]="SlotMachine_PoseidonsRising_EE";ClassId[ClassId["SlotMachine_ArcticAdventures"]=76]="SlotMachine_ArcticAdventures";ClassId[ClassId["SlotMachine_EgyptianEclipse"]=127]="SlotMachine_EgyptianEclipse";ClassId[ClassId["SlotMachine_DragonsCharms"]=78]="SlotMachine_DragonsCharms";ClassId[ClassId["SlotMachine_DragonsCharms_FWE"]=85]="SlotMachine_DragonsCharms_FWE";ClassId[ClassId["SlotMachine_PiratesFortunes"]=57]="SlotMachine_PiratesFortunes";ClassId[ClassId["SlotMachine_StoryOfHerculesExpanded"]=80]="SlotMachine_StoryOfHerculesExpanded"})(ClassId=exports.ClassId||(exports.ClassId={}));var ISGErrorCategory;(function(ISGErrorCategory){ISGErrorCategory["CRITICAL"]="CRITICAL";ISGErrorCategory["INSUFFICIENT_FUNDS"]="INSUFFICIENT_FUNDS";ISGErrorCategory["LOGIN_ERROR"]="LOGIN_ERROR";ISGErrorCategory["RECOVERABLE_ERROR"]="RECOVERABLE_ERROR";ISGErrorCategory["NON_RECOVERABLE_ERROR"]="NON_RECOVERABLE_ERROR";ISGErrorCategory["CONNECTION_ERROR"]="CONNECTION_ERROR";ISGErrorCategory["MULTI_CHOICE_DIALOG"]="MULTI_CHOICE_DIALOG";ISGErrorCategory["OTHER_GAME_IN_PROGRESS"]="OTHER_GAME_IN_PROGRESS";ISGErrorCategory["REALITY_CHECK"]="REALITY_CHECK"})(ISGErrorCategory=exports.ISGErrorCategory||(exports.ISGErrorCategory={}));var ISGErrorSeverity;(function(ISGErrorSeverity){ISGErrorSeverity["WARNING"]="WARNING";ISGErrorSeverity["INFO"]="INFO";ISGErrorSeverity["ERROR"]="ERROR"})(ISGErrorSeverity=exports.ISGErrorSeverity||(exports.ISGErrorSeverity={}))},{}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DeviceDetector=function(){function DeviceDetector(){var _this=this;this.m_FunctionsToPerformOnResize=[];this.m_LastOrientationWasPortrait=null;this.m_LastOrientationWasPortrait=this.isPortrait;window.addEventListener("resize",function(){if(_this.m_LastOrientationWasPortrait!==_this.isPortrait){_this.m_FunctionsToPerformOnResize.forEach(function(func){func(_this.isPortrait)})}_this.m_LastOrientationWasPortrait=_this.isPortrait})}Object.defineProperty(DeviceDetector.prototype,"isMobile",{get:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},enumerable:true,configurable:true});Object.defineProperty(DeviceDetector.prototype,"isTablet",{get:function(){var isIpad=navigator.platform==="MacIntel"&&navigator.maxTouchPoints>0;return isIpad||/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(navigator.userAgent.toLowerCase())},enumerable:true,configurable:true});Object.defineProperty(DeviceDetector.prototype,"isAndroid",{get:function(){return/Android/i.test(navigator.userAgent)},enumerable:true,configurable:true});Object.defineProperty(DeviceDetector.prototype,"isIOS",{get:function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enumerable:true,configurable:true});Object.defineProperty(DeviceDetector.prototype,"isPortrait",{get:function(){return(this.isMobile||this.isTablet)&&window.matchMedia("(orientation: portrait)").matches},enumerable:true,configurable:true});DeviceDetector.prototype.OnOrientationChange=function(i_Func){this.m_FunctionsToPerformOnResize.push(i_Func)};DeviceDetector.prototype.OnOrientationChangeOff=function(i_Func){this.m_FunctionsToPerformOnResize=this.m_FunctionsToPerformOnResize.filter(function(a){return a!==i_Func})};DeviceDetector.prototype.OnOrientationChangeOnce=function(i_Func){var _this=this;var newFunc=function(i_IsPortrait){i_Func(i_IsPortrait);_this.OnOrientationChangeOff(newFunc)};this.OnOrientationChange(newFunc)};return DeviceDetector}();exports.DeviceDetector=DeviceDetector},{}],7:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var GenericEventAbstract=function(){function GenericEventAbstract(){this.m_Handlers=null;this.m_Calls=0}Object.defineProperty(GenericEventAbstract.prototype,"calls",{get:function(){return this.m_Calls},enumerable:true,configurable:true});Object.defineProperty(GenericEventAbstract.prototype,"isTriggred",{get:function(){return!!this.m_Calls},enumerable:true,configurable:true});GenericEventAbstract.prototype.ClearAll=function(){this.m_Handlers=null};GenericEventAbstract.prototype.On=function(i_Handler){if(!this.m_Handlers){this.m_Handlers=[]}this.m_Handlers.push(i_Handler)};GenericEventAbstract.prototype.NowOn=function(i_Handler){if(!this.m_Handlers){this.m_Handlers=[]}this.m_Handlers.push(i_Handler);i_Handler()};GenericEventAbstract.prototype.Once=function(i_Handler){var _this=this;if(!this.m_Handlers){this.m_Handlers=[]}var func=function(){var i_Arr=[];for(var _i=0;_i<arguments.length;_i++){i_Arr[_i]=arguments[_i]}_this.Off(func);return i_Handler.apply(void 0,i_Arr)};this.m_Handlers.push(func)};GenericEventAbstract.prototype.Off=function(i_Handler){if(!this.m_Handlers){return}this.m_Handlers=this.m_Handlers.filter(function(h){return h!==i_Handler})};GenericEventAbstract.prototype.Trigger=function(){var i_Arr=[];for(var _i=0;_i<arguments.length;_i++){i_Arr[_i]=arguments[_i]}if(this.m_Calls===undefined){this.m_Calls=0}this.m_Calls++;if(this.m_Handlers){var retVal_1;var tempHandlersArr=this.m_Handlers.slice(0);tempHandlersArr.forEach(function(h){return retVal_1=h.apply(void 0,i_Arr)});return retVal_1}};return GenericEventAbstract}();var GenericEvent=function(_super){__extends(GenericEvent,_super);function GenericEvent(){return _super!==null&&_super.apply(this,arguments)||this}GenericEvent.prototype.NowOn=function(i_Handler){_super.prototype.NowOn.call(this,i_Handler)};GenericEvent.prototype.On=function(i_Handler){_super.prototype.On.call(this,i_Handler)};GenericEvent.prototype.Off=function(i_Handler){_super.prototype.Off.call(this,i_Handler)};GenericEvent.prototype.Once=function(i_Handler){_super.prototype.Once.call(this,i_Handler)};GenericEvent.prototype.Trigger=function(i_1){return _super.prototype.Trigger.call(this,i_1)};return GenericEvent}(GenericEventAbstract);exports.GenericEvent=GenericEvent},{}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DeviceDetector_1=require("../DeviceDetector");var AudioWrapper_1=require("../Wrappers/AudioWrapper");var FullScreenWrapper_1=require("../Wrappers/FullScreenWrapper");var TimeWrapper_1=require("../Wrappers/TimeWrapper");var ExternalComponents=function(){function ExternalComponents(){}Object.defineProperty(ExternalComponents,"Languages",{get:function(){return this.m_Languages},set:function(i_Languages){this.m_Languages=i_Languages},enumerable:true,configurable:true});Object.defineProperty(ExternalComponents,"Audio",{get:function(){if(!this.m_Audio){this.m_Audio=new AudioWrapper_1.AudioWrapper}return this.m_Audio},enumerable:true,configurable:true});Object.defineProperty(ExternalComponents,"DeviceDetector",{get:function(){if(!this.m_DeviceDetector){this.m_DeviceDetector=new DeviceDetector_1.DeviceDetector}return this.m_DeviceDetector},enumerable:true,configurable:true});Object.defineProperty(ExternalComponents,"FullScreen",{get:function(){if(!this.m_FullScreen){if(!this.m_DeviceDetector){this.DeviceDetector}this.m_FullScreen=new FullScreenWrapper_1.FullScreenWrapper}return this.m_FullScreen},enumerable:true,configurable:true});ExternalComponents.m_Languages=null;ExternalComponents.m_Audio=null;ExternalComponents.m_DeviceDetector=null;ExternalComponents.Paytable=null;ExternalComponents.HelpPage=null;ExternalComponents.PromoTool=null;ExternalComponents.AutoPlayMenu=null;ExternalComponents.PromoScreen=null;ExternalComponents.WinnersRoundScreen=null;ExternalComponents.MegaFlashScreen=null;ExternalComponents.Timer=new TimeWrapper_1.TimeWrapper;ExternalComponents.BetSlip=null;ExternalComponents.TicketGenerator=null;ExternalComponents.m_FullScreen=null;ExternalComponents.FreeRounds=null;return ExternalComponents}();exports.ExternalComponents=ExternalComponents;window.ExternalComponents=ExternalComponents},{"../DeviceDetector":6,"../Wrappers/AudioWrapper":24,"../Wrappers/FullScreenWrapper":32,"../Wrappers/TimeWrapper":47}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents");var Utilities_1=require("../../Utilities");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var LogWrapper_1=require("../../Wrappers/LogWrapper");var ServiceWrapper_1=require("../../Wrappers/ServiceWrapper");var TicketWrapper_1=require("../../Wrappers/TicketWrapper");var AutoBetMenuWrapper=function(){function AutoBetMenuWrapper(i_AutoPlayMenu){var _this=this;this.m_AutoBetInfo=null;this.m_IsWinTriggered=false;this.m_IsFreespinsTriggered=false;this.m_IsSpinsOver=false;this.m_WinExceeded=false;this.m_BalanceWentOverLimit=false;this.m_BalanceWentUnderLimit=false;this.m_StartingBalance=-1;this.m_AutoBetConfig=null;this.m_MoreOptionsOpenedByDefault=false;this.LatestBalance=-1;this.m_CurrentBet=null;this.IsGameInTurbo=false;if(i_AutoPlayMenu){ExternalComponents_1.ExternalComponents.AutoPlayMenu=this;this.m_Instance=i_AutoPlayMenu;StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){var _a,_b,_c;_this.LatestBalance=(_c=(_b=(_a=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_a===void 0?void 0:_a.Result)===null||_b===void 0?void 0:_b.Coins,_c!==null&&_c!==void 0?_c:null);_this.AutoBetConfig=ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.AutoBetOptions});TicketWrapper_1.TicketWrapper.eOnProcessTicketReceived.On(function(result){_this.UpdateOnTicket(result)})}}Object.defineProperty(AutoBetMenuWrapper.prototype,"AutoBetConfig",{set:function(i_Config){var _a,_b,_c,_d;if(!i_Config){return}if(i_Config.Togglers){if(!((_a=ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo)===null||_a===void 0?void 0:_a.IsTurboEnabled)){i_Config.Togglers=ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.AutoBetOptions.Togglers.filter(function(a){return a.Name!=="TURBO_MODE"})}}var currencyMultiplier=(_d=(_c=(_b=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_b===void 0?void 0:_b.Result)===null||_c===void 0?void 0:_c.CurrencyMultiplier,_d!==null&&_d!==void 0?_d:1);i_Config.Sliders.forEach(function(slider,i){i_Config.Sliders[i].MAX*=currencyMultiplier;i_Config.Sliders[i].MIN*=currencyMultiplier;i_Config.Sliders[i].STEP*=currencyMultiplier;i_Config.Sliders[i].DefaultValue*=currencyMultiplier});this.m_AutoBetConfig=i_Config;this.m_Instance.SetStartData(this.m_AutoBetConfig)},enumerable:true,configurable:true});Object.defineProperty(AutoBetMenuWrapper.prototype,"AutoBetInfo",{set:function(i_AutoBetInfo){this.m_AutoBetInfo=i_AutoBetInfo;this.m_IsWinTriggered=false;this.m_IsFreespinsTriggered=false;this.m_IsSpinsOver=false;this.m_WinExceeded=false;this.m_BalanceWentOverLimit=false;this.m_BalanceWentUnderLimit=false;this.m_StartingBalance=this.LatestBalance},enumerable:true,configurable:true});Object.defineProperty(AutoBetMenuWrapper.prototype,"IsTurbo",{get:function(){if(this.m_AutoBetInfo){return this.m_AutoBetInfo.turboMode}return this.IsGameInTurbo},enumerable:true,configurable:true});Object.defineProperty(AutoBetMenuWrapper.prototype,"IsSkipSelections",{get:function(){return this.m_AutoBetInfo&&this.m_AutoBetInfo.skipSelections},enumerable:true,configurable:true});Object.defineProperty(AutoBetMenuWrapper.prototype,"SpinsLeft",{get:function(){if(this.m_AutoBetInfo){return this.m_AutoBetInfo.spinAmount}return null},enumerable:true,configurable:true});Object.defineProperty(AutoBetMenuWrapper.prototype,"IsOnAutoBet",{get:function(){return this.m_AutoBetInfo&&!this.m_IsWinTriggered&&!this.m_IsFreespinsTriggered&&!this.m_IsSpinsOver&&!this.m_WinExceeded&&!this.m_BalanceWentOverLimit&&!this.m_BalanceWentUnderLimit},enumerable:true,configurable:true});AutoBetMenuWrapper.prototype.UpdateOnTicket=function(i_Ticket){if(i_Ticket&&i_Ticket.Result){this.LatestBalance=i_Ticket.Result.CoinOut;if(this.m_AutoBetInfo){if(i_Ticket.Result.TotalBetPlaced>0){this.m_AutoBetInfo.spinAmount--}this.m_IsWinTriggered=this.m_AutoBetInfo.onAnyWin&&i_Ticket.Result.Win>0;this.m_IsFreespinsTriggered=this.m_AutoBetInfo.onFreespinsWon&&i_Ticket.Result.FreeTickets.To>0;this.m_IsSpinsOver=this.m_AutoBetInfo.spinAmount<=0;this.m_WinExceeded=this.m_AutoBetInfo.winExceed&&this.m_AutoBetInfo.winExceed<i_Ticket.Result.Win;this.m_BalanceWentOverLimit=this.m_AutoBetInfo.balanceIncreasedBy&&this.LatestBalance-this.m_StartingBalance>=this.m_AutoBetInfo.balanceIncreasedBy;this.m_BalanceWentUnderLimit=this.m_AutoBetInfo.balanceDecreasedBy&&this.LatestBalance-this.m_StartingBalance-this.CurrentBet<=-this.m_AutoBetInfo.balanceDecreasedBy;if(!this.IsOnAutoBet){this.m_AutoBetInfo=null}}}};Object.defineProperty(AutoBetMenuWrapper.prototype,"CurrentBet",{get:function(){return this.m_CurrentBet},set:function(i_NewBet){if(this.CurrentBet!==i_NewBet&&this.IsOnAutoBet){this.m_AutoBetInfo=null}this.m_CurrentBet=i_NewBet},enumerable:true,configurable:true});AutoBetMenuWrapper.prototype.Show=function(){this.Log("Opened auto bet menu");this.m_Instance.Show()};Object.defineProperty(AutoBetMenuWrapper.prototype,"MoreOptionsOpenedByDefault",{get:function(){return this.m_MoreOptionsOpenedByDefault},set:function(i_Open){this.m_MoreOptionsOpenedByDefault=i_Open},enumerable:true,configurable:true});AutoBetMenuWrapper.prototype.ReleaseGame=function(){this.Log("Released game input");Utilities_1.Utilities.SendC2Message("AutoBetWindowClosed","")};AutoBetMenuWrapper.prototype.BlockGame=function(){this.Log("Blocked game input");Utilities_1.Utilities.SendC2Message("AutoBetWindowOpened","")};AutoBetMenuWrapper.prototype.StartAutoPlay=function(i_AutoBetInfo){this.AutoBetInfo=i_AutoBetInfo;this.Log("[StartAutoPlay] with info: "+JSON.stringify(i_AutoBetInfo))};AutoBetMenuWrapper.prototype.Log=function(i_Message){ServiceWrapper_1.ServiceWrapper.LogMessageWithColor(i_Message,LogWrapper_1.LogMessageColor.AutoPlayMenu,LogWrapper_1.LogMessageColor.AutoPlayMenuBG)};return AutoBetMenuWrapper}();exports.AutoBetMenuWrapper=AutoBetMenuWrapper},{"../../Utilities":22,"../../Wrappers/LogWrapper":37,"../../Wrappers/ServiceWrapper":41,"../../Wrappers/StartTicketWrapper":42,"../../Wrappers/TicketWrapper":46,"../ExternalComponents":8}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Events_1=require("../../Events");var ExternalComponents_1=require("../ExternalComponents");var ServiceWrapper_1=require("../../Wrappers/ServiceWrapper");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var BetSlipWrapper=function(){function BetSlipWrapper(i_BetSlip){var _this=this;this.m_Instance=null;this.eOnHide=new Events_1.GenericEvent;this.eOnShow=new Events_1.GenericEvent;if(i_BetSlip){this.m_Instance=i_BetSlip;ExternalComponents_1.ExternalComponents.BetSlip=this;StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){var _a,_b;_this.Init((_b=(_a=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_a===void 0?void 0:_a.Result)===null||_b===void 0?void 0:_b.MaxWinMultiplier)})}}BetSlipWrapper.prototype.Init=function(i_MaxOdds){var info={Product:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameName,MaxOdds:i_MaxOdds,UserID:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.ExternalId,Venue:ServiceWrapper_1.ServiceWrapper.Info.UrlVars["venueName"]};this.m_Instance.InitParams(info)};BetSlipWrapper.prototype.Show=function(i_CurrentBet,i_Time){this.m_Instance.Show(i_CurrentBet,i_Time)};BetSlipWrapper.prototype.Hide=function(){this.m_Instance.Hide()};return BetSlipWrapper}();exports.BetSlipWrapper=BetSlipWrapper},{"../../Events":7,"../../Wrappers/ServiceWrapper":41,"../../Wrappers/StartTicketWrapper":42,"../ExternalComponents":8}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ErrorWrapper_1=require("../../Wrappers/ErrorWrapper");var ServiceWrapper_1=require("../../Wrappers/ServiceWrapper");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var TicketWrapper_1=require("../../Wrappers/TicketWrapper");var ExternalComponents_1=require("../ExternalComponents");var FreeRoundsScreenWrapper=function(){function FreeRoundsScreenWrapper(i_FreeRounds){var _this=this;this.m_Instance=null;if(i_FreeRounds){this.m_Instance=i_FreeRounds;ExternalComponents_1.ExternalComponents.FreeRounds=this;this.m_StartFreeRoundsObject={FreeRoundsMarketing:{Id:4444,Code:"Master Free Rounds",BetPerLine:5,Lines:10,FreeRoundsReceived:5,FreeRoundsLeft:5,TotalWinSoFar:50,ExpireDate:null,IsShow:true},GameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode};StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){_this.Init(_this.m_StartFreeRoundsObject);ServiceWrapper_1.ServiceWrapper.LogMessage("sending init-free-rounds from start-ticket\ndata: "+JSON.stringify(_this.m_StartFreeRoundsObject))});TicketWrapper_1.TicketWrapper.eOnProcessTicketReceived.On(function(result){if(ExternalComponents_1.ExternalComponents.FreeRounds){var res={Id:4444,Code:"Master Free Rounds",BetPerLine:5,Lines:10,FreeRoundsReceived:5,FreeRoundsLeft:0,TotalWinSoFar:75,ExpireDate:null,IsShow:false};ExternalComponents_1.ExternalComponents.FreeRounds.UpdateFreeRoundsTicket(res);ServiceWrapper_1.ServiceWrapper.LogMessage("Sending frs updateTicket with data: "+JSON.stringify(res))}})}}FreeRoundsScreenWrapper.prototype.sendAjaxRequest=function(){var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,FreeRoundsMarketingId:this.m_StartFreeRoundsObject.FreeRoundsMarketing.Id};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"Promotion",data:parameters,timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){},error:function(jqXHR,exception){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception)}})};FreeRoundsScreenWrapper.prototype.Init=function(i_FreeRoundInitResponse){this.m_Instance.InitParams(i_FreeRoundInitResponse)};FreeRoundsScreenWrapper.prototype.UpdateFreeRoundsTicket=function(i_FreeRoundUpdateResponse){this.m_Instance.UpdateTicket(i_FreeRoundUpdateResponse)};FreeRoundsScreenWrapper.prototype.OnTicketEnd=function(){this.m_Instance.OnTicketEnd()};FreeRoundsScreenWrapper.prototype.Start=function(){ServiceWrapper_1.ServiceWrapper.LogMessage("Start from external component");this.sendAjaxRequest()};FreeRoundsScreenWrapper.prototype.Finished=function(){ServiceWrapper_1.ServiceWrapper.LogMessage("Finished from external component")};FreeRoundsScreenWrapper.prototype.AllowShowTopBar=function(){this.m_Instance.AllowShowTopBar()};FreeRoundsScreenWrapper.prototype.AllowShowWindow=function(){this.m_Instance.AllowShowWindow()};return FreeRoundsScreenWrapper}();exports.FreeRoundsScreenWrapper=FreeRoundsScreenWrapper},{"../../Wrappers/ErrorWrapper":30,"../../Wrappers/ServiceWrapper":41,"../../Wrappers/StartTicketWrapper":42,"../../Wrappers/TicketWrapper":46,"../ExternalComponents":8}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Events_1=require("../../Events");var ExternalComponents_1=require("../ExternalComponents");var Utilities_1=require("../../Utilities");var GolWrapper_1=require("../../Wrappers/GolWrapper");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var ServiceWrapper_1=require("../../Wrappers/ServiceWrapper");var HelpPageWrapper=function(){function HelpPageWrapper(i_HelpPage){var _this=this;this.m_Instance=null;this.m_WasJsonAlreadyRead=false;this.eOnHide=new Events_1.GenericEvent;this.eOnShow=new Events_1.GenericEvent;if(i_HelpPage){this.m_Instance=i_HelpPage;ExternalComponents_1.ExternalComponents.HelpPage=this;this.eOnHide.On(this.OnHideTrigger.bind(this));this.eOnShow.On(this.OnShowTrigger.bind(this));StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){if(ServiceWrapper_1.ServiceWrapper.Info.GameInfo.HelpPage){_this.ReadMarketplaceHelpPage(ServiceWrapper_1.ServiceWrapper.Info.GameInfo.HelpPage)}else{_this.FetchPageJson()}})}}HelpPageWrapper.prototype.ReadMarketplaceHelpPage=function(i_HelpPage){if(GolWrapper_1.GolWrapper.isActive){GolWrapper_1.GolWrapper.AddPossibleBets(i_HelpPage)}this.ReadJson({HelpPage:i_HelpPage})};HelpPageWrapper.prototype.FetchPageJson=function(){var _this=this;if(!ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage||ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage===""||this.m_WasJsonAlreadyRead){return}var path=ServiceWrapper_1.ServiceWrapper.ExternalComponentPath+"json_files/help_page/per_class/"+ServiceWrapper_1.ServiceWrapper.PerGameConfig.GameClass+"/"+ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage+"/help_page.json"+"?rnd="+Utilities_1.Utilities.MakeId();fetch(path).then(function(response){if(!response.ok){throw new Error(response.statusText)}return response.json()}).then(function(json){_this.m_WasJsonAlreadyRead=true;json.HelpPage=_this.checkEnvironmentConfig(json.HelpPage,ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo);_this.CheckPerGameConfig(json.HelpPage);if(GolWrapper_1.GolWrapper.isActive){GolWrapper_1.GolWrapper.AddPossibleBets(json.HelpPage)}_this.ReadJson(json)}).catch(function(error){ServiceWrapper_1.ServiceWrapper.LogError("[HelpPage] Loading error"+error);ServiceWrapper_1.ServiceWrapper.ThrowExternalComponentNotLoadedError()})};HelpPageWrapper.prototype.checkEnvironmentConfig=function(json,i_EnvConfig){var _loop_1=function(key,value){if(typeof value==="boolean"&&!value){for(var _i=0,_a=Object.keys(json);_i<_a.length;_i++){var jsonKey=_a[_i];if(json[jsonKey]){if(jsonKey==="GameFeatures"&&json.GameFeatures.Features){json.GameFeatures.Features=json.GameFeatures.Features.filter(function(a){return a.Key!==key})}else if(json[jsonKey].filter){json[jsonKey]=json[jsonKey].filter(function(a){return a.Key!==key});json[jsonKey].forEach(function(entry){if(entry&&entry.Text){if(typeof entry.Text[0]==="string"&&(entry.Text[0].includes("{RTP}")||entry.Text[0].includes("{RTP_MIN}"))){if(!ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsShowMaxWin){entry.Text=[entry.Text[0]]}}}})}}}}else if(typeof value==="object"&&value){json=this_1.checkEnvironmentConfig(json,value)}};var this_1=this;for(var _i=0,_a=Object.entries(i_EnvConfig);_i<_a.length;_i++){var _b=_a[_i],key=_b[0],value=_b[1];_loop_1(key,value)}return json};HelpPageWrapper.prototype.CheckPerGameConfig=function(i_HelpPage){var perGameConfig=ServiceWrapper_1.ServiceWrapper.PerGameConfig;if(perGameConfig&&(perGameConfig.RTP||perGameConfig.BuyFeatureRTP||perGameConfig.GameName)){this.ChangeHelpPageText(i_HelpPage,perGameConfig)}return i_HelpPage};HelpPageWrapper.prototype.ChangeHelpPageText=function(i_HelpPageEntry,i_PerGameConfig){if(!i_HelpPageEntry){return}for(var _i=0,_a=Object.keys(i_HelpPageEntry);_i<_a.length;_i++){var key=_a[_i];if(i_HelpPageEntry[key]){if(typeof i_HelpPageEntry[key]==="string"){if(i_PerGameConfig.RTP){if(typeof i_PerGameConfig.RTP==="number"){i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{RTP}",ServiceWrapper_1.ServiceWrapper.formatNumber(i_PerGameConfig.RTP+""))}else if(typeof i_PerGameConfig.RTP==="object"){i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{RTP_MIN}",ServiceWrapper_1.ServiceWrapper.formatNumber(i_PerGameConfig.RTP.Min+""));i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{RTP_MAX}",ServiceWrapper_1.ServiceWrapper.formatNumber(i_PerGameConfig.RTP.Max+""))}}if(i_PerGameConfig.BuyFeatureRTP){if(typeof i_PerGameConfig.BuyFeatureRTP==="number"){i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{BUY_FEATURE_RTP}",ServiceWrapper_1.ServiceWrapper.formatNumber(i_PerGameConfig.BuyFeatureRTP+""))}else if(typeof i_PerGameConfig.BuyFeatureRTP==="object"){i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{BUY_FEATURE_RTP_MIN}",ServiceWrapper_1.ServiceWrapper.formatNumber(i_PerGameConfig.BuyFeatureRTP.Min+""));i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{BUY_FEATURE_RTP_MAX}",ServiceWrapper_1.ServiceWrapper.formatNumber(i_PerGameConfig.BuyFeatureRTP.Max+""))}}if(i_PerGameConfig.GameName){i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{GAME_NAME}",i_PerGameConfig.GameName)}if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.MaxWinMultiplier){i_HelpPageEntry[key]=i_HelpPageEntry[key].replace("{MAX_WIN_MULTIPLIER}",ServiceWrapper_1.ServiceWrapper.formatNumber(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.MaxWinMultiplier+""))}}else if(typeof i_HelpPageEntry[key]==="object"){this.ChangeHelpPageText(i_HelpPageEntry[key],i_PerGameConfig)}}}};HelpPageWrapper.prototype.ReadJson=function(i_HelpPageJson){this.m_Instance.ReadJson(i_HelpPageJson)};HelpPageWrapper.prototype.Show=function(){this.m_Instance.Show()};HelpPageWrapper.prototype.Hide=function(){this.m_Instance.Hide()};HelpPageWrapper.prototype.OnHideTrigger=function(){Utilities_1.Utilities.SendC2Message("CloseHelpPage","")};HelpPageWrapper.prototype.OnShowTrigger=function(){Utilities_1.Utilities.SendC2Message("OpenHelpPage","")};return HelpPageWrapper}();exports.HelpPageWrapper=HelpPageWrapper},{"../../Events":7,"../../Utilities":22,"../../Wrappers/GolWrapper":36,"../../Wrappers/ServiceWrapper":41,"../../Wrappers/StartTicketWrapper":42,"../ExternalComponents":8}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Events_1=require("../../Events");var ExternalComponents_1=require("../ExternalComponents");var MegaFlashScreenWrapper=function(){function MegaFlashScreenWrapper(i_MegaFlashScreen){this.eOnHide=new Events_1.GenericEvent;this.eOnShow=new Events_1.GenericEvent;if(i_MegaFlashScreen){ExternalComponents_1.ExternalComponents.MegaFlashScreen=this;this.m_Instance=i_MegaFlashScreen}}MegaFlashScreenWrapper.prototype.Show=function(){this.m_Instance.Show()};MegaFlashScreenWrapper.prototype.OnShow=function(){this.eOnShow.Trigger()};MegaFlashScreenWrapper.prototype.OnHide=function(){this.eOnHide.Trigger()};return MegaFlashScreenWrapper}();exports.MegaFlashScreenWrapper=MegaFlashScreenWrapper},{"../../Events":7,"../ExternalComponents":8}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Events_1=require("../../Events");var ExternalComponents_1=require("../ExternalComponents");var Utilities_1=require("../../Utilities");var ServiceWrapper_1=require("../../Wrappers/ServiceWrapper");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var PaytableWrapper=function(){function PaytableWrapper(i_Paytable){var _this=this;this.m_PaytableJson=null;this.eOnShow=new Events_1.GenericEvent;this.eOnHide=new Events_1.GenericEvent;if(i_Paytable){this.m_Instance=i_Paytable;ExternalComponents_1.ExternalComponents.Paytable=this;StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){var _a;_this.OnStartRequest((_a=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_a===void 0?void 0:_a.Result)})}}PaytableWrapper.prototype.MakeValuesArrayFromMathSymbols=function(i_MathSymbols){i_MathSymbols.forEach(function(symbol){if(symbol.PayOuts){symbol.SymbolValues=[];for(var _i=0,_a=Object.keys(symbol.PayOuts);_i<_a.length;_i++){var key=_a[_i];if(key){symbol.SymbolValues.push(key+" x "+ServiceWrapper_1.ServiceWrapper.formatNumber(symbol.PayOuts[key]+""))}}}else{symbol.SymbolValues=null}});return i_MathSymbols};PaytableWrapper.prototype.ReadJson=function(i_MathSymbols){var _this=this;var path=ServiceWrapper_1.ServiceWrapper.ExternalComponentPath+"json_files/paytable/per_class/"+ServiceWrapper_1.ServiceWrapper.PerGameConfig.GameClass+"/"+ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage+"/paytable.json"+"?rnd="+Utilities_1.Utilities.MakeId();fetch(path).then(function(response){if(!response.ok){throw new Error(response.statusText)}return response.json()}).then(function(json){_this.m_PaytableJson=_this.CheckPerGameConfig(_this.CheckEnvironmentConfig(_this.CheckSymbolMath(json,i_MathSymbols),ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo),ServiceWrapper_1.ServiceWrapper.PerGameConfig);_this.m_Instance.ReadJson(_this.m_PaytableJson)}).catch(function(error){ServiceWrapper_1.ServiceWrapper.LogError("[Paytable] Loading error"+error);ServiceWrapper_1.ServiceWrapper.ThrowExternalComponentNotLoadedError()})};PaytableWrapper.prototype.CheckSymbolMath=function(i_Json,i_MathSymbols){if(i_MathSymbols){i_Json.Paytable.Pages.forEach(function(page){if(page.Symbols){if(page.Symbols.length>1){page.Symbols.forEach(function(symbol){var mathSymbol=i_MathSymbols.find(function(a){return a.Id===symbol.Id});if(mathSymbol){symbol.Values=mathSymbol.SymbolValues.reverse()}})}else if(page.Symbols.length===1){var symbol_1=page.Symbols[0];var mathSymbol=i_MathSymbols.find(function(a){return a.Id===symbol_1.Id});if(mathSymbol){page.SymbolValues=mathSymbol.SymbolValues.reverse()}page.Images=[symbol_1.Image];page.Symbols=null}}})}return i_Json};PaytableWrapper.prototype.CheckPerGameConfig=function(i_json,i_PerGameConfig){if(i_PerGameConfig){if(i_PerGameConfig.SymbolValueStyle){i_json.Paytable.SymbolValueStyle=i_PerGameConfig.SymbolValueStyle}if(!i_PerGameConfig.PaytableReplaceStrings){return i_json}i_PerGameConfig.PaytableReplaceStrings.forEach(function(replaceObject){if(replaceObject.ReplaceFrom&&replaceObject.ReplaceTo){var replaceTo_1=replaceObject.ReplaceTo;var translationLabel="LABEL_"+replaceObject.ReplaceTo[0].toUpperCase()+replaceObject.ReplaceTo.slice(1);if(ExternalComponents_1.ExternalComponents.Languages.Labels[translationLabel]){replaceTo_1=ExternalComponents_1.ExternalComponents.Languages.Labels[translationLabel]}if(i_json.Paytable&&i_json.Paytable.Pages){i_json.Paytable.Pages.forEach(function(page){page.Title=page.Title.split(replaceObject.ReplaceFrom).join(replaceTo_1.toUpperCase());if(page.Texts){page.Texts.forEach(function(txt,i){page.Texts[i]=txt.split(replaceObject.ReplaceFrom).join(replaceTo_1)})}})}}})}return i_json};PaytableWrapper.prototype.CheckEnvironmentConfig=function(i_Json,i_EnvConfig){var _loop_1=function(key,value){if(typeof value==="boolean"&&!value){i_Json.Paytable.Pages=i_Json.Paytable.Pages.filter(function(a){return a.Key!==key})}else if(typeof value==="object"&&value){i_Json=this_1.CheckEnvironmentConfig(i_Json,value)}};var this_1=this;for(var _i=0,_a=Object.entries(i_EnvConfig);_i<_a.length;_i++){var _b=_a[_i],key=_b[0],value=_b[1];_loop_1(key,value)}return i_Json};PaytableWrapper.prototype.Show=function(){this.m_Instance.Show()};PaytableWrapper.prototype.OnShowTrigger=function(){this.eOnShow.Trigger()};PaytableWrapper.prototype.Hide=function(){this.m_Instance.Hide()};PaytableWrapper.prototype.OnHideTrigger=function(){this.eOnHide.Trigger()};PaytableWrapper.prototype.OnStartRequest=function(i_StartTicket){if(i_StartTicket&&i_StartTicket.MathConfig&&i_StartTicket.MathConfig){this.ReadJson(this.MakeValuesArrayFromMathSymbols(i_StartTicket.MathConfig.Symbols))}else{this.ReadJson()}};return PaytableWrapper}();exports.PaytableWrapper=PaytableWrapper},{"../../Events":7,"../../Utilities":22,"../../Wrappers/ServiceWrapper":41,"../../Wrappers/StartTicketWrapper":42,"../ExternalComponents":8}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Events_1=require("../../Events");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var TicketWrapper_1=require("../../Wrappers/TicketWrapper");var ExternalComponents_1=require("../ExternalComponents");var PromoScreenWrapper=function(){function PromoScreenWrapper(i_PromoScreen){var _this=this;this.eOnHide=new Events_1.GenericEvent;this.eOnShow=new Events_1.GenericEvent;if(i_PromoScreen){ExternalComponents_1.ExternalComponents.PromoScreen=this;this.m_Instance=i_PromoScreen;StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){var _a,_b;var promoInfo=(_b=(_a=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_a===void 0?void 0:_a.Result)===null||_b===void 0?void 0:_b.Promotion;if(promoInfo){_this.Init({Code:promoInfo.Code,Amount:promoInfo.FreeSpins,Win:null})}});TicketWrapper_1.TicketWrapper.eOnProcessTicketReceived.On(function(result){_this.UpdateOnTicket(result.Result)})}}PromoScreenWrapper.prototype.UpdateOnTicket=function(i_Ticket){var _a,_b,_c,_d;if(((_b=(_a=i_Ticket)===null||_a===void 0?void 0:_a.FreeTickets)===null||_b===void 0?void 0:_b.PromoCode)&&((_d=(_c=i_Ticket)===null||_c===void 0?void 0:_c.FreeTickets)===null||_d===void 0?void 0:_d.To)===0){this.Init({Code:i_Ticket.FreeTickets.PromoCode,Amount:i_Ticket.FreeTickets.To,Win:i_Ticket.FreeTickets.Win})}};PromoScreenWrapper.prototype.Init=function(i_PromoInfo){if(!i_PromoInfo){return}this.m_LastInfo=i_PromoInfo};PromoScreenWrapper.prototype.Show=function(i_PromoInfo){if(i_PromoInfo){this.m_Instance.Show(i_PromoInfo)}else if(this.m_LastInfo){this.m_Instance.Show(this.m_LastInfo)}else{this.OnHide()}};PromoScreenWrapper.prototype.OnShow=function(){this.m_LastInfo=null;this.eOnShow.Trigger()};PromoScreenWrapper.prototype.OnHide=function(){this.eOnHide.Trigger()};return PromoScreenWrapper}();exports.PromoScreenWrapper=PromoScreenWrapper},{"../../Events":7,"../../Wrappers/StartTicketWrapper":42,"../../Wrappers/TicketWrapper":46,"../ExternalComponents":8}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents");var Utilities_1=require("../../Utilities");var ErrorWrapper_1=require("../../Wrappers/ErrorWrapper");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var LogWrapper_1=require("../../Wrappers/LogWrapper");var ServiceWrapper_1=require("../../Wrappers/ServiceWrapper");var TicketWrapper_1=require("../../Wrappers/TicketWrapper");var RespinWrapper_1=require("../../Wrappers/RespinWrapper");var PromoToolWrapper=function(){function PromoToolWrapper(i_PromoTool){var _this=this;this.m_baseURL=null;this.m_bonusPlayerId=null;this.m_BonusCampaignToken=null;this.m_IsInitiated=false;this.m_IsCert=false;this.m_FailedPlayerStatusRequestsInARow=0;this.m_NumberOfPlayerStatusRequestsInAMinute=null;this.m_IsAllowedToShowInitPopup=false;this.m_IsAllowedToShowTopBar=false;this.m_IsRefreshNeededForTournamentStart=false;this.IsPromoToolSupported=false;if(i_PromoTool){this.m_Instance=i_PromoTool;ExternalComponents_1.ExternalComponents.PromoTool=this;StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){_this.Init()});TicketWrapper_1.TicketWrapper.eOnProcessTicketReceived.On(function(result){if(!RespinWrapper_1.ReSpinWrapper.isInsideRespin()){_this.SendOnTicketReceived(result.PromoInfo)}})}}Object.defineProperty(PromoToolWrapper.prototype,"IsRefreshNeededForTournamentStart",{get:function(){return this.m_IsRefreshNeededForTournamentStart},enumerable:true,configurable:true});PromoToolWrapper.prototype.Init=function(){this.Log("Try init PromoTool");if(this.m_IsInitiated||!ServiceWrapper_1.ServiceWrapper.PromoToolExists){this.Log("PromoTool already initiated");return}if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&typeof StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo!=="undefined"&&StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo&&StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.CampaignInfo){if(StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.ResponseInfo&&StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.ResponseInfo.ErrorCode){return}this.Log("Initiating Promo Tool");this.m_IsInitiated=true;this.m_baseURL=StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.ExternalUrl;this.m_IsCert=StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.CampaignInfo.IsCert;this.updatePromoToolInit(StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.CampaignInfo.BonusPlayerId,StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.CampaignInfo.BonusCampaignToken);var promoInfo={promoToolInit:StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo,config:null};var isPendingTournament=false;promoInfo.promoToolInit=this.AdjustZFormatDates(promoInfo.promoToolInit);if(promoInfo.promoToolInit.CampaignInfo.Dates){var startDate=new Date(promoInfo.promoToolInit.CampaignInfo.Dates.StartDate);var nowDate=new Date(promoInfo.promoToolInit.CampaignInfo.Dates.NowDate);isPendingTournament=startDate&&nowDate&&nowDate<startDate;if(isPendingTournament){promoInfo.promoToolInit.CampaignInfo.Dates.EndDate=null;promoInfo.promoToolInit.CampaignInfo.Dates.ShowResultsEndDate=null;this.StartCountDownToRefresh(nowDate,startDate)}}if(!Utilities_1.Utilities.isNullOrEmpty(StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.CampaignInfo.SymbolToCollectUrl)){promoInfo.promoToolInit.CampaignInfo.SymbolToCollectUrl=StartTicketWrapper_1.StartTicketWrapper.startTicket.PromoInfo.CampaignInfo.SymbolToCollectUrl}else if(promoInfo.promoToolInit.CampaignInfo.CollectSymbolId!==null&&ServiceWrapper_1.ServiceWrapper.Info.GameInfo.Path){promoInfo.promoToolInit.CampaignInfo.SymbolToCollectUrl=ServiceWrapper_1.ServiceWrapper.Info.GameInfo.Path+"Marketing/Symbols/"+promoInfo.promoToolInit.CampaignInfo.CollectSymbolId+".png"}if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo){promoInfo.config=ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.PromoToolSettings;this.m_NumberOfPlayerStatusRequestsInAMinute=60/promoInfo.config.SecondsToPushPollRank}this.OnStartTicket(promoInfo);if(this.m_IsAllowedToShowInitPopup){this.ShowInitPopup()}if(this.m_IsAllowedToShowTopBar){this.ShowTopBar()}}};PromoToolWrapper.prototype.AdjustZFormatDates=function(i_PromoInfo){if(i_PromoInfo&&typeof i_PromoInfo==="object"){for(var _i=0,_a=Object.entries(i_PromoInfo);_i<_a.length;_i++){var _b=_a[_i],key=_b[0],value=_b[1];if(typeof value==="object"){i_PromoInfo[key]=this.AdjustZFormatDates(value)}else if(key.toLowerCase().endsWith("date")&&typeof value==="string"&&value[value.length-1]!=="Z"){i_PromoInfo[key]=value+"Z"}}}return i_PromoInfo};PromoToolWrapper.prototype.StartCountDownToRefresh=function(fromDate,toDate){var _this=this;var interval=setInterval(function(){fromDate.setSeconds(fromDate.getSeconds()+1);if(fromDate>=toDate){clearInterval(interval);if(ServiceWrapper_1.ServiceWrapper.Info.UrlVars.IsReal)_this.m_IsRefreshNeededForTournamentStart=true;ServiceWrapper_1.ServiceWrapper.LogMessageWithColor("Blocking Tickets - pending tournament started",LogWrapper_1.LogMessageColor.PromoTool)}},1e3)};PromoToolWrapper.prototype.SendOnTicketReceived=function(i_PromoInfo){if(i_PromoInfo){this.OnSpinResult(i_PromoInfo)}};PromoToolWrapper.prototype.updatePromoToolInit=function(i_PlayerId,i_BonusCampaignToken){if(!this.m_BonusCampaignToken&&i_BonusCampaignToken){this.m_BonusCampaignToken=i_BonusCampaignToken}if(!this.m_bonusPlayerId&&i_PlayerId){this.m_bonusPlayerId=i_PlayerId}};Object.defineProperty(PromoToolWrapper.prototype,"BonusPlayerId",{get:function(){return this.m_bonusPlayerId},enumerable:true,configurable:true});Object.defineProperty(PromoToolWrapper.prototype,"BonusCampaignToken",{get:function(){return this.m_BonusCampaignToken},enumerable:true,configurable:true});PromoToolWrapper.prototype.SetOpt=function(){if(this.m_bonusPlayerId!==null){this.Log("sending promo tool optStatus request");var data={optStatus:false};this.sendAjaxRequest("SetOpt",data)}};PromoToolWrapper.prototype.GetCollectablePrizes=function(){this.Log("sending promo tool prizes request");this.sendAjaxRequest("CollectablePrizes")};PromoToolWrapper.prototype.GetPlayerStatus=function(){if(this.m_bonusPlayerId!==null){this.Log("sending promo tool rank request");this.sendAjaxRequest("PlayerStatus")}};PromoToolWrapper.prototype.GetPrizesInfo=function(){if(this.m_bonusPlayerId!==null){this.Log("sending promo tool prizes info request");this.sendAjaxRequest("PrizesInfo")}};PromoToolWrapper.prototype.GetLeaderboardData=function(){if(this.m_bonusPlayerId!==null){this.Log("sending promo tool leaderboard info request");this.sendAjaxRequest("LeaderboardData")}};PromoToolWrapper.prototype.sendAjaxRequest=function(i_Action,i_Data){var _this=this;if(i_Data===void 0){i_Data={}}if(!this.m_baseURL){ServiceWrapper_1.ServiceWrapper.LogError("[PromoTool] No base url");ServiceWrapper_1.ServiceWrapper.ThrowExternalComponentNotLoadedError();return}i_Data.gameToken=ServiceWrapper_1.ServiceWrapper.gameToken;i_Data.gameCode=ServiceWrapper_1.ServiceWrapper.paramJson.gameCode;i_Data.brandCode=ServiceWrapper_1.ServiceWrapper.partnerId;i_Data.bonusPlayerId=this.m_bonusPlayerId;i_Data.bonusCampaignToken=this.m_BonusCampaignToken;i_Data.langCode=ServiceWrapper_1.ServiceWrapper.paramJson.langCode;i_Data.currencyCode=ServiceWrapper_1.ServiceWrapper.currency;i_Data.isCert=this.m_IsCert;$.ajax({url:this.m_baseURL+i_Action,data:JSON.stringify(i_Data),timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){if(result){if(result.ResponseInfo.ErrorCode===0){if(i_Action==="PlayerStatus"){_this.m_FailedPlayerStatusRequestsInARow=0}_this["On"+i_Action+"RequestResult"](result.Result)}else{_this.Log("Promo Tool Error On Request: "+i_Action);if(i_Action==="PlayerStatus"||i_Action==="PrizesInfo"||i_Action==="LeaderboardData"){if(i_Action==="PlayerStatus"){_this.m_FailedPlayerStatusRequestsInARow++}_this["On"+i_Action+"RequestResult"](null)}else{result.ResultInfo={Action:null,DisplayMessage:"",Message:result.ResponseInfo.ErrorMessage,Code:result.ResponseInfo.ErrorCode,Buttons:[]};Utilities_1.Utilities.SendC2Message("PromoToolError",result)}}}},error:function(jqXHR,exception){_this.Log("Promo Tool jqXHR Error On Request: "+i_Action);var throwTempError=function(){var dataError={Result:null,ResultInfo:{Action:null,DisplayMessage:"TEMPORARY_ERROR",Message:null,Code:5e3,Buttons:[]}};dataError.ResultInfo=ErrorWrapper_1.ErrorWrapper.UpdateError(dataError.ResultInfo);Utilities_1.Utilities.SendC2Message("PromoToolError",dataError)};if(i_Action==="PlayerStatus"||i_Action==="PrizesInfo"||i_Action==="LeaderboardData"){if(i_Action==="PlayerStatus"){_this.m_FailedPlayerStatusRequestsInARow++;if(_this.m_NumberOfPlayerStatusRequestsInAMinute&&_this.m_FailedPlayerStatusRequestsInARow>=_this.m_NumberOfPlayerStatusRequestsInAMinute){throwTempError()}}_this["On"+i_Action+"RequestResult"](null)}else if(jqXHR.status===0||jqXHR.status===500||exception==="timeout"){throwTempError()}}})};PromoToolWrapper.prototype.OnStartTicket=function(i_PromoToolInit){this.m_Instance.OnStartTicket(i_PromoToolInit)};PromoToolWrapper.prototype.OnSpinResult=function(i_TicketResult){this.m_Instance.OnSpinResult(i_TicketResult)};PromoToolWrapper.prototype.Block=function(){this.m_Instance.Block()};PromoToolWrapper.prototype.Release=function(){this.m_Instance.Release()};PromoToolWrapper.prototype.Hide=function(){this.m_Instance.Hide()};PromoToolWrapper.prototype.Show=function(){this.m_Instance.Show()};PromoToolWrapper.prototype.OnTicketEnd=function(){this.m_Instance.OnTicketEnd()};PromoToolWrapper.prototype.OnSetOptRequestResult=function(i_Result){this.m_Instance.OnSetOptRequestResult(i_Result)};PromoToolWrapper.prototype.OnCollectablePrizesRequestResult=function(i_Result){this.m_Instance.OnCollectablePrizesRequestResult(i_Result)};PromoToolWrapper.prototype.OnPlayerStatusRequestResult=function(i_Result){this.m_Instance.OnPlayerStatusRequestResult(i_Result)};PromoToolWrapper.prototype.OnPrizesInfoRequestResult=function(i_Result){this.m_Instance.OnPrizesInfoRequestResult(i_Result)};PromoToolWrapper.prototype.OnLeaderboardDataRequestResult=function(i_Result){this.m_Instance.OnLeaderboardDataRequestResult(i_Result)};PromoToolWrapper.prototype.OnGameBetChanged=function(i_NewBet){this.m_Instance.OnGameBetChanged(i_NewBet)};PromoToolWrapper.prototype.ShowInitPopup=function(){this.Log("Allow show promotool init popup");this.m_IsAllowedToShowInitPopup=true;this.m_Instance.ShowInitPopup()};PromoToolWrapper.prototype.ShowTopBar=function(){ServiceWrapper_1.ServiceWrapper.updateBetAmount();this.Log("Allow show promotool top bar");this.m_IsAllowedToShowTopBar=true;this.m_Instance.ShowTopBar()};PromoToolWrapper.prototype.DisableCountDown=function(){this.Log("Disable top bar countdown");this.m_Instance.DisableCountDown()};PromoToolWrapper.prototype.EnableCountDown=function(){this.Log("Allow top bar countdown");this.m_Instance.EnableCountDown()};PromoToolWrapper.prototype.OnSpin=function(){this.m_Instance.OnSpin()};PromoToolWrapper.prototype.OnPromoCollectClick=function(i_PromoInfo){var promoInfo={PrizeId:i_PromoInfo.PrizeId,PromoCode:i_PromoInfo.PromoCode};this.Log("promo info sent to game: "+promoInfo);ServiceWrapper_1.ServiceWrapper.blockPromoTool();Utilities_1.Utilities.SendC2Message("ReadPromotionToolUpdate",promoInfo)};PromoToolWrapper.prototype.PromotionToolExists=function(){Utilities_1.Utilities.SendC2Message("PromotionToolExists","")};PromoToolWrapper.prototype.PromotionToolDoesNotExist=function(){this.Log("Promo Tool does not exist");Utilities_1.Utilities.SendC2Message("PromotionToolDoesNotExist","")};PromoToolWrapper.prototype.BlockGame=function(){this.Log("Blocked game input");Utilities_1.Utilities.SendC2Message("PromoToolWindowOpen","")};PromoToolWrapper.prototype.ReleaseGame=function(){this.Log("Released game input");Utilities_1.Utilities.SendC2Message("PromoToolWindowClose","")};PromoToolWrapper.prototype.ForceGameToStopAutoplay=function(){if(ExternalComponents_1.ExternalComponents.AutoPlayMenu){ExternalComponents_1.ExternalComponents.AutoPlayMenu.AutoBetInfo=null}Utilities_1.Utilities.SendC2Message("PromoToolStopAutoPlay","")};PromoToolWrapper.prototype.Log=function(i_Message){ServiceWrapper_1.ServiceWrapper.LogMessageWithColor("[PromoTool] "+i_Message,LogWrapper_1.LogMessageColor.PromoTool)};return PromoToolWrapper}();exports.PromoToolWrapper=PromoToolWrapper},{"../../Utilities":22,"../../Wrappers/ErrorWrapper":30,"../../Wrappers/LogWrapper":37,"../../Wrappers/RespinWrapper":40,"../../Wrappers/ServiceWrapper":41,"../../Wrappers/StartTicketWrapper":42,"../../Wrappers/TicketWrapper":46,"../ExternalComponents":8}],17:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var Events_1=require("../../Events");var ExternalComponents_1=require("../ExternalComponents");var ErrorWrapper_1=require("../../Wrappers/ErrorWrapper");var LogWrapper_1=require("../../Wrappers/LogWrapper");var ServiceWrapper_1=require("../../Wrappers/ServiceWrapper");var StartTicketWrapper_1=require("../../Wrappers/StartTicketWrapper");var TicketGeneratorWrapper=function(){function TicketGeneratorWrapper(i_TicketGenerator){var _this=this;this.m_Instance=null;this.m_SlotConfigData=null;this.m_DebugTicketsInfo=null;this.m_DebugTicketsJsonPath=null;this.m_ENDPOINT="SlotConfigData";this.eOnSendTicket=new Events_1.GenericEvent;this.eOnSendSequence=new Events_1.GenericEvent;this.eOnShow=new Events_1.GenericEvent;this.eOnHide=new Events_1.GenericEvent;if(i_TicketGenerator){this.m_Instance=i_TicketGenerator;ExternalComponents_1.ExternalComponents.TicketGenerator=this;this.eOnSendTicket.On(this.OnSendTicketTrigger.bind(this));this.eOnSendSequence.On(this.OnSendSeqeunceTrigger.bind(this));StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){var _a,_b;_this.Init((_b=(_a=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_a===void 0?void 0:_a.Result)===null||_b===void 0?void 0:_b.ClassId)})}}TicketGeneratorWrapper.prototype.Init=function(i_ClassId){return __awaiter(this,void 0,void 0,function(){var _a,_b,info;return __generator(this,function(_c){switch(_c.label){case 0:_a=this;return[4,this.sendConfigDataRequest(i_ClassId)];case 1:_a.m_SlotConfigData=_c.sent();_b=this;return[4,this.readDebugTicketsInfo()];case 2:_b.m_DebugTicketsInfo=_c.sent();if(this.m_SlotConfigData){info={ConfigData:this.m_SlotConfigData,GameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,DebugTicketsInfo:this.m_DebugTicketsInfo};this.m_Instance.InitParams(info)}return[2]}})})};TicketGeneratorWrapper.prototype.readDebugTicketsInfo=function(){return __awaiter(this,void 0,void 0,function(){var cdnPath,isDebugTickets;var _this=this;return __generator(this,function(_a){switch(_a.label){case 0:cdnPath="./";this.m_DebugTicketsJsonPath=cdnPath+"json_files/debugTickets/"+ServiceWrapper_1.ServiceWrapper.paramJson.gameCode+".json";return[4,fetch(this.m_DebugTicketsJsonPath,{method:"HEAD",cache:"no-store"})];case 1:isDebugTickets=_a.sent();if(!isDebugTickets||isDebugTickets.status!==200){return[2]}else{return[2,new Promise(function(res){fetch(_this.m_DebugTicketsJsonPath).then(function(response){if(!response.ok){LogWrapper_1.LogWrapper.LogWarning("[DEBUG WRAPPER] No debug tickets json exists");return}return response.json()}).then(function(json){res(json)}).catch(function(error){LogWrapper_1.LogWrapper.LogError("[DEBUG WRAPPER] [read debug tickets]: "+error)})})]}return[2]}})})};TicketGeneratorWrapper.prototype.sendConfigDataRequest=function(i_ClassId){var _this=this;return new Promise(function(res){$.ajax({url:ServiceWrapper_1.ServiceWrapper.Info.Urls.RgsUrl+_this.m_ENDPOINT,data:JSON.stringify(i_ClassId),type:"POST",dataType:"json",timeout:12e4,contentType:"application/json; charset=utf-8",success:function(result){res(result)},error:function(jqXHR,exception){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,undefined,true)}})})};TicketGeneratorWrapper.prototype.Show=function(){this.m_Instance.Show();this.eOnShow.Trigger()};TicketGeneratorWrapper.prototype.AllowShowBtn=function(){this.m_Instance.AllowShowBtn()};TicketGeneratorWrapper.prototype.Hide=function(){this.m_Instance.Hide();this.eOnHide.Trigger()};TicketGeneratorWrapper.prototype.OnSendTicketTrigger=function(ticket){TicketGeneratorWrapper.ticketsList.push(ticket)};TicketGeneratorWrapper.prototype.OnSendSeqeunceTrigger=function(i_Data){if(typeof i_Data[0]==="number"){this.m_DebugTicketsInfo.Tickets.forEach(function(element){if(i_Data.includes(element.Id)){TicketGeneratorWrapper.ticketsList.push(element.Data)}})}else TicketGeneratorWrapper.ticketsList=i_Data;TicketGeneratorWrapper.ticketsList.reverse()};TicketGeneratorWrapper.getTicket=function(){if(TicketGeneratorWrapper.ticketsList.length===0){return null}var ticket=TicketGeneratorWrapper.ticketsList.pop();return ticket};TicketGeneratorWrapper.ticketsList=[];return TicketGeneratorWrapper}();exports.TicketGeneratorWrapper=TicketGeneratorWrapper;window.DebugWrapper=TicketGeneratorWrapper},{"../../Events":7,"../../Wrappers/ErrorWrapper":30,"../../Wrappers/LogWrapper":37,"../../Wrappers/ServiceWrapper":41,"../../Wrappers/StartTicketWrapper":42,"../ExternalComponents":8}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Events_1=require("../../Events");var ExternalComponents_1=require("../ExternalComponents");var WinnersRoundScreenWrapper=function(){function WinnersRoundScreenWrapper(i_WinnersRoundScreen){this.eOnHide=new Events_1.GenericEvent;this.eOnShow=new Events_1.GenericEvent;if(i_WinnersRoundScreen){ExternalComponents_1.ExternalComponents.WinnersRoundScreen=this;this.m_Instance=i_WinnersRoundScreen}}WinnersRoundScreenWrapper.prototype.Show=function(){this.m_Instance.Show()};WinnersRoundScreenWrapper.prototype.OnShow=function(){this.eOnShow.Trigger()};WinnersRoundScreenWrapper.prototype.OnHide=function(){this.eOnHide.Trigger()};return WinnersRoundScreenWrapper}();exports.WinnersRoundScreenWrapper=WinnersRoundScreenWrapper},{"../../Events":7,"../ExternalComponents":8}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Definitions_1=require("./Definitions");var StartTicketWrapper_1=require("./Wrappers/StartTicketWrapper");var StickyConfigObject=function(){function StickyConfigObject(){if(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result){switch(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){case Definitions_1.ClassId.SlotMachine_PiratesFortunes:this.FreeTicketsTo=0;this.FreeSpinsType=3;this.Item=15;this.SuperSticky=true;this.IsNew=true;this.Direction=4;this.Message="Pirates Sticky Fix";break;case Definitions_1.ClassId.SlotMachine_DragonsCharms:case Definitions_1.ClassId.SlotMachine_DragonsCharms_FWE:this.FreeTicketsTo=0;this.FreeSpinsType=1;this.Item=10;this.SuperSticky=true;this.IsNew=false;this.Direction=5;this.Message="DragonsCharms Sticky Fix";break;case Definitions_1.ClassId.SlotMachine_StoryOfHerculesExpanded:this.FreeTicketsTo=0;this.FreeSpinsType=2;this.Item=12;this.SuperSticky=true;this.IsNew=false;this.Direction=5;this.Message="StoryOfHercules-EE Sticky Fix";break}}}return StickyConfigObject}();var GameConfig=function(){function GameConfig(){}GameConfig.isGameSupportingStickyFix=function(i_data){if(i_data){return i_data.Result&&(i_data.Result.ClassId===Definitions_1.ClassId.SlotMachine_PiratesFortunes||i_data.Result.ClassId===Definitions_1.ClassId.SlotMachine_DragonsCharms||i_data.Result.ClassId===Definitions_1.ClassId.SlotMachine_DragonsCharms_FWE||i_data.Result.ClassId===Definitions_1.ClassId.SlotMachine_StoryOfHerculesExpanded)}return StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId===Definitions_1.ClassId.SlotMachine_PiratesFortunes||StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId===Definitions_1.ClassId.SlotMachine_DragonsCharms||StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId===Definitions_1.ClassId.SlotMachine_DragonsCharms_FWE||StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId===Definitions_1.ClassId.SlotMachine_StoryOfHerculesExpanded)};Object.defineProperty(GameConfig,"StickyConfig",{get:function(){if(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result){if(!GameConfig.m_StickyConfigObject){GameConfig.m_StickyConfigObject=new StickyConfigObject}return GameConfig.m_StickyConfigObject}},enumerable:true,configurable:true});GameConfig.m_StickyConfigObject=null;return GameConfig}();exports.GameConfig=GameConfig},{"./Definitions":5,"./Wrappers/StartTicketWrapper":42}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GameEvents=window.GameEvents},{}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Lobby=function(){function Lobby(){}Lobby.soundClick=function(code){};return Lobby}();var Games=function(){function Games(){}Games.skip=function(what,how,btn){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",what,"skip_"+how+"_"+btn,"Skip")}};Games.multiplierChoose=function(game,option){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",game+"_Multiplier_"+option,"select","Ribbon")}};Games.subGameChoose=function(game,option){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",game+"_SubGame_"+option,"select","Ribbon")}};Games.startLoading=function(code){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",code,"view","Loading_Start",{nonInteraction:1})}};Games.startGame=function(code){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",code,"view","Loading_End",{nonInteraction:1})}};Games.openWindow=function(code){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",code,"view","GameWindow",{nonInteraction:1})}};Games.closeWindow=function(code){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",code,"close","GameWindow")}};Games.autoCloseWindow=function(code){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",code,"auto_close","GameWindow")}};Games.activateWindow=function(code){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",code,"activate","GameWindow")}};Games.stakeUp=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","StakeUp","click","Ribbon")}};Games.stakeDown=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","StakeDown","click","Ribbon")}};Games.stop=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","Stop","click","Ribbon")}};Games.spinAutoClose=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","SpinAutoClose","click","Ribbon")}};Games.payTable=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","PayTable","click","Info")}};Games.payTableClose=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","PayTable","close","Info")}};Games.payTableNavigate=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","PayTable","navigate","Info")}};Games.autoPlay=function(on){if(typeof gaFbTracker!=="undefined"){if(on==="true"){gaFbTracker("send","event","AutoPlay","toggle-on","Ribbon")}else{gaFbTracker("send","event","AutoPlay","toggle-off","Ribbon")}}};Games.fastPlay=function(on){if(typeof gaFbTracker!=="undefined"){if(on==="true"){gaFbTracker("send","event","FastPlay","toggle-on","Ribbon")}else{gaFbTracker("send","event","FastPlay","toggle-off","Ribbon")}}};Games.spin=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","Spin","spin","Ribbon");Logger.increaseMetric("metric9",1)}};Games.autoSpin=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","Spin","spin_auto","Ribbon");Logger.increaseMetric("metric9",1)}};Games.selectFreeSpin=function(game,option){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",game+"_FreeSpinMode_"+option,"select","GameWindow")}};Games.selectBonus=function(game,option){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",game+"_BonusMode_"+option,"select","GameWindow")}};Games.freeSpinCollectable=function(game,option){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event",game+"_FreeSpinCollectable",option,"Collectable",{nonInteraction:1})}};Games.bonusClick=function(game,option){if(typeof gaFbTracker!=="undefined"){if(option){gaFbTracker("send","event","pick_"+option,"pick","Bonus_"+game)}else{gaFbTracker("send","event","pick","pick","Bonus_"+game)}}};Games.bonusStart=function(game){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","start","view","Bonus_"+game,{nonInteraction:1})}};Games.bonusMiss=function(game){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","miss","miss","Bonus_"+game)}};Games.home=function(){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","event","Home","click","Ribbon")}};return Games}();var Events=function(){function Events(){}Events.Orientation=function(land,change){if(typeof gaFbTracker!=="undefined"){if(land){if(change){gaFbTracker("send","event","Device Orientation","Change","Landscape",{nonInteraction:1})}else{gaFbTracker("send","event","Device Orientation","Landing","Landscape",{nonInteraction:1})}}else{if(change){gaFbTracker("send","event","Device Orientation","Change","Portrait",{nonInteraction:1})}else{gaFbTracker("send","event","Device Orientation","Landing","Portrait",{nonInteraction:1})}}}};Events.Lobby=Lobby;Events.Games=Games;return Events}();var Logger=function(){function Logger(){}Logger.init=function(key){(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date;a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","//www.google-analytics.com/analytics.js","gaFbTracker");gaFbTracker("create",key,"auto");gaFbTracker("set","forceSSL",true)};Logger.initDebug=function(key,appName,appId,appVersion,user){(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date;a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","//www.google-analytics.com/analytics_debug.js","gaFbTracker");gaFbTracker("create",key,"auto")};Logger.ready=function(){};Logger.logPageView=function(i_page,i_title){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","pageview",{page:i_page,title:i_title,useBeacon:true})}};Logger.logScreenView=function(i_screen){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","screenview",{screenName:i_screen})}};Logger.increaseMetric=function(name,amount){if(!amount){amount=1}if(typeof gaFbTracker!=="undefined"){gaFbTracker("set",name,amount)}};Logger.setCustomDimenstion=function(key,value){if(typeof gaFbTracker!=="undefined"){gaFbTracker("set",key,value)}};Logger.sendEx=function(i_description,i_IsFatal){if(i_description){if(typeof gaFbTracker!=="undefined"){gaFbTracker("send","exception",{exDescription:i_description,exFatal:i_IsFatal})}}};Logger.DefineAnalyticsRequest=function(onSuccess,parameters){if(typeof gaFbTracker==="undefined"){return}if(onSuccess==="ReadTicket"||onSuccess==="_ReadTicket"){Logger.askForBetTime=(new Date).getTime();var game=parameters.gameCode;if("subGameId"in parameters){Logger.Events.Games.subGameChoose(game,parameters.subGameId)}if("betMultiplier"in parameters){Logger.Events.Games.multiplierChoose(game,parameters.betMultiplier)}}else if(onSuccess==="ReadInitData"){Logger.endLoadGameTime=(new Date).getTime();var loadGameTime=Logger.endLoadGameTime-Logger.startLoadGameTime;gaFbTracker("send","timing","SlotMachineTiming","LoadGame",loadGameTime);Logger.askForInitTime=(new Date).getTime()}};Logger.DefineAnalyticsResponse=function(onSuccess,data){if(typeof gaFbTracker==="undefined"){return}if(onSuccess==="ReadTicket"||onSuccess==="_ReadTicket"){Logger.receiveBetTime=(new Date).getTime();var betReqTime=Logger.receiveBetTime-Logger.askForBetTime;gaFbTracker("send","timing","SlotMachineTiming","ProcessBet",betReqTime);Logger.increaseMetric("metric1",1);var bet=data.Result.Bet;Logger.increaseMetric("metric2",bet);var win=data.Result.Win;if(win>0){Logger.increaseMetric("metric3",win)}}else if(onSuccess==="ReadInitData"){Logger.receiveInitTime=(new Date).getTime();var initReqTime=Logger.receiveInitTime-Logger.askForInitTime;gaFbTracker("send","timing","SlotMachineTiming","InitSlotMachine",initReqTime);var currencyCode=data.Result.CurrencyCode;gaFbTracker("set","dimension3",currencyCode);var gameCode=Logger.getUrlParam()["gameCode"];gaFbTracker("set","dimension4",gameCode);Logger.Events.Games.startGame(gameCode)}};Logger.getParams=function(source,target){var vars={};source.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value});return vars[target]};Logger.getUrlParam=function(){var vars={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value;return""});return vars};Logger.getUrlVars=function(){var vars={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value;return""});return vars};Logger.Events=Events;return Logger}();exports.Logger=Logger;window.Logger=Logger},{}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ErrorWrapper_1=require("./Wrappers/ErrorWrapper");var ServiceWrapper_1=require("./Wrappers/ServiceWrapper");var Utilities=function(){function Utilities(){}Utilities.SendC2Message=function(i_ReturnFunction,i_Info){if(typeof c2_callFunction!=="undefined"&&c2_callFunction){var isLastTicketInfo=function(){return i_Info.Result&&typeof i_Info.Result.LastTicketInfo!=="undefined"&&i_Info.Result.LastTicketInfo};if(ServiceWrapper_1.ServiceWrapper.IsExternalErrorScreenExists&&i_Info&&i_Info.ResultInfo&&(i_Info.ResultInfo.Code||isLastTicketInfo())){if(isLastTicketInfo()){ServiceWrapper_1.ServiceWrapper.WaitingLastTicketEnd=true}if(this.isSG){ErrorWrapper_1.ErrorWrapper.UpdateErrorSG(i_Info.ResultInfo)}else{window.dispatchEvent(new CustomEvent("error-screen-open",{detail:i_Info.ResultInfo}))}}if(!window.con&&(i_ReturnFunction.includes("Promo")||i_ReturnFunction.includes("ErrorScreen")||i_ReturnFunction.includes("AutoBet")||i_ReturnFunction.includes("HelpPage"))){return}if(typeof i_Info==="string"){c2_callFunction(i_ReturnFunction,[i_Info])}else{c2_callFunction(i_ReturnFunction,[JSON.stringify(i_Info)])}}};Utilities.MakeId=function(i_Length){if(i_Length===void 0){i_Length=50}var result="";var characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<i_Length;i++){result+=characters.charAt(Math.floor(Math.random()*characters.length))}return result};Utilities.FixFloatingPointError=function(i_Num,i_Points){if(i_Points===void 0){i_Points=2}if(i_Num){return Number(Number(i_Num).toFixed(i_Points))}return i_Num};Object.defineProperty(Utilities,"NonBreakingSpace",{get:function(){return String.fromCharCode(160)},enumerable:true,configurable:true});Utilities.PauseGame=function(){if(typeof cr_setSuspended==="function"){cr_setSuspended(true)}};Utilities.ResumeGame=function(){if(typeof cr_setSuspended==="function"){cr_setSuspended(false)}};Utilities.isNullOrEmpty=function(str){var returnValue=false;if(!str||str==null||str==="null"||str===""||str==="{}"||str==="undefined"||str.length===0){returnValue=true}return returnValue};Object.defineProperty(Utilities,"isPop",{get:function(){return ServiceWrapper_1.ServiceWrapper.Info.UrlVars.SupportLogOut},enumerable:true,configurable:true});Object.defineProperty(Utilities,"isParimatch",{get:function(){var inter=ServiceWrapper_1.ServiceWrapper.getUrlVars()["inter"];return inter&&Number(inter)===23},enumerable:true,configurable:true});Object.defineProperty(Utilities,"isPariplay",{get:function(){var inter=ServiceWrapper_1.ServiceWrapper.getUrlVars()["inter"];return inter&&Number(inter)===19},enumerable:true,configurable:true});Object.defineProperty(Utilities,"isSG",{get:function(){return window.GcmCore},enumerable:true,configurable:true});return Utilities}();exports.Utilities=Utilities},{"./Wrappers/ErrorWrapper":30,"./Wrappers/ServiceWrapper":41}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Version=function(){function Version(){}Version.Init=function(){var version=38;if(!window.versionsComponents)window.versionsComponents={};window.versionsComponents.SW=version};return Version}();exports.Version=Version},{}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ServiceWrapper_1=require("./ServiceWrapper");var AudioWrapper=function(){function AudioWrapper(){this.m_SoundPlayers=[];this.m_Sounds=[];this.m_SoundPaths=[];this.LoadSound("GENERIC_CLICK","generic_button")}AudioWrapper.prototype.LoadSound=function(i_Key,i_SoundPath,i_IsCustomPath){if(i_IsCustomPath===void 0){i_IsCustomPath=false}if(this.m_Sounds.includes(i_Key)||!i_SoundPath||i_SoundPath===""){return false}var format=i_SoundPath.split(".")[1];if(!format){i_SoundPath+=".mp3"}else if(format!=="mp3"){ServiceWrapper_1.ServiceWrapper.LogWarning("[AudioWrapper] "+i_Key+" Loaded with "+format+" format - for best support and quality best use .mp3 format.")}var loadingPath="";if(!i_IsCustomPath){loadingPath=ServiceWrapper_1.ServiceWrapper.ExternalComponentPath+"sounds/"}this.m_SoundPlayers[i_Key]=new Audio(loadingPath+i_SoundPath);this.m_SoundPlayers[i_Key].preload="auto";var soundIndex=this.m_SoundPaths.indexOf(i_SoundPath);if(soundIndex!==-1){ServiceWrapper_1.ServiceWrapper.LogError("[AudioWrapper] The sound "+i_Key+" already exists under a different key: "+this.m_Sounds[soundIndex]+".")}this.m_Sounds.push(i_Key);this.m_SoundPaths.push(i_SoundPath);return true};AudioWrapper.prototype.PlaySound=function(i_Key,i_SoundPath){if(i_SoundPath===void 0){i_SoundPath=""}if(this.m_Sounds.includes(i_Key)||this.LoadSound(i_Key,i_SoundPath)){if(!ServiceWrapper_1.ServiceWrapper.IsSoundOn){return}this.m_SoundPlayers[i_Key].currentTime=0;this.m_SoundPlayers[i_Key].play()}};Object.defineProperty(AudioWrapper.prototype,"Keys",{get:function(){return this.m_Sounds},enumerable:true,configurable:true});return AudioWrapper}();exports.AudioWrapper=AudioWrapper},{"./ServiceWrapper":41}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var Utilities_1=require("../Utilities");var ErrorWrapper_1=require("./ErrorWrapper");var GolWrapper_1=require("./GolWrapper");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var BalanceWrapper=function(){function BalanceWrapper(){}BalanceWrapper.activate=function(){BalanceWrapper.isActive=true};BalanceWrapper.HandleParimatch=function(){var _this=this;if(Utilities_1.Utilities.isParimatch){setInterval(function(){_this.sendAjaxRequest("ReadBalanceUpdate",true)},6e4)}};BalanceWrapper.sendAjaxRequest=function(i_ReturnFunction,i_IsParimatchPushing){if(i_IsParimatchPushing===void 0){i_IsParimatchPushing=false}var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"BalanceInfo",data:parameters,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){if(!i_IsParimatchPushing){if(ExternalComponents_1.ExternalComponents.AutoPlayMenu){ExternalComponents_1.ExternalComponents.AutoPlayMenu.LatestBalance=result.Result.CoinOut}Utilities_1.Utilities.SendC2Message(i_ReturnFunction,result)}},error:function(jqXHR,exception){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,i_ReturnFunction)}})};BalanceWrapper.requestBalance=function(){if(GolWrapper_1.GolWrapper.isActive){GolWrapper_1.GolWrapper.updateBalance()}else if(BalanceWrapper.isActive){BalanceWrapper.sendAjaxRequest("ReadBalanceUpdate")}};BalanceWrapper.isActive=false;return BalanceWrapper}();exports.BalanceWrapper=BalanceWrapper},{"../ExternalComponents/ExternalComponents":8,"../Utilities":22,"./ErrorWrapper":30,"./GolWrapper":36,"./ServiceWrapper":41,"./StartTicketWrapper":42}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var TicketEndWrapper_1=require("./TicketEndWrapper");var TicketWrapper_1=require("./TicketWrapper");var BonusWrapper=function(){function BonusWrapper(){}BonusWrapper.saveGame=function(params){if(!BonusWrapper.m_IsBonusStarted){BonusWrapper.m_IsBonusStarted=true;ServiceWrapper_1.ServiceWrapper.BonusStart()}var saveData=JSON.parse(params);var data={token:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,ticketId:saveData.ticketId,json:saveData.json};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"SaveGame",data:parameters,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(){},error:function(){}})};BonusWrapper.endGame=function(params){var saveData=JSON.parse(params);BonusWrapper.m_IsBonusStarted=false;ServiceWrapper_1.ServiceWrapper.BonusEnd();var data={token:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,ticketId:saveData.ticketId};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"BonusEnd",data:parameters,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(){if(!TicketWrapper_1.TicketWrapper.playedOnce){if(TicketEndWrapper_1.TicketEndWrapper.isActive){TicketEndWrapper_1.TicketEndWrapper.pendingEnd=true;TicketEndWrapper_1.TicketEndWrapper.request(data.ticketId)}}},error:function(){}})};BonusWrapper.m_IsBonusStarted=false;return BonusWrapper}();exports.BonusWrapper=BonusWrapper},{"./ServiceWrapper":41,"./StartTicketWrapper":42,"./TicketEndWrapper":45,"./TicketWrapper":46}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utilities_1=require("../Utilities");var ErrorWrapper_1=require("./ErrorWrapper");var GameEvents_1=require("../GameEvents");var GambleWrapper_1=require("./GambleWrapper");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var TicketEndWrapper_1=require("./TicketEndWrapper");var TicketWrapper_1=require("./TicketWrapper");var FreeSpinsPickerWrapper_1=require("./FreeSpinsPickerWrapper");var BuyFeatureWrapper=function(){function BuyFeatureWrapper(){}BuyFeatureWrapper.sendAjaxRequest=function(bet,freeSpinType,freeSpinAmount,lines,buyFeatureType,onSuccess){var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,bet:bet,freeSpinType:freeSpinType,freeSpinAmount:freeSpinAmount,lines:lines,buyFeatureType:buyFeatureType};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"BuyFeature",data:parameters,timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){if(result!==null&&result.ResultInfo!==null){if(result.ResultInfo.Code>0){result.ResultInfo=ErrorWrapper_1.ErrorWrapper.UpdateError(result.ResultInfo)}else{if(result.Result!=null&&result.Result.FreeTickets!=null&&"Gamble"in result.Result.FreeTickets&&result.Result.FreeTickets.Gamble!=null){GambleWrapper_1.GambleWrapper.isActive=true}}}if(TicketEndWrapper_1.TicketEndWrapper.isActive&&result&&result.Result&&data.buyFeatureType===2){TicketEndWrapper_1.TicketEndWrapper.pendingEnd=true;TicketWrapper_1.TicketWrapper.lastTicketId=result.Result.UniqueIdentifier}Utilities_1.Utilities.SendC2Message(onSuccess,result);GameEvents_1.GameEvents.BetPlaced(bet,"buyFeature");if(typeof GameEvents_1.GameEvents.MessageTrigger==="function")GameEvents_1.GameEvents.MessageTrigger(result)},error:function(jqXHR,exception){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,onSuccess)}})};BuyFeatureWrapper.request=function(bet,freeSpinType,freeSpinAmount,lines,type,onSuccess){if(BuyFeatureWrapper.isActive){BuyFeatureWrapper.sendAjaxRequest(bet,freeSpinType,freeSpinAmount,lines,type,onSuccess)}};Object.defineProperty(BuyFeatureWrapper,"isActive",{get:function(){var _a,_b;return!!this.buyFeatureCost&&((_b=(_a=ServiceWrapper_1.ServiceWrapper.Info)===null||_a===void 0?void 0:_a.EnvironmentInfo)===null||_b===void 0?void 0:_b.IsBuyFeatureEnabled)},enumerable:true,configurable:true});Object.defineProperty(BuyFeatureWrapper,"buyFeatureCost",{get:function(){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l;if((_a=FreeSpinsPickerWrapper_1.FreeSpinsPickerWrapper.LatestTicketResult)===null||_a===void 0?void 0:_a.ComplexFeatureOptions){return FreeSpinsPickerWrapper_1.FreeSpinsPickerWrapper.LatestTicketResult.ComplexFeatureOptions.BuyFeatureCost}if((_f=(_e=(_d=(_c=(_b=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_b===void 0?void 0:_b.Result)===null||_c===void 0?void 0:_c.LastData)===null||_d===void 0?void 0:_d.FreeTickets)===null||_e===void 0?void 0:_e.ComplexFeatureOptions)===null||_f===void 0?void 0:_f.BuyFeatureCost){return StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.LastData.FreeTickets.ComplexFeatureOptions.BuyFeatureCost}if((_h=(_g=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_g===void 0?void 0:_g.Result)===null||_h===void 0?void 0:_h.BuyFeatures){return(_j=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.BuyFeatures[0])===null||_j===void 0?void 0:_j.BuyFeatureCost}if((_l=(_k=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_k===void 0?void 0:_k.Result)===null||_l===void 0?void 0:_l.BuyFeatureCost){return StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.BuyFeatureCost}return null},enumerable:true,configurable:true});return BuyFeatureWrapper}();exports.BuyFeatureWrapper=BuyFeatureWrapper},{"../GameEvents":20,"../Utilities":22,"./ErrorWrapper":30,"./FreeSpinsPickerWrapper":31,"./GambleWrapper":33,"./ServiceWrapper":41,"./StartTicketWrapper":42,"./TicketEndWrapper":45,"./TicketWrapper":46}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utilities_1=require("../Utilities");var BalanceWrapper_1=require("./BalanceWrapper");var ErrorWrapper_1=require("./ErrorWrapper");var LogWrapper_1=require("./LogWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var CommunicationWrapper=function(){function CommunicationWrapper(){this.ListenForEvents();ServiceWrapper_1.ServiceWrapper.Communications=this}CommunicationWrapper.prototype.TriggerSpin=function(){this.PassParams("TriggerSpin","")};CommunicationWrapper.prototype.TriggerStopSpin=function(){this.PassParams("TriggerStopSpin","")};CommunicationWrapper.prototype.TriggerAutoPlayOn=function(){if(ServiceWrapper_1.ServiceWrapper.IsAutoPlayToggleEnabled){this.PassParams("TriggerAutoPlayOn","")}else{this.PrintToConsole("Auto Play toggle is disabled")}};CommunicationWrapper.prototype.TriggerAutoPlayOff=function(){if(ServiceWrapper_1.ServiceWrapper.IsAutoPlayToggleEnabled){this.PassParams("TriggerAutoPlayOff","")}else{this.PrintToConsole("Auto Play toggle is disabled")}};CommunicationWrapper.prototype.TriggerTurboOn=function(){if(ServiceWrapper_1.ServiceWrapper.IsTurboToggleEnabled){this.PassParams("TriggerTurboOn","")}else{this.PrintToConsole("Turbo toggle is disabled")}};CommunicationWrapper.prototype.TriggerTurboOff=function(){if(ServiceWrapper_1.ServiceWrapper.IsTurboToggleEnabled){this.PassParams("TriggerTurboOff","")}else{this.PrintToConsole("Turbo toggle is disabled")}};CommunicationWrapper.prototype.TriggerSoundOn=function(){if(ServiceWrapper_1.ServiceWrapper.IsSoundToggleEnabled){this.PassParams("TriggerSoundOn","")}else{this.PrintToConsole("Sound toggle is disabled")}};CommunicationWrapper.prototype.TriggerSoundOff=function(){if(ServiceWrapper_1.ServiceWrapper.IsSoundToggleEnabled){this.PassParams("TriggerSoundOff","")}else{this.PrintToConsole("Sound toggle is disabled")}};CommunicationWrapper.prototype.RequestBalanceUpdate=function(){this.PassParams("RequestBalanceUpdate","")};CommunicationWrapper.prototype.TriggerIncreaseBet=function(){if(ServiceWrapper_1.ServiceWrapper.IsStakeChangeEnabled){this.PassParams("TriggerIncreaseBet","")}else{this.PrintToConsole("Stake Change is disabled")}};CommunicationWrapper.prototype.TriggerDecreaseBet=function(){if(ServiceWrapper_1.ServiceWrapper.IsStakeChangeEnabled){this.PassParams("TriggerDecreaseBet","")}else{this.PrintToConsole("Stake Change is disabled")}};CommunicationWrapper.prototype.TriggerIncreaseLines=function(){this.PassParams("TriggerIncreaseLines","")};CommunicationWrapper.prototype.TriggerDecreaseLines=function(){this.PassParams("TriggerDecreaseLines","")};CommunicationWrapper.prototype.SetLines=function(i_NewLines){this.PassParams("SetLines",i_NewLines)};CommunicationWrapper.prototype.SetBet=function(i_NewBet){this.PassParams("SetBet",i_NewBet)};CommunicationWrapper.prototype.TriggerMaxBet=function(){this.PassParams("TriggerMaxBet","")};CommunicationWrapper.prototype.TriggerMaxLines=function(){this.PassParams("TriggerMaxLines","")};CommunicationWrapper.prototype.DisableSpinButton=function(){this.PassParams("DisableSpin","")};CommunicationWrapper.prototype.EnableSpinButton=function(){this.PassParams("EnableSpin","")};CommunicationWrapper.prototype.ShowMessage=function(i_Message){var error=ErrorWrapper_1.ErrorWrapper.UpdateError({Action:null,DisplayMessage:ErrorWrapper_1.IErrorDisplayMessages.EXTERNAL_MESSAGE,Message:null,Code:null,Buttons:[]});error.Message=i_Message;var response={Result:null,PromoInfo:null,ResultInfo:error,FreeRoundsMarketing:null};Utilities_1.Utilities.SendC2Message("ShowExternalMessage",response)};CommunicationWrapper.prototype.PassParams=function(i_TriggerName,i_Param){Utilities_1.Utilities.SendC2Message(i_TriggerName,i_Param)};CommunicationWrapper.prototype.PrintToConsole=function(i_Msg){ServiceWrapper_1.ServiceWrapper.LogMessageWithColor("[CommunicationWrapper] "+i_Msg,LogWrapper_1.LogMessageColor.CommunicationWrapper,LogWrapper_1.LogMessageColor.CommunicationWrapperBG)};CommunicationWrapper.prototype.ListenForEvents=function(){switch(ServiceWrapper_1.ServiceWrapper.getUrlVars()["inter"]){case"19":break;default:this.PrintToConsole("integration for events and triggers has not been specified");break}this.ListenToMessages()};CommunicationWrapper.prototype.ListenToMessages=function(){var _this=this;var isGameStateExists=function(){return ServiceWrapper_1.ServiceWrapper.Info&&ServiceWrapper_1.ServiceWrapper.Info.GameState};var handleMessage=function(eventData){if(!eventData||!eventData.data){ServiceWrapper_1.ServiceWrapper.LogError("message event triggered with bad data "+JSON.stringify(eventData));return}var integrationCode=parseInt(ServiceWrapper_1.ServiceWrapper.getUrlVars()["inter"]);var type=eventData.data.type;if(InterActionTypeValidation.IsStopAutoBet(type,integrationCode)){_this.LogIncomingPostMessage(type,integrationCode);_this.TriggerAutoPlayOff();ServiceWrapper_1.ServiceWrapper.StopAutoPlay()}else if(InterActionTypeValidation.IsDisableBet(type,integrationCode)){_this.LogIncomingPostMessage(type,integrationCode);if(isGameStateExists()){ServiceWrapper_1.ServiceWrapper.Info.GameState.isSpinDisabled=true}ServiceWrapper_1.ServiceWrapper.eOnDisableSpin.Trigger();_this.DisableSpinButton()}else if(InterActionTypeValidation.IsEnableBet(type,integrationCode)){_this.LogIncomingPostMessage(type,integrationCode);if(isGameStateExists()){ServiceWrapper_1.ServiceWrapper.Info.GameState.isSpinDisabled=false}ServiceWrapper_1.ServiceWrapper.eOnEnableSpin.Trigger();_this.EnableSpinButton()}else if(InterActionTypeValidation.IsPauseGame(type,integrationCode)){_this.LogIncomingPostMessage(type,integrationCode);if(isGameStateExists()){ServiceWrapper_1.ServiceWrapper.Info.GameState.isPaused=true}Utilities_1.Utilities.PauseGame()}else if(InterActionTypeValidation.IsResumeGame(type,integrationCode)){_this.LogIncomingPostMessage(type,integrationCode);if(isGameStateExists()){ServiceWrapper_1.ServiceWrapper.Info.GameState.isPaused=false}Utilities_1.Utilities.ResumeGame()}else if(InterActionTypeValidation.IsBalanceRefresh(type,integrationCode)){_this.LogIncomingPostMessage(type,integrationCode);BalanceWrapper_1.BalanceWrapper.requestBalance()}};window.addEventListener("message",handleMessage.bind(this),false)};CommunicationWrapper.prototype.LogIncomingPostMessage=function(i_Type,i_InterCode){ServiceWrapper_1.ServiceWrapper.logMessage("Received post-message - type: "+i_Type+", integration: "+i_InterCode)};return CommunicationWrapper}();exports.CommunicationWrapper=CommunicationWrapper;var InterActionTypeValidation=function(){function InterActionTypeValidation(){}InterActionTypeValidation.IsStopAutoBet=function(i_Type,i_InterCode){if(Utilities_1.Utilities.isPariplay){return i_Type==="stopAutobet"}else if(!InterActionTypeValidation.externalInterApis.includes(i_InterCode)){return i_Type==="stopAutoBet"}};InterActionTypeValidation.IsDisableBet=function(i_Type,i_InterCode){if(!InterActionTypeValidation.externalInterApis.includes(i_InterCode)){return i_Type==="disableBet"}return false};InterActionTypeValidation.IsEnableBet=function(i_Type,i_InterCode){if(!InterActionTypeValidation.externalInterApis.includes(i_InterCode)){return i_Type==="enableBet"}return false};InterActionTypeValidation.IsPauseGame=function(i_Type,i_InterCode){if(Utilities_1.Utilities.isPariplay){return i_Type==="pause"}else if(!InterActionTypeValidation.externalInterApis.includes(i_InterCode)){return i_Type==="pauseGame"}};InterActionTypeValidation.IsResumeGame=function(i_Type,i_InterCode){if(Utilities_1.Utilities.isPariplay){return i_Type==="resume"}else if(!InterActionTypeValidation.externalInterApis.includes(i_InterCode)){return i_Type==="resumeGame"}};InterActionTypeValidation.IsBalanceRefresh=function(i_Type,i_InterCode){if(!InterActionTypeValidation.externalInterApis.includes(i_InterCode)){return i_Type==="balanceRefresh"}return false};InterActionTypeValidation.externalInterApis=[19];return InterActionTypeValidation}()},{"../Utilities":22,"./BalanceWrapper":25,"./ErrorWrapper":30,"./LogWrapper":37,"./ServiceWrapper":41}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utilities_1=require("../Utilities");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var GameEvents_1=require("../GameEvents");var CurrencyWrapper=function(){function CurrencyWrapper(){}Object.defineProperty(CurrencyWrapper,"CurrencyFormatter",{get:function(){if(this.m_CurrencyFormatter){return this.m_CurrencyFormatter}var lang=ServiceWrapper_1.ServiceWrapper.Info.UrlVars.LangCode.replace("_","-");if(lang==="bg-BG")lang="ru-RU";else if(lang==="hr-HR")lang="de-DE";var attempts=0;while(!this.m_CurrencyFormatter&&attempts<4){this.m_CurrencyFormatter=new Intl.NumberFormat(lang,{style:"currency",currency:CurrencyWrapper.DefaultSymbolDebug?CurrencyWrapper.DefaultSymbolDebug:ServiceWrapper_1.ServiceWrapper.currency,maximumFractionDigits:10,minimumFractionDigits:0,currencyDisplay:"symbol"});attempts++}return this.m_CurrencyFormatter},enumerable:true,configurable:true});Object.defineProperty(CurrencyWrapper,"NumberFormatter",{get:function(){if(this.m_NumberFormatter){return this.m_NumberFormatter}var lang=ServiceWrapper_1.ServiceWrapper.Info.UrlVars.LangCode.replace("_","-");if(lang==="bg-BG")lang="ru-RU";else if(lang==="hr-HR")lang="de-DE";var attempts=0;while(!this.m_NumberFormatter&&attempts<4){this.m_NumberFormatter=new Intl.NumberFormat(lang,{maximumFractionDigits:10,minimumFractionDigits:0,currencyDisplay:"symbol"});attempts++}return this.m_NumberFormatter},enumerable:true,configurable:true});CurrencyWrapper.FormatNumber=function(i_Number){var _a;if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsSocial&&ServiceWrapper_1.ServiceWrapper.IsGameSupportsSpaceForWhow){return(""+i_Number).replace(/(\d)(?=(?:\d{3})+(?:\.|$))|(\.\d\d*)\d*$/g,function(m,s1,s2){return s2||s1+Utilities_1.Utilities.NonBreakingSpace})}else if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsCertified&&typeof((_a=this.NumberFormatter)===null||_a===void 0?void 0:_a.formatToParts)==="function"){var num=Number(i_Number);if(!num){return i_Number}if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo&&!ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsDecimalPointShown){return this.NumberFormatter.formatToParts(num).map(function(_a){var type=_a.type,value=_a.value;switch(type){case"decimal":case"fraction":return"";default:return value}}).reduce(function(str,part){return str+part})}var res=this.NumberFormatter.format(Number(i_Number));if(res.includes(String.fromCharCode(8239))){return res.split(String.fromCharCode(8239)).join(Utilities_1.Utilities.NonBreakingSpace)}return res}return(""+i_Number).replace(/(\d)(?=(?:\d{3})+(?:\.|$))|(\.\d\d*)\d*$/g,function(m,s1,s2){return s2||s1+","})};CurrencyWrapper.FormatCurrency=function(i_Number,i_UseCurrencyCode){var _a,_b;if(Utilities_1.Utilities.isSG){return GameEvents_1.GameEvents.FormatAmount(Number(i_Number))}if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsCertified){var num=Number(i_Number);if(!num){return i_Number}var zeroesAmountToRestore_1=0;var afterDot=(i_Number+"").split(".")[1];if(afterDot){var afterDotArr=afterDot.split("");var zeroIndex=afterDotArr.length-1;while(afterDotArr[zeroIndex]==="0"){zeroesAmountToRestore_1++;zeroIndex--}}var lang=(_b=(_a=CurrencyWrapper.DefaultLanguageDebug)===null||_a===void 0?void 0:_a.replace("_","-"),_b!==null&&_b!==void 0?_b:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.LangCode.replace("_","-"));if(!ServiceWrapper_1.ServiceWrapper.isNullOrEmpty(ServiceWrapper_1.ServiceWrapper.currency)){if(!this.CurrencyFormatter||typeof this.CurrencyFormatter.formatToParts!=="function"){return CurrencyWrapper.FormatNumber(i_Number)}var result=this.CurrencyFormatter.formatToParts(num);if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo&&!ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsDecimalPointShown){return result.map(function(_a){var type=_a.type,value=_a.value;switch(type){case"decimal":case"fraction":return"";default:return value}}).reduce(function(str,part){return str+part})}else{if(result.find(function(a){return a.type==="fraction"})){return result.map(function(_a){var type=_a.type,value=_a.value;switch(type){case"group":if(value.charCodeAt(0)===8239){return Utilities_1.Utilities.NonBreakingSpace}return value;case"decimal":return value;case"fraction":var newVal=value;for(var i=0;i<zeroesAmountToRestore_1;i++){newVal+="0"}return newVal;default:return value}}).reduce(function(str,part){return str+part})}else{if(zeroesAmountToRestore_1>0){var lastInt_1=0;result.forEach(function(part,i){if(part.type==="integer"){lastInt_1=i}});var langDecimalSign_1=this.CurrencyFormatter.formatToParts(3.1).find(function(part){return part.type==="decimal"}).value;return result.map(function(_a,index){var type=_a.type,value=_a.value;switch(type){case"group":if(value.charCodeAt(0)===8239){return Utilities_1.Utilities.NonBreakingSpace}return value;case"integer":if(index<lastInt_1){return value}var newVal=value+langDecimalSign_1;for(var i=0;i<zeroesAmountToRestore_1;i++){newVal+="0"}return newVal;default:return value}}).reduce(function(str,part){return str+part})}var finalResult=this.CurrencyFormatter.format(num);if(finalResult.indexOf(String.fromCharCode(8239))!==-1){return finalResult.split(String.fromCharCode(8239)).join(Utilities_1.Utilities.NonBreakingSpace)}return finalResult}}}var formatter=new Intl.NumberFormat(lang);var res=formatter.formatToParts(num);if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo&&!ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsDecimalPointShown){return res.map(function(_a){var type=_a.type,value=_a.value;switch(type){case"decimal":case"fraction":return"";default:return value}}).reduce(function(str,part){return str+part})}else{if(res.find(function(a){return a.type==="fraction"})){return res.map(function(_a){var type=_a.type,value=_a.value;switch(type){case"decimal":return value;case"fraction":var newVal=value;for(var i=0;i<zeroesAmountToRestore_1;i++){newVal+="0"}return newVal;default:return value}}).reduce(function(str,part){return str+part})}else{if(zeroesAmountToRestore_1>0){var lastInt_2=0;res.forEach(function(part,i){if(part.type==="integer"){lastInt_2=i}});var langDecimalSign_2=formatter.formatToParts(3.1).find(function(part){return part.type==="decimal"}).value;return res.map(function(_a,index){var type=_a.type,value=_a.value;switch(type){case"integer":if(index<lastInt_2){return value}var newVal=value+langDecimalSign_2;for(var i=0;i<zeroesAmountToRestore_1;i++){newVal+="0"}return newVal;default:return value}}).reduce(function(str,part){return str+part})}return formatter.format(num)}}}i_Number=CurrencyWrapper.FormatNumber(i_Number);if(typeof StartTicketWrapper_1.StartTicketWrapper.startTicket==="undefined"||!StartTicketWrapper_1.StartTicketWrapper.startTicket||typeof StartTicketWrapper_1.StartTicketWrapper.startTicket.Result==="undefined"||!StartTicketWrapper_1.StartTicketWrapper.startTicket.Result||typeof StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.CurrencySymbol==="undefined"||ServiceWrapper_1.ServiceWrapper.isNullOrEmpty(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.CurrencySymbol)){return i_Number}return StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.CurrencySymbol+i_Number};CurrencyWrapper.DefaultLanguageDebug=null;CurrencyWrapper.DefaultSymbolDebug=null;return CurrencyWrapper}();exports.CurrencyWrapper=CurrencyWrapper},{"../GameEvents":20,"../Utilities":22,"./ServiceWrapper":41,"./StartTicketWrapper":42}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Definitions_1=require("../Definitions");var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var Utilities_1=require("../Utilities");var GameEvents_1=require("../GameEvents");var GolWrapper_1=require("./GolWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var IErrorButtonActions;(function(IErrorButtonActions){IErrorButtonActions["Close"]="None";IErrorButtonActions["Reload"]="Reload";IErrorButtonActions["CashierUrl"]="CashierUrl";IErrorButtonActions["PlayForRealUrl"]="PlayForRealUrl";IErrorButtonActions["PlayForFunUrl"]="PlayForFunUrl";IErrorButtonActions["ViewLastTicket"]="ViewLastTicket";IErrorButtonActions["SESSION_TIME_FREQUENCY"]="SESSION_TIME_FREQUENCY";IErrorButtonActions["Terminate"]="Terminate"})(IErrorButtonActions=exports.IErrorButtonActions||(exports.IErrorButtonActions={}));var IErrorDisplayMessages;(function(IErrorDisplayMessages){IErrorDisplayMessages["TEMPORARY_ERROR"]="TEMPORARY_ERROR";IErrorDisplayMessages["TOKEN_EXPIRED"]="TOKEN_EXPIRED";IErrorDisplayMessages["INVALID_COUNTRY"]="INVALID_COUNTRY";IErrorDisplayMessages["PLEASE_LOGIN"]="PLEASE_LOGIN";IErrorDisplayMessages["ACCOUNT_LOCKED"]="ACCOUNT_LOCKED";IErrorDisplayMessages["GAME_NOT_AVAILABLE"]="GAME_NOT_AVAILABLE";IErrorDisplayMessages["INVALID_TICKET"]="INVALID_TICKET";IErrorDisplayMessages["INSUFFICIENT"]="INSUFFICIENT";IErrorDisplayMessages["InsufficientFunds"]="Insufficient Funds";IErrorDisplayMessages["BET_NOT_PLACED"]="BET_NOT_PLACED";IErrorDisplayMessages["SESSION_EXPIRED"]="SESSION_EXPIRED";IErrorDisplayMessages["EXT_SESSION_EXPIRED"]="EXT_SessionExpired";IErrorDisplayMessages["WAGER_LIMIT"]="WAGER_LIMIT";IErrorDisplayMessages["NO_BUY_FEATURE"]="NO_BUY_FEATURE";IErrorDisplayMessages["RESUME_COMMUNICATION"]="Resume Communication";IErrorDisplayMessages["EXTERNAL_MESSAGE"]="External Message";IErrorDisplayMessages["TOURNAMENT_STARTED"]="TOURNAMENT_STARTED"})(IErrorDisplayMessages=exports.IErrorDisplayMessages||(exports.IErrorDisplayMessages={}));var ErrorWrapper=function(){function ErrorWrapper(){}ErrorWrapper.HandleError=function(jqXHR,exception,onError,i_IsStartError){if(i_IsStartError===void 0){i_IsStartError=false}if(jqXHR.status===0||jqXHR.status===500||exception==="timeout"){var dataError={Result:null,ResultInfo:{Action:null,DisplayMessage:IErrorDisplayMessages.TEMPORARY_ERROR,Message:null,Code:5e3,Buttons:[]}};dataError.ResultInfo=ErrorWrapper.UpdateError(dataError.ResultInfo,i_IsStartError);if(!ServiceWrapper_1.ServiceWrapper.isNullOrEmpty(onError)){Utilities_1.Utilities.SendC2Message(onError,dataError)}return dataError}return null};ErrorWrapper.HandleBspotError=function(i_DisplayMessage){var code=5019;switch(i_DisplayMessage){case"TOKEN_EXPIRED":code=6003;break}var res={Action:null,DisplayMessage:i_DisplayMessage,Message:null,Code:code,Buttons:[]};return ErrorWrapper.UpdateError(res)};ErrorWrapper.UpdateError=function(i_ResultInfo,i_IsStartError){if(i_IsStartError===void 0){i_IsStartError=false}switch(i_ResultInfo.DisplayMessage){case IErrorDisplayMessages.TOKEN_EXPIRED:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_TokenExpired;i_ResultInfo.Buttons=[];if(!ServiceWrapper_1.ServiceWrapper.isNullOrEmpty(ServiceWrapper_1.ServiceWrapper.CrossLaunchUrl)){i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:IErrorButtonActions.Reload})}break;case IErrorDisplayMessages.INVALID_COUNTRY:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_InvalidCountry;i_ResultInfo.Buttons=[];break;case IErrorDisplayMessages.PLEASE_LOGIN:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_Logout;i_ResultInfo.Buttons=[];break;case IErrorDisplayMessages.ACCOUNT_LOCKED:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_AccountLocked;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:IErrorButtonActions.Reload});break;case IErrorDisplayMessages.GAME_NOT_AVAILABLE:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_TemporaryUnAvailable;i_ResultInfo.Buttons=[];break;case IErrorDisplayMessages.INVALID_TICKET:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_TemporaryError;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:IErrorButtonActions.Reload});break;case IErrorDisplayMessages.InsufficientFunds:case IErrorDisplayMessages.INSUFFICIENT:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_InsufficientFunds;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_OK,Interaction:0,Action:IErrorButtonActions.Close});if(ServiceWrapper_1.ServiceWrapper.cashierUrl!=null){i_ResultInfo.Buttons.push({Text:ServiceWrapper_1.ServiceWrapper.IsBspot?"Add Wagers":ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_Deposit,Interaction:1,Action:IErrorButtonActions.CashierUrl})}else if(ServiceWrapper_1.ServiceWrapper.playForRealUrl!=null){i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_PlayForReal,Interaction:1,Action:IErrorButtonActions.PlayForRealUrl})}break;case IErrorDisplayMessages.TEMPORARY_ERROR:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_TemporaryError;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:IErrorButtonActions.Reload});break;case IErrorDisplayMessages.BET_NOT_PLACED:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_BetNotPlaced;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:0,Action:IErrorButtonActions.Reload});break;case IErrorDisplayMessages.SESSION_EXPIRED:case IErrorDisplayMessages.EXT_SESSION_EXPIRED:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_SessionTimeout;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:IErrorButtonActions.Reload});break;case IErrorDisplayMessages.WAGER_LIMIT:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_WagerLimitExceeded;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Continue,Interaction:0,Action:IErrorButtonActions.Close});break;case IErrorDisplayMessages.NO_BUY_FEATURE:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_NoBuyFeature;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_OK,Interaction:0,Action:IErrorButtonActions.Close});break;case IErrorDisplayMessages.RESUME_COMMUNICATION:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_LastTicket;i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_OK,Interaction:0,Action:IErrorButtonActions.Close});i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_View_Last_Ticket,Interaction:1,Action:IErrorButtonActions.ViewLastTicket});i_ResultInfo.Title=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_ResumeCommunication;break;case IErrorDisplayMessages.TOURNAMENT_STARTED:i_ResultInfo.Message=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_TournamentStartMessage;i_ResultInfo.Buttons=[{Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:IErrorButtonActions.Reload}];i_ResultInfo.Title=ExternalComponents_1.ExternalComponents.Languages.Errors.ERR_TournamentStart;break;case IErrorDisplayMessages.EXTERNAL_MESSAGE:i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_OK,Interaction:0,Action:IErrorButtonActions.Close});break}if(i_ResultInfo.IsFatal){i_ResultInfo.Buttons=null}if(!i_ResultInfo.Message||i_ResultInfo.Message===""){i_ResultInfo.Message=i_ResultInfo.DisplayMessage;i_ResultInfo.Title=i_ResultInfo.Code}if(GolWrapper_1.GolWrapper.isActive){i_ResultInfo.Title=i_ResultInfo.Code+"_"+GolWrapper_1.GolWrapper.machineId}if(Utilities_1.Utilities.isPop){if(i_ResultInfo.DialogMessage){i_ResultInfo.Message=i_ResultInfo.DialogMessage.accountMsg;i_ResultInfo.Title=i_ResultInfo.DisplayMessage;i_ResultInfo.Buttons=[];if(!i_ResultInfo.IsFatal){i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reset,Action:IErrorButtonActions.SESSION_TIME_FREQUENCY,Interaction:0})}i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Quit,Action:IErrorButtonActions.Terminate,Interaction:1});i_ResultInfo.Slider={Id:"SESSION_TIME_FREQUENCY",Values:i_ResultInfo.DialogMessage.extraData.availablePeriods}}else{if(i_ResultInfo.Code===6014||i_ResultInfo.Code===6004||i_ResultInfo.Code===6006){i_ResultInfo.Title=i_ResultInfo.Code;i_ResultInfo.Message=i_ResultInfo.DisplayMessage;if(i_ResultInfo.Code===6014){i_ResultInfo.Buttons=[];i_ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_OK,Action:IErrorButtonActions.Close,Interaction:0})}}}if(i_ResultInfo.Buttons){i_ResultInfo.Buttons=i_ResultInfo.Buttons.filter(function(b){return b.Text!=ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload})}}if(i_IsStartError){GameEvents_1.GameEvents.OnLoadingError("ERROR "+i_ResultInfo.Code+": "+i_ResultInfo.Message);if(Utilities_1.Utilities.isSG&&typeof GameEvents_1.GameEvents.OnSGLoadingError==="function"){GameEvents_1.GameEvents.OnSGLoadingError(i_ResultInfo)}}else{GameEvents_1.GameEvents.OnError(i_ResultInfo)}return i_ResultInfo};ErrorWrapper.UpdateErrorSG=function(i_ResultInfo){var _a;var errorParams={};errorParams.errorCode="";errorParams.errorMessage=(_a=i_ResultInfo.Message,_a!==null&&_a!==void 0?_a:i_ResultInfo.DisplayMessage);errorParams.errorSeverity=Definitions_1.ISGErrorSeverity.ERROR;switch(i_ResultInfo.Code){case 1e3:case 3e3:case 4e3:case 5018:case 5019:case 5024:case 5020:case 6008:errorParams.errorCategory=Definitions_1.ISGErrorCategory.NON_RECOVERABLE_ERROR;break;case 6009:case 6010:errorParams.errorCategory=Definitions_1.ISGErrorCategory.RECOVERABLE_ERROR;break;case 6011:case 5014:errorParams.errorCategory=Definitions_1.ISGErrorCategory.INSUFFICIENT_FUNDS;errorParams.errorSeverity=Definitions_1.ISGErrorSeverity.INFO;break;case 6012:errorParams.errorCategory=Definitions_1.ISGErrorCategory.LOGIN_ERROR;break;case 5e3:errorParams.errorCategory=Definitions_1.ISGErrorCategory.CONNECTION_ERROR;break;default:errorParams.errorCategory=Definitions_1.ISGErrorCategory.CRITICAL;break}GameEvents_1.GameEvents.SGErrorHandler(errorParams)};ErrorWrapper.ThrowExternalComponentNotLoadedError=function(){var error={Action:null,DisplayMessage:IErrorDisplayMessages.TEMPORARY_ERROR,Message:null,Code:5e3,Buttons:[]};var response={Result:null,PromoInfo:null,ResultInfo:ErrorWrapper.UpdateError(error),FreeRoundsMarketing:null};Utilities_1.Utilities.SendC2Message("ExternalComponentNotLoaded",response)};Object.defineProperty(ErrorWrapper,"ClassIdDoesNotMatchError",{get:function(){var error={Action:null,DisplayMessage:IErrorDisplayMessages.GAME_NOT_AVAILABLE,Message:null,Code:4999,Buttons:[]};var response={Result:null,PromoInfo:null,ResultInfo:error,FreeRoundsMarketing:null};return response},enumerable:true,configurable:true});Object.defineProperty(ErrorWrapper,"TournamentStartErrorTicket",{get:function(){var error={Action:null,DisplayMessage:IErrorDisplayMessages.TOURNAMENT_STARTED,Message:null,Code:4998,Buttons:[]};var response={Result:null,PromoInfo:null,ResultInfo:ErrorWrapper.UpdateError(error),FreeRoundsMarketing:null};return response},enumerable:true,configurable:true});ErrorWrapper.ExternalErrorProjectExists=false;return ErrorWrapper}();exports.ErrorWrapper=ErrorWrapper},{"../Definitions":5,"../ExternalComponents/ExternalComponents":8,"../GameEvents":20,"../Utilities":22,"./GolWrapper":36,"./ServiceWrapper":41}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var Utilities_1=require("../Utilities");var ErrorWrapper_1=require("./ErrorWrapper");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var FreeSpinsPickerWrapper=function(){function FreeSpinsPickerWrapper(){}FreeSpinsPickerWrapper.sendAjaxRequest=function(ticketId,freeSpinsType,action,onSuccess){var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,freeSpinsType:freeSpinsType,ticketId:ticketId,action:action};if(FreeSpinsPickerWrapper.forceResult!==0){data.ForceResult=FreeSpinsPickerWrapper.forceResult}if(FreeSpinsPickerWrapper.forceAmountOfFreeSpin!==0){data.ForceAmountOfFreeSpin=FreeSpinsPickerWrapper.forceAmountOfFreeSpin}FreeSpinsPickerWrapper.forceResult=0;FreeSpinsPickerWrapper.forceAmountOfFreeSpin=0;if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}data.RequestBalance=false;if(data.action==="Spin"){data.RequestBalance=true}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"PickFreeSpins",data:parameters,timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){var _a;if(result!==null&&result.ResultInfo!==null&&result.ResultInfo.Code>0){result.ResultInfo=ErrorWrapper_1.ErrorWrapper.UpdateError(result.ResultInfo);result.ResultInfo.Buttons=[];result.ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:"Reload"})}FreeSpinsPickerWrapper.LatestTicketResult=(_a=result)===null||_a===void 0?void 0:_a.Result;if(result!==null&&result.Result!==null&&result.ResultInfo!==null&&result.ResultInfo.Code==0){if(result.Result.PendingAction){FreeSpinsPickerWrapper.forceResult=data.ForceResult}}Utilities_1.Utilities.SendC2Message(onSuccess,result)},error:function(jqXHR,exception){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,onSuccess)}})};FreeSpinsPickerWrapper.request=function(ticketId,freeSpinType,action,onSuccess){FreeSpinsPickerWrapper.sendAjaxRequest(ticketId,freeSpinType,action,onSuccess)};FreeSpinsPickerWrapper.LatestTicketResult=null;FreeSpinsPickerWrapper.forceResult=0;FreeSpinsPickerWrapper.forceAmountOfFreeSpin=0;return FreeSpinsPickerWrapper}();exports.FreeSpinsPickerWrapper=FreeSpinsPickerWrapper},{"../ExternalComponents/ExternalComponents":8,"../Utilities":22,"./ErrorWrapper":30,"./ServiceWrapper":41,"./StartTicketWrapper":42}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var ServiceWrapper_1=require("./ServiceWrapper");var FullScreenWrapper=function(){function FullScreenWrapper(){var _this=this;if((ExternalComponents_1.ExternalComponents.DeviceDetector.isMobile||ExternalComponents_1.ExternalComponents.DeviceDetector.isTablet)&&ExternalComponents_1.ExternalComponents.DeviceDetector.isAndroid){var onTouchEnd=function(){_this.EnterFullScreen()};document.addEventListener("touchend",onTouchEnd)}}FullScreenWrapper.prototype.EnterFullScreen=function(){if(!this.IsFullScreenSupported){return}if(this.IsInFullScreen){return}if(navigator.userAgent.search("Firefox")>-1){return}try{var element=document.getElementById("game-index");if(element.requestFullscreen){element.requestFullscreen()}else if(element.msRequestFullscreen){element.msRequestFullscreen()}else if(element.mozRequestFullScreen){element.mozRequestFullScreen()}else if(element.webkitRequestFullscreen){element.webkitRequestFullscreen()}}catch(error){ServiceWrapper_1.ServiceWrapper.LogError(error)}};FullScreenWrapper.prototype.ExitFullScreen=function(){if(!this.IsInFullScreen){return}try{if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}}catch(error){ServiceWrapper_1.ServiceWrapper.LogError(error)}};Object.defineProperty(FullScreenWrapper.prototype,"PerGameIsFullScreenSupported",{get:function(){var isNightsOfMagic=ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode.includes("NightsOfMagic");var isRetro=ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode.includes("Retro_");return!isRetro&&!isNightsOfMagic},enumerable:true,configurable:true});Object.defineProperty(FullScreenWrapper.prototype,"IsFullScreenSupported",{get:function(){if(!this.PerGameIsFullScreenSupported||!ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsFullScreenOnTouch){return false}if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){if(ServiceWrapper_1.ServiceWrapper.isInIframe&&(window.navigator.userAgent.indexOf("MSIE")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./))){return false}else{return true}}else{return false}},enumerable:true,configurable:true});Object.defineProperty(FullScreenWrapper.prototype,"IsInFullScreen",{get:function(){return window.fullScreen||document.webkitIsFullScreen||window.innerWidth===screen.width&&window.innerHeight===screen.height},enumerable:true,configurable:true});return FullScreenWrapper}();exports.FullScreenWrapper=FullScreenWrapper},{"../ExternalComponents/ExternalComponents":8,"./ServiceWrapper":41}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var Utilities_1=require("../Utilities");var ErrorWrapper_1=require("./ErrorWrapper");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var GambleWrapper=function(){function GambleWrapper(){}GambleWrapper.request=function(ticketId,isGamble,onSuccess){ServiceWrapper_1.ServiceWrapper.logMessage("sending gamble active is "+GambleWrapper.isActive+" isGamble"+isGamble);if(GambleWrapper.isActive){GambleWrapper.sendAjaxRequest(ticketId,isGamble,onSuccess)}};GambleWrapper.sendAjaxRequest=function(ticketId,isGamble,onSuccess){var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,ticketId:ticketId,isGamble:isGamble};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(GambleWrapper.forceResult!==-1){if(GambleWrapper.forceResult==0)data.ForceResult=2;else data.ForceResult=1;GambleWrapper.forceResult--}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"Gamble",data:parameters,timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){if(result!=null&&result.ResultInfo!=null&&result.ResultInfo.Code>0){result.ResultInfo=ErrorWrapper_1.ErrorWrapper.UpdateError(result.ResultInfo);result.ResultInfo.Buttons=[];result.ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:"Reload"})}else if(result.ResultInfo.Code===0&&result.Result.Gamble==null){GambleWrapper.isActive=false;GambleWrapper.forceResult=-1}Utilities_1.Utilities.SendC2Message(onSuccess,result)},error:function(jqXHR,exception){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,onSuccess)}})};GambleWrapper.isActive=false;GambleWrapper.forceResult=-1;return GambleWrapper}();exports.GambleWrapper=GambleWrapper},{"../ExternalComponents/ExternalComponents":8,"../Utilities":22,"./ErrorWrapper":30,"./ServiceWrapper":41,"./StartTicketWrapper":42}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utilities_1=require("../Utilities");var ServiceWrapper_1=require("./ServiceWrapper");var GameFocusWrapper=function(){function GameFocusWrapper(){var isMac=navigator.platform.toUpperCase().indexOf("MAC")>=0;$("html").on("click",function(){if(!soundFlag){Utilities_1.Utilities.ResumeGame();if(isMac){setTimeout(function(){Utilities_1.Utilities.ResumeGame()},1e3)}soundFlag=true}});var onVisibilityChanged=function(){var hidden=function(){return document["hidden"]||document.mozHidden||document.webkitHidden||document.msHidden};if(hidden()){Utilities_1.Utilities.PauseGame()}else{if(ServiceWrapper_1.ServiceWrapper.Info&&ServiceWrapper_1.ServiceWrapper.Info.GameState&&ServiceWrapper_1.ServiceWrapper.Info.GameState.isPaused){return}Utilities_1.Utilities.ResumeGame()}};document.addEventListener("visibilitychange",onVisibilityChanged,false);document.addEventListener("mozvisibilitychange",onVisibilityChanged,false);document.addEventListener("webkitvisibilitychange",onVisibilityChanged,false);document.addEventListener("msvisibilitychange",onVisibilityChanged,false)}return GameFocusWrapper}();exports.GameFocusWrapper=GameFocusWrapper},{"../Utilities":22,"./ServiceWrapper":41}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var Gandalf=function(){function Gandalf(){ExternalComponents_1.ExternalComponents.Audio.PlaySound("gandalf","gandalf");var div=document.createElement("img");div.style.width="60%";div.style.height="80%";div.style.position="absolute";div.style.left="50%";div.style.top="50%";div.style.transform="translate(-50%, -50%)";div.classList.add("tenor-gif-embed");div.src="https://c.tenor.com/VOdWjm2zbEAAAAAC/gandalf-sax-guy.gif";document.body.appendChild(div)}return Gandalf}();window.Gandalf=function(){new Gandalf}},{"../ExternalComponents/ExternalComponents":8}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utilities_1=require("../Utilities");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var TicketWrapper_1=require("./TicketWrapper");var GolWrapper=function(){function GolWrapper(){}Object.defineProperty(GolWrapper,"isLocal",{get:function(){return!("initialize"in TPBTAPI)},enumerable:true,configurable:true});GolWrapper.init=function(){if(!ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsGOL){return}GolWrapper.adjustParams();GolWrapper.isActive=true;TPBTAPI.config_Func=GolWrapper.onInitConfig;TPBTAPI.creditsAdded_Func=GolWrapper.onCreditAdded;TPBTAPI.playerEvents_Func=GolWrapper.onMachineError;if(GolWrapper.isLocal){var terminalId=ServiceWrapper_1.ServiceWrapper.getUrlVars()["terminalId"];if(!terminalId){var urlVars=ServiceWrapper_1.ServiceWrapper.getUrlVars();if(typeof urlVars["terminalId"]!=="undefined"){terminalId=urlVars["terminalId"]}else{terminalId="test"+Utilities_1.Utilities.MakeId(8)}}GolWrapper.onInitConfig({GameLogID:terminalId,RegularCredits:1e3})}};GolWrapper.sendAjaxRequest=function(ticketId,balance,error){var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,ticketId:ticketId,balance:balance,errorCode:error};if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"GolTicketEnd",data:parameters,timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){GolWrapper.pendingEnd=false;TicketWrapper_1.TicketWrapper.trySendPendingSpin()},error:function(jqXHR,exception){if(jqXHR.status===0||jqXHR.status===500||exception==="timeout"){TicketWrapper_1.TicketWrapper.hasError=true;TicketWrapper_1.TicketWrapper.errorCode="FAILED_TO_UPDATE-"+ticketId;GolWrapper.pendingEnd=false;TicketWrapper_1.TicketWrapper.trySendPendingSpin()}}})};GolWrapper.adjustParams=function(){ServiceWrapper_1.ServiceWrapper.gameToken=GolWrapper.gameToken;ServiceWrapper_1.ServiceWrapper.paramJson.langCode="es_ES2"};GolWrapper.BetChecker=function(bet_info){if(!GolWrapper.isLocal){GolWrapper.pendingEnd=true}var ticketId=0;if(GolWrapper.ticketData!==null&&GolWrapper.ticketData.Result!==null&&GolWrapper.ticketData.Result.UniqueIdentifier!==0){ticketId=GolWrapper.ticketData.Result.UniqueIdentifier}ServiceWrapper_1.ServiceWrapper.LogMessage("API Received: Bet: "+bet_info.Bet+" Win: "+bet_info.Win+" Credits "+bet_info.Credits+" Status: "+bet_info.Status);var expectedBalance=MyGameState.creditosNormales-GolWrapper.dataToMachine.bet+GolWrapper.dataToMachine.win;ServiceWrapper_1.ServiceWrapper.LogMessage("Expected balance "+expectedBalance+" credits "+bet_info.Credits+" bet "+GolWrapper.dataToMachine.bet+" win "+GolWrapper.dataToMachine.win);if(bet_info.Status==="fail"){var dataError={PromoInfo:null,Result:null,ResultInfo:{Action:null,DisplayMessage:"TEMPORARY_ERROR",Message:null,Code:"TERMINAL_CASHIER_FAILED",Buttons:[]},FreeRoundsMarketing:null};dataError.ResultInfo=ServiceWrapper_1.ServiceWrapper.UpdateError(dataError.ResultInfo);Utilities_1.Utilities.SendC2Message("ProcessSlotMachine",[JSON.stringify(dataError)]);TicketWrapper_1.TicketWrapper.isPendingResponse=false;TicketWrapper_1.TicketWrapper.hasError=true;TicketWrapper_1.TicketWrapper.errorCode="TERMINAL_CASHIER_FAILED";if(ticketId!==0){GolWrapper.sendAjaxRequest(ticketId,MyGameState.creditosNormales,8500)}}else if(GolWrapper.dataToMachine.bet!==bet_info.Bet||GolWrapper.dataToMachine.win!==bet_info.Win||expectedBalance!==bet_info.Credits){var dataError={PromoInfo:null,Result:null,ResultInfo:{Action:null,DisplayMessage:"TEMPORARY_ERROR",Message:null,Code:"TERMINAL_CASHIER_ERROR",Buttons:[]},FreeRoundsMarketing:null};if(GolWrapper.dataToMachine.bet!==bet_info.Bet){dataError.ResultInfo.Code=dataError.ResultInfo.Code+"_BET"}if(GolWrapper.dataToMachine.win!==bet_info.Win){dataError.ResultInfo.Code=dataError.ResultInfo.Code+"_WIN"}if(expectedBalance!==bet_info.Credits){dataError.ResultInfo.Code=dataError.ResultInfo.Code+"_BALANCE"}dataError.ResultInfo=ServiceWrapper_1.ServiceWrapper.UpdateError(dataError.ResultInfo);Utilities_1.Utilities.SendC2Message("ProcessSlotMachine",[dataError]);TicketWrapper_1.TicketWrapper.isPendingResponse=false;TicketWrapper_1.TicketWrapper.hasError=true;TicketWrapper_1.TicketWrapper.errorCode="TERMINAL_CASHIER_FAILED";if(ticketId!==0){GolWrapper.sendAjaxRequest(ticketId,MyGameState.creditosNormales,8600)}}else{MyGameState.creditosNormales=bet_info.Credits;Utilities_1.Utilities.SendC2Message("ProcessSlotMachine",[GolWrapper.ticketData]);TicketWrapper_1.TicketWrapper.isPendingResponse=false;if(ticketId!==0){GolWrapper.sendAjaxRequest(ticketId,MyGameState.creditosNormales,0)}}};GolWrapper.OnProcessTicketReceived=function(i_Action,i_Result){GolWrapper.onSuccess=i_Action;GolWrapper.ticketData=i_Result;GolWrapper.notifyMachine(i_Result.Result.TotalBetPlaced,i_Result.Result.Win)};GolWrapper.notifyMachine=function(bet,win){GolWrapper.dataToMachine.bet=bet;GolWrapper.dataToMachine.win=win;if(!GolWrapper.isLocal){TPBTAPI.GameStart(bet,0);TPBTAPI.GameEnd(win,0,(new Date).toISOString(),false)}GolWrapper.BetChecker({Bet:bet,Win:win,Status:"success",Credits:MyGameState.creditosNormales-bet+win})};GolWrapper.openHistory=function(){if(ServiceWrapper_1.ServiceWrapper.historyUrl!==null){var isError_1=false;$("#spino-spinner").show();$("#history-iframe").on("error",function(){isError_1=true;$("#spino-spinner").hide();setTimeout(function(){$("#history-iframe-div").hide()},0)});$("#history-iframe").on("load",function(){$("#spino-spinner").hide();if(!isError_1){$("#history-iframe-div").show()}});$("#history-iframe").attr("src",decodeURIComponent(ServiceWrapper_1.ServiceWrapper.historyUrl))}};GolWrapper.updateBalance=function(){var balanceRes={Result:{CoinOut:MyGameState.creditosNormales},ResultInfo:{Code:0,DisplayMessage:null}};Utilities_1.Utilities.SendC2Message("ReadBalanceUpdate",[JSON.stringify(balanceRes)])};GolWrapper.onInitConfig=function(configData){MyGameState.creditosNormales=parseInt(configData["RegularCredits"]);GolWrapper.machineId=configData["GameLogID"];GolWrapper.launchGame()};GolWrapper.getBalance=function(){return MyGameState.creditosNormales};GolWrapper.onCreditAdded=function(details){MyGameState.creditosNormales=parseInt(details["TotalRegularCredits"]);ServiceWrapper_1.ServiceWrapper.requestBalance()};GolWrapper.onMachineError=function(){var dataError={PromoInfo:null,Result:null,ResultInfo:{Action:null,DisplayMessage:"TEMPORARY_ERROR",Message:null,Code:"MACHINE_ERROR",Buttons:[]},FreeRoundsMarketing:null};dataError.ResultInfo.Code=TicketWrapper_1.TicketWrapper.errorCode;dataError.ResultInfo=ServiceWrapper_1.ServiceWrapper.UpdateError(dataError.ResultInfo);TicketWrapper_1.TicketWrapper.hasError=true;if(TicketWrapper_1.TicketWrapper.isPendingResponse){Utilities_1.Utilities.SendC2Message("ReadTicket",[JSON.stringify(dataError)]);TicketWrapper_1.TicketWrapper.isPendingResponse=false}};GolWrapper.AddPossibleBets=function(i_HelpPageJson){var info=i_HelpPageJson.GameInfo;if(!info){ServiceWrapper_1.ServiceWrapper.LogError("[GolWrapper][AddPossibleBets] No GameInfo section in helppage");return}var entry=Object.entries(info).find(function(_a){var val=_a[1];return val.Title==="Montos De Entrada"});if(!entry){ServiceWrapper_1.ServiceWrapper.LogError("[GolWrapper][AddPossibleBets] 'Montos De Entrada' not found");return}var key=entry[0],value=entry[1];if(!key||!value||!StartTicketWrapper_1.StartTicketWrapper.startTicket||!StartTicketWrapper_1.StartTicketWrapper.startTicket.Result||!StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.BettingUnits){ServiceWrapper_1.ServiceWrapper.LogError("[GolWrapper][AddPossibleBets] Init ticket doesnt have betting units");return}value.Text=[StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.BettingUnits.slice(0).reverse().join(", ")];i_HelpPageJson.GameInfo[key]=value;return i_HelpPageJson};GolWrapper.dataToMachine={bet:null,win:null};GolWrapper.machineId=null;GolWrapper.launchUrl=null;GolWrapper.gameToken=null;GolWrapper.onSuccess=null;GolWrapper.ticketData=null;GolWrapper.isActive=false;GolWrapper.pendingEnd=false;return GolWrapper}();exports.GolWrapper=GolWrapper;window.GolWrapper=GolWrapper},{"../Utilities":22,"./ServiceWrapper":41,"./StartTicketWrapper":42,"./TicketWrapper":46}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ServiceWrapper_1=require("./ServiceWrapper");var LogMessageColor;(function(LogMessageColor){LogMessageColor["Client"]="blue";LogMessageColor["ServiceWrapper"]="black";LogMessageColor["EventWrapper"]="purple";LogMessageColor["EventWrapperBG"]="yellow";LogMessageColor["BSpotWrapper"]="#7F00FF";LogMessageColor["PromoTool"]="green";LogMessageColor["CommunicationWrapper"]="teal";LogMessageColor["CommunicationWrapperBG"]="grey";LogMessageColor["AutoPlayMenu"]="green";LogMessageColor["AutoPlayMenuBG"]="yellow"})(LogMessageColor=exports.LogMessageColor||(exports.LogMessageColor={}));var LogWrapper=function(){function LogWrapper(){}LogWrapper.LogMessage=function(){var i_Messages=[];for(var _i=0;_i<arguments.length;_i++){i_Messages[_i]=arguments[_i]}if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment||ServiceWrapper_1.ServiceWrapper.ShowDebugLogs){console.log("[ServiceWrapper] "+i_Messages)}};LogWrapper.LogMessageWithColor=function(i_Message,i_TextColorOption,i_BackgroundColorOption){if(i_TextColorOption===void 0){i_TextColorOption="black"}if(i_BackgroundColorOption===void 0){i_BackgroundColorOption="white"}if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment||ServiceWrapper_1.ServiceWrapper.ShowDebugLogs){console.log("%c [ServiceWrapper] "+i_Message,"background: "+i_BackgroundColorOption+"; color: "+i_TextColorOption)}};LogWrapper.LogError=function(i_Message){if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment||ServiceWrapper_1.ServiceWrapper.ShowDebugLogs){console.error("[ServiceWrapper] "+i_Message)}};LogWrapper.LogWarning=function(i_Message){if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment||ServiceWrapper_1.ServiceWrapper.ShowDebugLogs){console.warn("[ServiceWrapper] "+i_Message)}};return LogWrapper}();exports.LogWrapper=LogWrapper},{"./ServiceWrapper":41}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ServiceWrapper_1=require("./ServiceWrapper");var OldTicketGeneratorWrapper=function(){function OldTicketGeneratorWrapper(){}OldTicketGeneratorWrapper.readMessage=function(msg){if(msg==="close"){this.iframeWrapper.hide()}else if(msg.message==="ticket"){this.ticketsList.push(msg.payload)}else if(msg.message==="sequence"){}};OldTicketGeneratorWrapper.getTicket=function(){if(this.ticketsList.length===0){return null}var ticket=this.ticketsList[0];this.ticketsList.pop();return ticket};OldTicketGeneratorWrapper.Activate=function(){var _this=this;var tempEl=$.parseHTML('<div class="modal is-visible" id="iframe-wrapper"><div class="modal-overlay modal-toggle"></div><div class="modal-wrapper modal-transition"><iframe id="iframe-ng" style="width: 100vw; height: 100vh;" src="'+ServiceWrapper_1.ServiceWrapper.ExternalComponentPath+"scripts/ticket_generator/ticket-gen-cert.html?gameCode="+ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode+'"'+'frameborder="1"></iframe></div></div>');document.body.insertBefore(tempEl[0],document.body.firstChild);this.isActive=true;this.iframeWrapper=$("#iframe-wrapper");this.iframeWrapper.hide();$(document).keypress(function(event){ServiceWrapper_1.ServiceWrapper.LogMessage("key pressed "+event.keyCode);if(event.keyCode===54){_this.iframeWrapper.toggle()}});window.addEventListener("message",function(e){ServiceWrapper_1.ServiceWrapper.LogMessage("message came in",JSON.stringify(e));if(e.isTrusted){var data=e.data;_this.readMessage(data)}},false)};OldTicketGeneratorWrapper.ticketsList=[];OldTicketGeneratorWrapper.isActive=false;return OldTicketGeneratorWrapper}();exports.OldTicketGeneratorWrapper=OldTicketGeneratorWrapper;window.DebugWrapper=OldTicketGeneratorWrapper},{"./ServiceWrapper":41}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var Utilities_1=require("../Utilities");var ErrorWrapper_1=require("./ErrorWrapper");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var PromoWrapper=function(){function PromoWrapper(){}PromoWrapper.request=function(ticketId,PrizeId,Promotion,onSuccess){PromoWrapper.sendAjaxRequest(ticketId,PrizeId,Promotion,onSuccess)};PromoWrapper.sendAjaxRequest=function(ticketId,PrizeId,Promotion,onSuccess){var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,ticketId:ticketId,PrizeId:PrizeId,Promotion:Promotion};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+"Promotion",data:parameters,timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){if(result!=null&&result.ResultInfo!=null&&result.ResultInfo.Code>0){result.ResultInfo=ErrorWrapper_1.ErrorWrapper.UpdateError(result.ResultInfo);result.ResultInfo.Buttons=[];result.ResultInfo.Buttons.push({Text:ExternalComponents_1.ExternalComponents.Languages.Buttons.BTN_Reload,Interaction:1,Action:"Reload"})}Utilities_1.Utilities.SendC2Message(onSuccess,result)},error:function(jqXHR,exception){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,onSuccess)}})};Object.defineProperty(PromoWrapper,"IsCollectPromoRequest",{get:function(){return StartTicketWrapper_1.StartTicketWrapper.startTicket!==undefined&&StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.ResultInfo.Code===0&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.Promotion!=null&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.Promotion.PrizeId!=null},enumerable:true,configurable:true});return PromoWrapper}();exports.PromoWrapper=PromoWrapper},{"../ExternalComponents/ExternalComponents":8,"../Utilities":22,"./ErrorWrapper":30,"./ServiceWrapper":41,"./StartTicketWrapper":42}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Definitions_1=require("../Definitions");var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var Utilities_1=require("../Utilities");var StartTicketWrapper_1=require("./StartTicketWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var ReSpinWrapper=function(){function ReSpinWrapper(){}Object.defineProperty(ReSpinWrapper,"isGameSupportingRespins",{get:function(){if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result){return ReSpinWrapper.gameIdsSupportingRespins.indexOf(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId)!==-1}return false},enumerable:true,configurable:true});Object.defineProperty(ReSpinWrapper,"isGameSupportingArcticRespins",{get:function(){if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result){return ReSpinWrapper.gameIdsSupportingArcticRespins.indexOf(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId)!==-1}return false},enumerable:true,configurable:true});ReSpinWrapper.simulateSpins=function(data){if(ReSpinWrapper.IsEnteringReSpin(ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,data)){ReSpinWrapper.EnterReSpin(data);ReSpinWrapper.simulateNextSpin(data)}};ReSpinWrapper.clone=function(obj){return JSON.parse(JSON.stringify(obj))};ReSpinWrapper.simulateNextSpin=function(data){setTimeout(function(){var result=ReSpinWrapper.AdjustRespinSpots();ServiceWrapper_1.ServiceWrapper.logMessage(JSON.stringify(result));ReSpinWrapper.reSpinIndex++;if(ReSpinWrapper.isInsideRespin()){ReSpinWrapper.simulateNextSpin()}},1e3)};ReSpinWrapper.IsEnteringReSpin=function(gameCode,data){return data!=null&&data.ResultInfo!=null&&data.ResultInfo.Code===0&&data.Result.ReSpins!=null&&ReSpinWrapper.isGameSupportingRespins};ReSpinWrapper.EnterReSpin=function(data){ReSpinWrapper.originalTicket=JSON.parse(JSON.stringify(data));ReSpinWrapper.originalPayLines=[];ReSpinWrapper.originalPayLines=data.Result.PayLines;ReSpinWrapper.reSpinIndex=0;ReSpinWrapper.reSpinCount=data.Result.ReSpins.length;ReSpinWrapper.coinOut=data.Result.CoinOut;ReSpinWrapper.coinIn=data.Result.CoinIn;var split=(data.Result.FreeTickets.BetLine+"").split(".");if(split.length>1){ReSpinWrapper.decimalPoints=split[1].length}else{ReSpinWrapper.decimalPoints=2}ReSpinWrapper.freeSpinTotalWin=Utilities_1.Utilities.FixFloatingPointError(data.Result.FreeTickets.Win-data.Result.Win,ReSpinWrapper.decimalPoints)};ReSpinWrapper.AdjustRespinSpots=function(){ReSpinWrapper.freeSpinTotalWinReal=-1;var data=JSON.parse(JSON.stringify(ReSpinWrapper.originalTicket));var reSpins=data.Result.ReSpins;var reSpinResult=[];var lastTotalWin=0;var slotLength=data.Result.Slot.length;var isLastRespin=false;var WinningSymbols=[];if(ReSpinWrapper.reSpinIndex>=ReSpinWrapper.reSpinCount){isLastRespin=true;if(ReSpinWrapper.originalTicket.Result.Hits.length!==ReSpinWrapper.originalTicket.Result.Slot.length){reSpinResult=ReSpinWrapper.lastReSpinSpots;lastTotalWin=ReSpinWrapper.winSoFar;if(ReSpinWrapper.originalTicket.Result.LastRespin){lastTotalWin=ReSpinWrapper.originalTicket.Result.LastRespin.WinFrom}data.Result.WinBeforeMultiply=0;data.Result.Win=0}else{data.Result.WinBeforeMultiply=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.originalTicket.Result.Win-ReSpinWrapper.winSoFar,ReSpinWrapper.decimalPoints);data.Result.Win=Utilities_1.Utilities.FixFloatingPointError(data.Result.WinBeforeMultiply,ReSpinWrapper.decimalPoints);lastTotalWin=ReSpinWrapper.originalTicket.Result.Win;reSpinResult=data.Result.Hits;ReSpinWrapper.freeSpinTotalWin=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.freeSpinTotalWin+data.Result.Win,ReSpinWrapper.decimalPoints)}if(ReSpinWrapper.isGameSupportingArcticRespins){data.Result.PayLines=ReSpinWrapper.originalPayLines;data.Result.Hits=ReSpinWrapper.originalTicket.Result.Hits;data.Result.MiniGame=ReSpinWrapper.originalTicket.Result.MiniGame;data.Result.JackpotBefore=ReSpinWrapper.originalTicket.Result.JackpotBefore;data.Result.JackpotAfter=ReSpinWrapper.originalTicket.Result.JackpotAfter;data.Result.IsFullSlotFrozen=ReSpinWrapper.originalTicket.Result.IsFullSlotFrozen;if(data.Result.JackpotBefore>0&&data.Result.JackpotAfter===0){lastTotalWin-=data.Result.JackpotBefore}}data.Result.FreeTickets.To=ReSpinWrapper.originalTicket.Result.FreeTickets.To;data.Result.LastRespin=ReSpinWrapper.originalTicket.Result.LastRespin;if(ReSpinWrapper.originalTicket.Result.LastRespin&&ReSpinWrapper.originalTicket.Result.LastRespin.ScatterWins){ReSpinWrapper.originalTicket.Result.LastRespin.ScatterWins.forEach(function(symbol){WinningSymbols.push({number:symbol.Icon,amount:symbol.Times,winAmount:symbol.WinAmount,multiplier:symbol.Multiplier})})}if(ReSpinWrapper.isGameSupportingArcticRespins){data.Result.CoinIn=ReSpinWrapper.originalTicket.Result.CoinIn;data.Result.CoinOut=ReSpinWrapper.originalTicket.Result.CoinOut}if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.SendOnTicketReceived(data.PromoInfo)}}else{data.Result.FreeTickets.To=data.Result.FreeTickets.From;var respinsSpots=[];var currentRespin=reSpins[ReSpinWrapper.reSpinIndex];lastTotalWin=Utilities_1.Utilities.FixFloatingPointError(currentRespin.WinFrom,ReSpinWrapper.decimalPoints);data.Result.WinBeforeMultiply=Utilities_1.Utilities.FixFloatingPointError(lastTotalWin-ReSpinWrapper.winSoFar,ReSpinWrapper.decimalPoints);data.Result.Win=data.Result.WinBeforeMultiply;data.Result.MiniGame=null;data.Result.JackpotBefore=ReSpinWrapper.originalTicket.Result.JackpotBefore;if(ReSpinWrapper.originalTicket.Result.JackpotAfter===0&&data.Result.JackpotBefore>0){data.Result.JackpotAfter=data.Result.JackpotBefore}else{data.Result.JackpotAfter=ReSpinWrapper.originalTicket.Result.JackpotAfter}data.Result.IsFullSlotFrozen=null;ReSpinWrapper.freeSpinTotalWin=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.freeSpinTotalWin+data.Result.Win,ReSpinWrapper.decimalPoints);for(var temp=0;temp<1;temp++){for(var i=0;i<currentRespin.Spots.length;i++){respinsSpots.push(currentRespin.Spots[i].Place)}}for(var temp=0;temp<1;temp++){for(var x=0;x<slotLength;x++){if(respinsSpots.indexOf(x)===-1){reSpinResult.push(x)}}}if(ReSpinWrapper.isGameSupportingArcticRespins){data.Result.CoinIn=ReSpinWrapper.originalTicket.Result.CoinIn;data.Result.CoinOut=ReSpinWrapper.originalTicket.Result.CoinIn;ReSpinWrapper.freeSpinTotalWinReal=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.freeSpinTotalWin,ReSpinWrapper.decimalPoints);ReSpinWrapper.freeSpinTotalWin=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.freeSpinTotalWin-data.Result.Win,ReSpinWrapper.decimalPoints);data.Result.WinBeforeMultiply=0;data.Result.Win=0}}data.Result.FreeTickets.Win=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.freeSpinTotalWin,ReSpinWrapper.decimalPoints);if(ReSpinWrapper.freeSpinTotalWinReal!==-1){ReSpinWrapper.freeSpinTotalWin=ReSpinWrapper.freeSpinTotalWinReal}if(ReSpinWrapper.reSpinIndex>0){var preReSpin=data.Result.ReSpins[ReSpinWrapper.reSpinIndex-1];data.Result.Slot=[];var _loop_1=function(x){if(ReSpinWrapper.lastReSpinSpots.indexOf(x)!==-1){data.Result.Slot.push(ReSpinWrapper.lastSlot[x])}else{var value=preReSpin.Spots.filter(function(spot){return spot.Place===x});if(value[0]){data.Result.Slot.push(value[0].To)}}};for(var x=0;x<slotLength;x++){_loop_1(x)}}data.Result.ReSpinSpots=reSpinResult;data.Result.Hits=reSpinResult;var lines=ReSpinWrapper.originalPayLines;var newLines=[];for(var temp=0;temp<1;temp++){for(var lineIndex=0;lineIndex<lines.length;lineIndex++){var newLine=JSON.parse(JSON.stringify(lines[lineIndex]));newLine.Hits=[];for(var hitIndex=0;hitIndex<lines[lineIndex].VisiblePlaces.length;hitIndex++){if(data.Result.Hits.indexOf(lines[lineIndex].VisiblePlaces[hitIndex])!==-1){newLine.Hits.push(lines[lineIndex].VisiblePlaces[hitIndex])}else{if(newLine.Hits.length<3&&newLine.Hits.length>0){ServiceWrapper_1.ServiceWrapper.logMessage("break possible line "+lines[lineIndex].Number);ServiceWrapper_1.ServiceWrapper.logMessage(JSON.stringify(lines[lineIndex]))}break}}if(newLine.Hits.length>=3){if(newLine.Hits.indexOf(newLine.VisiblePlaces[0])!==-1){newLines.push(newLine)}else{ServiceWrapper_1.ServiceWrapper.logMessage("Avoid adding lines even though 3 hits because not start from left");ServiceWrapper_1.ServiceWrapper.logMessage(JSON.stringify(newLine))}}}}var newSpots=[];for(var i=0;i<reSpinResult.length;i++){if(ReSpinWrapper.lastReSpinSpots.indexOf(reSpinResult[i])===-1){newSpots.push(reSpinResult[i])}}if(ReSpinWrapper.originalTicket.Result.ReSpins[ReSpinWrapper.reSpinIndex]&&ReSpinWrapper.originalTicket.Result.ReSpins[ReSpinWrapper.reSpinIndex].ScatterWins){ReSpinWrapper.originalTicket.Result.ReSpins[ReSpinWrapper.reSpinIndex].ScatterWins.forEach(function(win){WinningSymbols.push({number:win.Icon,amount:win.Times,winAmount:win.WinAmount,multiplier:win.Multiplier})})}data.Result.ReSpinInfo={Spots:reSpinResult,NewSpots:newSpots,Index:ReSpinWrapper.reSpinIndex,ReSpinsCount:ReSpinWrapper.reSpinCount,TotalWinSoFar:Utilities_1.Utilities.FixFloatingPointError(lastTotalWin,ReSpinWrapper.decimalPoints),CurrentWin:Utilities_1.Utilities.FixFloatingPointError(lastTotalWin-ReSpinWrapper.winSoFar,ReSpinWrapper.decimalPoints),WinningSymbols:WinningSymbols};if(!isLastRespin||!ReSpinWrapper.isGameSupportingArcticRespins){if(data.Result.Win===0){newLines=[];data.Result.Hits=[]}if(newLines){data.Result.PayLines=newLines}else{data.Result.PayLines=[]}}if(!ReSpinWrapper.isGameSupportingArcticRespins){data.Result.CoinIn=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.coinIn,ReSpinWrapper.decimalPoints);data.Result.CoinOut=Utilities_1.Utilities.FixFloatingPointError(ReSpinWrapper.coinIn+data.Result.Win,ReSpinWrapper.decimalPoints);ReSpinWrapper.coinIn=Utilities_1.Utilities.FixFloatingPointError(data.Result.CoinOut,ReSpinWrapper.decimalPoints)}ReSpinWrapper.lastSlot=data.Result.Slot;ReSpinWrapper.lastReSpinSpots=data.Result.ReSpinSpots;ReSpinWrapper.winSoFar=Utilities_1.Utilities.FixFloatingPointError(lastTotalWin,ReSpinWrapper.decimalPoints);return data};ReSpinWrapper.ShowNextRespin=function(onSuccess){var modifiedTicketForRespin=ReSpinWrapper.AdjustRespinSpots();ReSpinWrapper.reSpinIndex++;Utilities_1.Utilities.SendC2Message(onSuccess,modifiedTicketForRespin)};ReSpinWrapper.isInsideRespin=function(){if(ReSpinWrapper.reSpinCount===0||ReSpinWrapper.reSpinIndex>ReSpinWrapper.reSpinCount){ReSpinWrapper.originalTicket=null;ReSpinWrapper.reSpinIndex=0;ReSpinWrapper.reSpinCount=0;ReSpinWrapper.lastSlot=[];ReSpinWrapper.lastReSpinSpots=[];ReSpinWrapper.originalPayLines=[];ReSpinWrapper.winSoFar=0;ReSpinWrapper.freeSpinTotalWin=0;return false}return true};ReSpinWrapper.reSpinIndex=0;ReSpinWrapper.reSpinCount=0;ReSpinWrapper.originalTicket=null;ReSpinWrapper.currentTicket=null;ReSpinWrapper.lastSlot=[];ReSpinWrapper.winSoFar=0;ReSpinWrapper.freeSpinTotalWin=0;ReSpinWrapper.freeSpinTotalWinReal=0;ReSpinWrapper.isBSpot=false;ReSpinWrapper.coinOut=0;ReSpinWrapper.coinIn=0;ReSpinWrapper.decimalPoints=2;ReSpinWrapper.lastReSpinSpots=[];ReSpinWrapper.originalPayLines=[];ReSpinWrapper.gameIdsSupportingRespins=[Definitions_1.ClassId.SlotMachine_ArcticAdventures,Definitions_1.ClassId.SlotMachine_DemiGods3,Definitions_1.ClassId.SlotMachine_CupidsStrike,Definitions_1.ClassId.SlotMachine_FruitsDeluxe,Definitions_1.ClassId.SlotMachine_Spinoween,Definitions_1.ClassId.SlotMachine_NovaGems,Definitions_1.ClassId.SlotMachine_DemiGods3_15E,Definitions_1.ClassId.SlotMachine_FruitsDeluxe_FWE,Definitions_1.ClassId.SlotMachine_PoseidonsRising,Definitions_1.ClassId.SlotMachine_EgyptianEclipse,Definitions_1.ClassId.SlotMachine_PoseidonsRising_15E,Definitions_1.ClassId.SlotMachine_PoseidonsRising_EE];ReSpinWrapper.gameIdsSupportingArcticRespins=[Definitions_1.ClassId.SlotMachine_ArcticAdventures,Definitions_1.ClassId.SlotMachine_EgyptianEclipse];return ReSpinWrapper}();exports.ReSpinWrapper=ReSpinWrapper},{"../Definitions":5,"../ExternalComponents/ExternalComponents":8,"../Utilities":22,"./ServiceWrapper":41,"./StartTicketWrapper":42}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var DataManager_1=require("../DataManager");var Logger_1=require("../Logger");var Utilities_1=require("../Utilities");var BalanceWrapper_1=require("./BalanceWrapper");var BetSlipWrapper_1=require("../ExternalComponents/Wrappers/BetSlipWrapper");var BonusWrapper_1=require("./BonusWrapper");var BuyFeatureWrapper_1=require("./BuyFeatureWrapper");var CurrencyWrapper_1=require("./CurrencyWrapper");var ErrorWrapper_1=require("./ErrorWrapper");var GameEvents_1=require("../GameEvents");var FreeSpinsPickerWrapper_1=require("./FreeSpinsPickerWrapper");var GambleWrapper_1=require("./GambleWrapper");var GolWrapper_1=require("./GolWrapper");var HelpPageWrapper_1=require("../ExternalComponents/Wrappers/HelpPageWrapper");var StartTicketWrapper_1=require("./StartTicketWrapper");var LogWrapper_1=require("./LogWrapper");var PaytableWrapper_1=require("../ExternalComponents/Wrappers/PaytableWrapper");var PromoScreenWrapper_1=require("../ExternalComponents/Wrappers/PromoScreenWrapper");var PromoToolWrapper_1=require("../ExternalComponents/Wrappers/PromoToolWrapper");var PromoWrapper_1=require("./PromoWrapper");var RespinWrapper_1=require("./RespinWrapper");var TerminalWrapper_1=require("./TerminalWrapper");var TicketEndWrapper_1=require("./TicketEndWrapper");var TicketWrapper_1=require("./TicketWrapper");var MegaFlashScreenWrapper_1=require("../ExternalComponents/Wrappers/MegaFlashScreenWrapper");var TicketGeneratorWrapper_1=require("../ExternalComponents/Wrappers/TicketGeneratorWrapper");var Events_1=require("../Events");var TickerWrapper_1=require("./TickerWrapper");var AutoBetMenuWrapper_1=require("../ExternalComponents/Wrappers/AutoBetMenuWrapper");var FreeRoundsScreenWrapper_1=require("../ExternalComponents/Wrappers/FreeRoundsScreenWrapper");var WinnersRoundScreenWrapper_1=require("../ExternalComponents/Wrappers/WinnersRoundScreenWrapper");var Versions_1=require("../Versions");var ServiceWrapper=function(){function ServiceWrapper(){}Object.defineProperty(ServiceWrapper,"Communications",{get:function(){return ServiceWrapper.m_Communications},set:function(i_Com){if(!ServiceWrapper.m_Communications){ServiceWrapper.m_Communications=i_Com}},enumerable:true,configurable:true});ServiceWrapper.SetErrorScreenExists=function(){ServiceWrapper.IsExternalErrorScreenExists=true};ServiceWrapper.ErrorScreenReleaseGame=function(){this.m_IsInError=false;Utilities_1.Utilities.SendC2Message("ErrorScreenWindowClosed","")};ServiceWrapper.ErrorScreenBlockGame=function(){this.m_IsInError=true;ServiceWrapper.ErrorScreenShowing();if(ServiceWrapper.m_IsGameLoaded){Utilities_1.Utilities.SendC2Message("ErrorScreenWindowOpened","")}};ServiceWrapper.OpenLastWindowScreen=function(){if(this.m_IsInError){return}if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.LastTicketInfo){window.dispatchEvent(new CustomEvent("error-screen-show-last-ticket",{detail:StartTicketWrapper_1.StartTicketWrapper.startTicket.ResultInfo}))}else{Utilities_1.Utilities.SendC2Message("ErrorScreenWindowClosed","")}};ServiceWrapper.OpenAutoBetMenu=function(){if(ExternalComponents_1.ExternalComponents.AutoPlayMenu){ExternalComponents_1.ExternalComponents.AutoPlayMenu.Show()}};Object.defineProperty(ServiceWrapper,"AutoPlayMenuExists",{get:function(){return!!ExternalComponents_1.ExternalComponents.AutoPlayMenu},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"AutoSpinsLeft",{get:function(){if(ExternalComponents_1.ExternalComponents.AutoPlayMenu){return ExternalComponents_1.ExternalComponents.AutoPlayMenu.SpinsLeft}return 0},enumerable:true,configurable:true});ServiceWrapper.StopAutoPlay=function(){if(ExternalComponents_1.ExternalComponents.AutoPlayMenu){ExternalComponents_1.ExternalComponents.AutoPlayMenu.AutoBetInfo=null}};Object.defineProperty(ServiceWrapper,"IsOnAutoPlay",{get:function(){return ExternalComponents_1.ExternalComponents.AutoPlayMenu&&ExternalComponents_1.ExternalComponents.AutoPlayMenu.IsOnAutoBet},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"IsAutoSkipSelections",{get:function(){return ExternalComponents_1.ExternalComponents.AutoPlayMenu&&ExternalComponents_1.ExternalComponents.AutoPlayMenu.IsSkipSelections},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"IsAutoTurbo",{get:function(){return ExternalComponents_1.ExternalComponents.AutoPlayMenu&&ExternalComponents_1.ExternalComponents.AutoPlayMenu.IsTurbo},enumerable:true,configurable:true});ServiceWrapper.SetAutoTurboDefault=function(i_Turbo){};Object.defineProperty(ServiceWrapper,"PromoToolExists",{get:function(){return!!ExternalComponents_1.ExternalComponents.PromoTool},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"IsPromoToolSupported",{get:function(){return ExternalComponents_1.ExternalComponents.PromoTool&&ExternalComponents_1.ExternalComponents.PromoTool.IsPromoToolSupported},enumerable:true,configurable:true});ServiceWrapper.SetPromoToolSupported=function(i_Val){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.IsPromoToolSupported=i_Val}};ServiceWrapper.gameNotifyStarted=function(){ServiceWrapper.LoadingFinished();if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.Init()}if(ExternalComponents_1.ExternalComponents.TicketGenerator){ExternalComponents_1.ExternalComponents.TicketGenerator.AllowShowBtn()}};ServiceWrapper.PromoToolAllowShowInitPopup=function(){this.AfterMainSplashClosed()};ServiceWrapper.PromoToolAllowShowTopBar=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.ShowTopBar()}};ServiceWrapper.AfterMainSplashClosed=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.ShowInitPopup()}if(ExternalComponents_1.ExternalComponents.FreeRounds){ExternalComponents_1.ExternalComponents.FreeRounds.AllowShowTopBar();ExternalComponents_1.ExternalComponents.FreeRounds.AllowShowWindow()}};ServiceWrapper.PromoToolDisableCountDown=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.DisableCountDown()}};ServiceWrapper.PromoToolEnableCountDown=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.EnableCountDown()}};ServiceWrapper.updateBetAmount=function(i_NewBetAmount){if(i_NewBetAmount){ServiceWrapper.BetUpdated(i_NewBetAmount)}else if(ServiceWrapper.Info&&ServiceWrapper.Info.GameInfo&&ServiceWrapper.Info.GameInfo.Bet){ServiceWrapper.BetUpdated(ServiceWrapper.Info.GameInfo.Bet)}};ServiceWrapper.blockPromoTool=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.Block()}};ServiceWrapper.releasePromoTool=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.Release()}};ServiceWrapper.hidePromoTool=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.Hide()}};ServiceWrapper.showPromoTool=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.Show()}};ServiceWrapper.UpdatePromoToolAfterSpin=function(){if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.OnTicketEnd()}};Object.defineProperty(ServiceWrapper,"HelpPageExists",{get:function(){return!!ExternalComponents_1.ExternalComponents.HelpPage},set:function(i_Exists){},enumerable:true,configurable:true});ServiceWrapper.OpenHelpPage=function(){if(ServiceWrapper.HelpPageExists){ExternalComponents_1.ExternalComponents.HelpPage.Show()}};Object.defineProperty(ServiceWrapper,"Info",{get:function(){return ServiceWrapper.i_Info},set:function(i_Info){ServiceWrapper.i_Info=i_Info;Versions_1.Version.Init();var _loop_1=function(key,value){if(!!value&&value!==""){Object.defineProperty(ServiceWrapper,key,{set:function(i_EventListenerClass){if(!ExternalComponents_1.ExternalComponents[key]){new ServiceWrapper.wrapperClasses[key+"Wrapper"](i_EventListenerClass)}}})}};for(var _i=0,_a=Object.entries(ServiceWrapper.Info.EnvironmentInfo.ExternalComponents);_i<_a.length;_i++){var _b=_a[_i],key=_b[0],value=_b[1];_loop_1(key,value)}ExternalComponents_1.ExternalComponents.Languages=ServiceWrapper.i_Info.Translations.Text;ServiceWrapper.eOnExternalComponentsLoaded.Once(function(){var _a;StartTicketWrapper_1.StartTicketWrapper.startTicket=(_a=ServiceWrapper.Info.StartTicket,_a!==null&&_a!==void 0?_a:null)});ServiceWrapper.baseUrl=ServiceWrapper.Info.Urls.RgsUrl;if(!ServiceWrapper.baseUrl){ServiceWrapper.baseUrl=ServiceWrapper.Info.Urls.ServiceUrl}ServiceWrapper.cashierUrl=ServiceWrapper.Info.Urls.CashierUrl;if(ServiceWrapper.IsGameCertified){ServiceWrapper.LogMessageWithColor("==================================================================================","#bada55",LogWrapper_1.LogMessageColor.ServiceWrapper);ServiceWrapper.LogMessageWithColor("This Game Is Certified - If it shouldn't be, Remove CertifiedGame from your game class.","#bada55",LogWrapper_1.LogMessageColor.ServiceWrapper);ServiceWrapper.LogMessageWithColor("Otherwise, ignore this message.","#bada55",LogWrapper_1.LogMessageColor.ServiceWrapper);ServiceWrapper.LogMessageWithColor("==================================================================================","#bada55",LogWrapper_1.LogMessageColor.ServiceWrapper)}},enumerable:true,configurable:true});ServiceWrapper.LoadDataToVariables=function(){DataManager_1.DataManager.init()};ServiceWrapper.SetGameCertified=function(i_Bool){};Object.defineProperty(ServiceWrapper,"PerGameConfig",{get:function(){return ServiceWrapper.Info.GameInfo},enumerable:true,configurable:true});ServiceWrapper.ForceErrorTicket=function(i_ErrorType){if(ServiceWrapper.IsDebugEnvironment){TicketWrapper_1.TicketWrapper.ForceNextTicketError=true;if(i_ErrorType){TicketWrapper_1.TicketWrapper.ErrorType=i_ErrorType}else{ServiceWrapper.LogErrorMessages(TicketWrapper_1.TicketWrapper.ErrorType)}}};ServiceWrapper.ForceStartErrorTicket=function(i_ErrorType){if(ServiceWrapper.IsDebugEnvironment){StartTicketWrapper_1.StartTicketWrapper.ForceStartTicketError=true;if(i_ErrorType){StartTicketWrapper_1.StartTicketWrapper.ErrorType=i_ErrorType}else{ServiceWrapper.LogErrorMessages(StartTicketWrapper_1.StartTicketWrapper.ErrorType)}}};ServiceWrapper.LogErrorMessages=function(i_CurrentError){ServiceWrapper.LogError("Current Error type is:"+i_CurrentError);ServiceWrapper.LogError("You can also force these Errors:"+Object.values(ErrorWrapper_1.IErrorDisplayMessages))};ServiceWrapper.getParamJson=function(callback){Utilities_1.Utilities.SendC2Message(callback,ServiceWrapper.paramJson)};ServiceWrapper.sendData=function(action,parameters,onSuccess){switch(onSuccess){case"ReadInitData":case"_ReadInitData":StartTicketWrapper_1.StartTicketWrapper.requestInitFromGame(onSuccess);return;case"ReadTicket":case"_ReadTicket":TicketWrapper_1.TicketWrapper.sendData(parameters,onSuccess);return}switch(action){case"SaveGame":BonusWrapper_1.BonusWrapper.saveGame(parameters);break;case"BonusEnd":BonusWrapper_1.BonusWrapper.endGame(parameters);break;case"Promotion":var promoParam=JSON.parse(parameters);PromoWrapper_1.PromoWrapper.request(promoParam.TicketId,promoParam.PrizeId,promoParam.PromoCode,onSuccess);break;case"BalanceInfo":BalanceWrapper_1.BalanceWrapper.requestBalance();break;case"Gamble":var gambleParam=JSON.parse(parameters);GambleWrapper_1.GambleWrapper.request(gambleParam.TicketId,gambleParam.IsGamble,onSuccess);break;case"BuyFeature":var buyFeatureParam=JSON.parse(parameters);BuyFeatureWrapper_1.BuyFeatureWrapper.request(buyFeatureParam.Bet,buyFeatureParam.FreeSpinType,buyFeatureParam.FreeSpinAmount,buyFeatureParam.Lines,buyFeatureParam.buyFeatureType,onSuccess);break;case"PickFreeSpins":var fsParam=JSON.parse(parameters);if(typeof fsParam.action==="undefined"){fsParam.action=null}FreeSpinsPickerWrapper_1.FreeSpinsPickerWrapper.request(fsParam.TicketId,fsParam.FreeSpinType,fsParam.action,onSuccess);break}};ServiceWrapper.requestBalance=function(){BalanceWrapper_1.BalanceWrapper.requestBalance()};ServiceWrapper.onImgFailed=function(img){$("#c2canvasdiv").remove();$("body").append("<h1>Failed to load game </h1> <p> please contact support, error: INVALID_IMG - "+img+"</p>");ServiceWrapper.LogMessage("failed to load image"+img)};ServiceWrapper.backToLobby=function(){ServiceWrapper.RunMessageCode("Exit")};ServiceWrapper.forceRefresh=function(){ServiceWrapper.moveToPage(window.location.href)};ServiceWrapper.moveToPage=function(url,reason){if(reason===void 0){reason=null}if(url.replace("/","")==="postMessage"){if(url===ServiceWrapper.homeUrl){GameEvents_1.GameEvents.LinkRedirect("home",reason)}else if(url===ServiceWrapper.cashierUrl){GameEvents_1.GameEvents.LinkRedirect("cashier",reason)}return}GameEvents_1.GameEvents.OnMoveLink();window.location.href=url};ServiceWrapper.isFullScreenSupported=function(){return ExternalComponents_1.ExternalComponents.FullScreen.IsFullScreenSupported};ServiceWrapper.setFullScreen=function(on){if(on===1){ExternalComponents_1.ExternalComponents.FullScreen.EnterFullScreen()}else{ExternalComponents_1.ExternalComponents.FullScreen.ExitFullScreen()}};ServiceWrapper.getFullScreen=function(){return ExternalComponents_1.ExternalComponents.FullScreen.IsInFullScreen?1:0};Object.defineProperty(ServiceWrapper,"IsBspot",{get:function(){return typeof BSpotWrapper!=="undefined"&&BSpotWrapper},enumerable:true,configurable:true});ServiceWrapper.interactWithError=function(action){if(action===ErrorWrapper_1.IErrorButtonActions.CashierUrl||action===ErrorWrapper_1.IErrorButtonActions.PlayForRealUrl){ServiceWrapper.launchLink(action,"InsufficientFunds")}else if(action===ErrorWrapper_1.IErrorButtonActions.Reload){if(!ServiceWrapper.isNullOrEmpty(ServiceWrapper.CrossLaunchUrl)){ServiceWrapper.moveToPage(ServiceWrapper.CrossLaunchUrl,"error")}else{if(ServiceWrapper.IsBspot){ServiceWrapper.moveToPage(BSpotWrapper.reloadUrl,"error")}else{ServiceWrapper.moveToPage(window.location.href,"error")}}}else if(action===ErrorWrapper_1.IErrorButtonActions.Terminate){if(ServiceWrapper.homeUrl){ServiceWrapper.moveToPage(ServiceWrapper.homeUrl,"error")}else if(!ServiceWrapper.isNullOrEmpty(ServiceWrapper.CrossLaunchUrl)){ServiceWrapper.moveToPage(ServiceWrapper.CrossLaunchUrl,"error")}else{ServiceWrapper.moveToPage(window.location.href,"error")}}else if(action===ErrorWrapper_1.IErrorButtonActions.ViewLastTicket){ServiceWrapper.launchLink(action)}else if(ServiceWrapper.WaitingLastTicketEnd&&action===ErrorWrapper_1.IErrorButtonActions.Close){ServiceWrapper.WaitingLastTicketEnd=false;TicketEndWrapper_1.TicketEndWrapper.sendAjaxRequest(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.LastTicketInfo.OpenTicketId);Utilities_1.Utilities.SendC2Message("ErrorScreenWindowClosed",[])}else if(action==="TicketEnd"&&ServiceWrapper.IsBspot){BSpotWrapper.ticketEnd()}};ServiceWrapper.RunMessageCode=function(messageCode){var actions={Exit:function(){if(ServiceWrapper.homeUrl){ServiceWrapper.moveToPage(ServiceWrapper.homeUrl,"button")}else{ServiceWrapper.moveToPage(window.location.href,"button")}},Open_Cashier:function(){if(ServiceWrapper.cashierUrl&&ServiceWrapper.cashierUrl!=null){ServiceWrapper.launchLink(ServiceWrapper.cashierUrl)}}};if(actions[messageCode]){actions[messageCode]()}};Object.defineProperty(ServiceWrapper,"isInIframe",{get:function(){try{return window.self!==window.top}catch(e){return true}},enumerable:true,configurable:true});ServiceWrapper.isOnReplay=function(onSuccess){if(isReplay===false){Utilities_1.Utilities.SendC2Message(onSuccess,"0")}else{isReplay===false;Utilities_1.Utilities.SendC2Message(onSuccess,"1")}};Object.defineProperty(ServiceWrapper,"isLinksOpenInNewTab",{get:function(){return ServiceWrapper.isInIframe},enumerable:true,configurable:true});ServiceWrapper.openInNewTab=function(onSuccess){if(ServiceWrapper.isLinksOpenInNewTab===false){Utilities_1.Utilities.SendC2Message(onSuccess,"0")}else{Utilities_1.Utilities.SendC2Message(onSuccess,"1")}};ServiceWrapper.openLobbyGameNewTab=function(onSuccess){if(openGameFromLobbyNewTab===false){Utilities_1.Utilities.SendC2Message(onSuccess,"0")}else{Utilities_1.Utilities.SendC2Message(onSuccess,"1")}};ServiceWrapper.getSmallLogoUrl=function(onSuccess){Utilities_1.Utilities.SendC2Message(onSuccess,loaderSmallLogo)};ServiceWrapper.getLobbyLogoUrl=function(onSuccess){Utilities_1.Utilities.SendC2Message(onSuccess,SmallLogo)};ServiceWrapper.getRibbonLogoUrl=function(onSuccess){Utilities_1.Utilities.SendC2Message(onSuccess,smallRibbonLogo)};ServiceWrapper.getUrlVars=function(){if(ServiceWrapper.IsBspot){return BSpotWrapper.getUrlVars()}else{var vars=[];var hash=void 0;var hashes=window.location.search.slice(1).split("&");for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");vars.push(hash[0]);vars[hash[0]]=hash[1]}return vars}};ServiceWrapper.getParamsVars=function(data){var vars=[];var hash;var hashes=data.split("&");for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");vars.push(hash[0]);vars[hash[0]]=hash[1]}return vars};ServiceWrapper.openHistory=function(){if(GolWrapper_1.GolWrapper.isActive){GolWrapper_1.GolWrapper.openHistory()}else if(ServiceWrapper.historyUrl!==""){window.open(ServiceWrapper.historyUrl)}};ServiceWrapper.launchLink=function(name,i_Reason){if(i_Reason===void 0){i_Reason="Ribbon"}if(name==="HomeUrl"&&ServiceWrapper.homeUrl!==null){ServiceWrapper.moveToPage(ServiceWrapper.homeUrl,i_Reason)}else if(name==="HistoryUrl"&&ServiceWrapper.historyUrl!==null){ServiceWrapper.openHistory()}else if(name==="CashierUrl"&&ServiceWrapper.cashierUrl!==null){GameEvents_1.GameEvents.OnCashier(ServiceWrapper.cashierUrl,i_Reason);if(ServiceWrapper.isInIframe){window.open(ServiceWrapper.cashierUrl)}else{ServiceWrapper.moveToPage(ServiceWrapper.cashierUrl,i_Reason)}}else if(name==="PlayForRealUrl"&&ServiceWrapper.playForRealUrl!==null){ServiceWrapper.moveToPage(ServiceWrapper.playForRealUrl,i_Reason)}else if((name==="PlayForFunUrl"||name==="Demo Mode")&&ServiceWrapper.playForFunUrl!==null){ServiceWrapper.moveToPage(ServiceWrapper.playForFunUrl,i_Reason)}else if(name==="ViewLastTicket"&&ServiceWrapper.LastTicketURL!==null){window.open(ServiceWrapper.LastTicketURL)}else if(name==="HelpUrl"){ServiceWrapper.OpenHelpPage()}};ServiceWrapper.onSpinFinish=function(){ServiceWrapper.logMessage("on spin finish")};ServiceWrapper.updateBonusPicked=function(){ServiceWrapper.logMessage("update bonus Picked")};ServiceWrapper.onBonusEnd=function(){ServiceWrapper.logMessage("on bonus end")};ServiceWrapper.onGameReadyToBet=function(){ServiceWrapper.logMessage("game ready to bet")};ServiceWrapper.ticketEnd=function(i_Id){var _this=this;return new Promise(function(resolve){GameEvents_1.GameEvents.TicketEnd(TicketWrapper_1.TicketWrapper.latestTicket);_this.UpdatePromoToolAfterSpin();_this.UpdateFreeRoundsTicketEnd();TicketEndWrapper_1.TicketEndWrapper.request(i_Id).then(function(){resolve()})})};ServiceWrapper.logMessage=function(){var i_Messages=[];for(var _i=0;_i<arguments.length;_i++){i_Messages[_i]=arguments[_i]}LogWrapper_1.LogWrapper.LogMessage(i_Messages)};ServiceWrapper.LogMessage=function(){var i_Messages=[];for(var _i=0;_i<arguments.length;_i++){i_Messages[_i]=arguments[_i]}LogWrapper_1.LogWrapper.LogMessage(i_Messages)};ServiceWrapper.LogError=function(i_Message){LogWrapper_1.LogWrapper.LogError(i_Message)};ServiceWrapper.LogWarning=function(i_Message){LogWrapper_1.LogWrapper.LogWarning(i_Message)};ServiceWrapper.LogMessageWithColor=function(i_Message,i_TextColorOption,i_BackgroundColorOption){return LogWrapper_1.LogWrapper.LogMessageWithColor(i_Message,i_TextColorOption,i_BackgroundColorOption?i_BackgroundColorOption:undefined)};ServiceWrapper.makeid=function(length){var result="";var characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var charactersLength=characters.length;for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*charactersLength))}return result};ServiceWrapper.IsTouchDevice=function(){if(GolWrapper_1.GolWrapper.isActive){return true}if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&RespinWrapper_1.ReSpinWrapper.isGameSupportingArcticRespins){return window.matchMedia("(pointer: coarse)").matches}return ServiceWrapper.gameCode==="SlotMachine_ArcticAdventures"};Object.defineProperty(ServiceWrapper,"isPortrait",{get:function(){return this.isMobile()&&window.matchMedia("(orientation: portrait)").matches},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"IsTouch",{get:function(){return navigator.platform=="MacIntel"&&navigator.maxTouchPoints>0},enumerable:true,configurable:true});ServiceWrapper.isMobile=function(){return ExternalComponents_1.ExternalComponents.DeviceDetector.isMobile||ExternalComponents_1.ExternalComponents.DeviceDetector.isTablet};ServiceWrapper.onGameLoadingStart=function(){DataManager_1.DataManager.onGameStart()};ServiceWrapper.isNullOrEmpty=function(str){return Utilities_1.Utilities.isNullOrEmpty(str)};ServiceWrapper.emulateButtons=function(){var homeUrl=ServiceWrapper.homeUrl;if(homeUrl!==undefined){ServiceWrapper.keyCodes=[{code:83,action:"PlayClick",params:[]},{code:115,action:"PlayClick",params:[]},{code:81,action:"OpenLinkOrRedirect",params:[homeUrl,"Home"]},{code:113,action:"OpenLinkOrRedirect",params:[homeUrl,"Home"]}]}else{ServiceWrapper.keyCodes=[{code:83,action:"PlayClick",params:[]},{code:115,action:"PlayClick",params:[]}]}var keyCodes=ServiceWrapper.keyCodes;$(document).keypress(function(event){var selectedCode=keyCodes.map(function(keyCode){return keyCode.code}).indexOf(event.keyCode);if(selectedCode!==-1){Utilities_1.Utilities.SendC2Message(keyCodes[selectedCode].action,keyCodes[selectedCode].params)}})};ServiceWrapper.attachOrientation=function(){switch(window.orientation){case-90:case 90:Logger_1.Logger.Events.Orientation(true,false);break;default:Logger_1.Logger.Events.Orientation(false,false);break}window.addEventListener("orientationchange",function(){switch(window.orientation){case-90:case 90:Logger_1.Logger.Events.Orientation(true,true);break;default:Logger_1.Logger.Events.Orientation(false,true);break}},false)};ServiceWrapper.terminalStartBonus=function(){TerminalWrapper_1.TerminalWrapper.bonusStarted()};ServiceWrapper.terminalEndBonus=function(){TerminalWrapper_1.TerminalWrapper.bonusEnded()};ServiceWrapper.selectionScreenOpened=function(){TerminalWrapper_1.TerminalWrapper.setInsideSelectionScreen(true)};ServiceWrapper.selectionScreenClosed=function(){TerminalWrapper_1.TerminalWrapper.setInsideSelectionScreen(false)};ServiceWrapper.formatNumber=function(i_Number){return CurrencyWrapper_1.CurrencyWrapper.FormatNumber(i_Number)};ServiceWrapper.formatCurrency=function(i_Number,i_UseCurrencyCode){if(i_UseCurrencyCode===void 0){i_UseCurrencyCode=false}return CurrencyWrapper_1.CurrencyWrapper.FormatCurrency(i_Number,i_UseCurrencyCode)};ServiceWrapper.GameSupportsSpaceForWhow=function(){ServiceWrapper.m_IsGameSupportsSpaceForWhow=true};Object.defineProperty(ServiceWrapper,"IsGameSupportsSpaceForWhow",{get:function(){return ServiceWrapper.m_IsGameSupportsSpaceForWhow},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"GameConfig",{get:function(){return ServiceWrapper.Info.EnvironmentInfo},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"TerminalID",{get:function(){if(GolWrapper_1.GolWrapper.isActive){return GolWrapper_1.GolWrapper.machineId}return null},enumerable:true,configurable:true});ServiceWrapper.AdjustTicketResult=function(i_data){return TicketWrapper_1.TicketWrapper.AdjustTicketResult(i_data)};ServiceWrapper.SendC2Message=function(i_ReturnFunction,i_Info){Utilities_1.Utilities.SendC2Message(i_ReturnFunction,i_Info)};ServiceWrapper.HandleBspotError=function(i_DisplayMessage){var response={Result:null,ResultInfo:ErrorWrapper_1.ErrorWrapper.HandleBspotError(i_DisplayMessage)};Utilities_1.Utilities.SendC2Message("ReadTicket",response)};ServiceWrapper.UpdateError=function(i_Error){return ErrorWrapper_1.ErrorWrapper.UpdateError(i_Error)};ServiceWrapper.ThrowExternalComponentNotLoadedError=function(){this.m_ExternalError=true;if(this.m_IsGameLoaded){ErrorWrapper_1.ErrorWrapper.ThrowExternalComponentNotLoadedError()}};ServiceWrapper.SpinStart=function(){GameEvents_1.GameEvents.SpinStart()};ServiceWrapper.SpinEnd=function(){GameEvents_1.GameEvents.SpinEnd()};ServiceWrapper.BonusStart=function(){GameEvents_1.GameEvents.BonusStart()};ServiceWrapper.BonusEnd=function(){GameEvents_1.GameEvents.BonusEnd()};ServiceWrapper.LoadingStart=function(){GameEvents_1.GameEvents.LoadingStart()};ServiceWrapper.LoadingFinished=function(){if(ServiceWrapper.m_IsGameLoaded){return}ServiceWrapper.m_IsGameLoaded=true;if(this.m_ExternalError){this.ThrowExternalComponentNotLoadedError()}if(this.m_IsInError){this.ErrorScreenBlockGame()}GameEvents_1.GameEvents.LoadingFinished()};ServiceWrapper.BetUpdated=function(i_NewBetVal){if(ServiceWrapper.Info&&ServiceWrapper.Info.GameInfo){ServiceWrapper.Info.GameInfo.Bet=i_NewBetVal}if(ExternalComponents_1.ExternalComponents.AutoPlayMenu){ExternalComponents_1.ExternalComponents.AutoPlayMenu.CurrentBet=i_NewBetVal}if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.OnGameBetChanged(i_NewBetVal)}GameEvents_1.GameEvents.BetUpdated(i_NewBetVal)};ServiceWrapper.LinesUpdated=function(i_NewLinesNumber){GameEvents_1.GameEvents.LinesUpdated(i_NewLinesNumber)};ServiceWrapper.AutoPlayStart=function(){GameEvents_1.GameEvents.AutoPlayStart()};ServiceWrapper.AutoPlayFinished=function(){GameEvents_1.GameEvents.AutoPlayFinished()};ServiceWrapper.TurboClicked=function(i_IsTurboOn){GameEvents_1.GameEvents.TurboClicked(i_IsTurboOn);window.dispatchEvent(new CustomEvent("auto-bet-menu-turbo",{detail:i_IsTurboOn}));if(ExternalComponents_1.ExternalComponents.AutoPlayMenu){ExternalComponents_1.ExternalComponents.AutoPlayMenu.IsGameInTurbo=i_IsTurboOn}};ServiceWrapper.AudioClicked=function(i_IsAudioOn){ServiceWrapper.IsSoundOn=i_IsAudioOn;GameEvents_1.GameEvents.AudioClicked(i_IsAudioOn)};ServiceWrapper.ErrorScreenShowing=function(){GameEvents_1.GameEvents.ErrorScreenShowing()};Object.defineProperty(ServiceWrapper,"CdnPath",{get:function(){return this.m_CdnPath},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"ExternalComponentPath",{get:function(){return this.CdnPath+"external_components/"},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"IsGameCertified",{get:function(){return ServiceWrapper.Info.GameInfo.IsSupportCertification},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"IsSoundOn",{get:function(){return ServiceWrapper.m_IsSoundOn},set:function(i_IsAudioOn){ServiceWrapper.m_IsSoundOn=i_IsAudioOn},enumerable:true,configurable:true});ServiceWrapper.requestSessionTime=function(i_Frequency){if(i_Frequency===void 0){i_Frequency=null}var data={gameToken:ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper.Info.GameInfo.LoadedGameLanguage};if(ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper.playerId}if(ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper.externalId}if(ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper.platformId}if(ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper.subPlatformId}if(ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper.currency}if(ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper.lobbyToken}data.Interval=i_Frequency;if(data.Interval){data.UserAction="reset"}else{data.UserAction="stopgaming"}$.ajax({url:ServiceWrapper.baseUrl+"DialogCheck",data:JSON.stringify(data),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",timeout:3e4,success:function(result){if(data.UserAction==="stopgaming"){if(sendLogOutRequest&&typeof sendLogOutRequest==="function"){sendLogOutRequest().then(function(){ServiceWrapper.interactWithError(ErrorWrapper_1.IErrorButtonActions.Terminate)})}else{ServiceWrapper.interactWithError(ErrorWrapper_1.IErrorButtonActions.Terminate)}}},error:function(jqXHR,exception,error){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,"");if(jqXHR.status===0||jqXHR.status===500||exception==="timeout"){}}})};Object.defineProperty(ServiceWrapper,"IsDebugEnvironment",{get:function(){var _a,_b;return this.IsLocalDebug||window.location.host.includes("dev.spinomenal")||((_b=(_a=this.Info)===null||_a===void 0?void 0:_a.UrlVars)===null||_b===void 0?void 0:_b.Environment)==="dev"},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"IsLocalDebug",{get:function(){return window.location.href.includes("http://localhost")},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"isWhow",{get:function(){return ServiceWrapper.Info.EnvironmentInfo.IsSocial},enumerable:true,configurable:true});ServiceWrapper.UpdateFreeRoundsTicketEnd=function(){if(ExternalComponents_1.ExternalComponents.FreeRounds){ExternalComponents_1.ExternalComponents.FreeRounds.OnTicketEnd()}};Object.defineProperty(ServiceWrapper,"dynamicLoadDirectory",{get:function(){var brandName=this.PerGameConfig.GameCode.split("_")[1].split("-")[0];if(window.ServiceWrapper&&ServiceWrapper.PerGameConfig.DynamicFolderPath){brandName=ServiceWrapper.PerGameConfig.DynamicFolderPath}return ServiceWrapper.PerGameConfig.Path+"DynamicBranding/"+brandName+"/"+(this.isMobile()?"mb":"pc")+"/"},enumerable:true,configurable:true});Object.defineProperty(ServiceWrapper,"tickerJson",{get:function(){return TickerWrapper_1.TickerWrapper.tickerJson},enumerable:true,configurable:true});ServiceWrapper.baseUrl="/Service/";ServiceWrapper.homeUrl=null;ServiceWrapper.cashierUrl=null;ServiceWrapper.playForRealUrl=null;ServiceWrapper.playForFunUrl=null;ServiceWrapper.lastCallBack=null;ServiceWrapper.historyUrl=null;ServiceWrapper.refreshCounter=0;ServiceWrapper.refreshLimit=100;ServiceWrapper.isRequestingSpin=false;ServiceWrapper.isReal=false;ServiceWrapper.isJsonSupport=false;ServiceWrapper.isNewPlatform=false;ServiceWrapper.IsExternalErrorScreenExists=false;ServiceWrapper.LastTicketURL=null;ServiceWrapper.WaitingLastTicketEnd=false;ServiceWrapper.CrossLaunchUrl=null;ServiceWrapper.subPlatformId=null;ServiceWrapper.i_Info=null;ServiceWrapper.m_Communications=null;ServiceWrapper.eOnDisableSpin=new Events_1.GenericEvent;ServiceWrapper.eOnEnableSpin=new Events_1.GenericEvent;ServiceWrapper.IsStakeChangeEnabled=false;ServiceWrapper.IsTurboToggleEnabled=false;ServiceWrapper.IsSoundToggleEnabled=false;ServiceWrapper.IsAutoPlayToggleEnabled=false;ServiceWrapper.eOnExternalComponentsLoaded=new Events_1.GenericEvent;ServiceWrapper.paramJson={disableKeyboardInput:0,allowChangeFullScreen:1,skipMainSplash:0,turboMode:0,langCode:"",originalLangCode:null,gameCode:"",homeUrl:"",HomeUrl:"",CashierUrl:"",cashierUrl:"",PlayForRealUrl:"",PlayForFunUrl:"",gameToken:"",loadingLogo:"",ribbonLogo:"",soundOn:1,platform:"",partnerId:"",LobbyUrl:"",ReloadUrl:"",BonusProxy:0,GameCodeIdentifier:"",allowRefreshBalance:0,pathUrl:"",mode:0,allowSkipAuto:1,fontPath:"",LogicJs:"",scriptPath:"",isTerminal:0,normalWinLengthFactor:1,bigWinLengthFactor:1,ctest:0,perGameConfigLang:"",showBrandedLoader:1,brandLogoUrl:"",token:"",playForReal:"",gameType:"",admin:"",currencyCode:"",normalWinDelayFactor:0,IsUsingDebugTickets:false};ServiceWrapper.m_IsGameLoaded=false;ServiceWrapper.m_IsInError=false;ServiceWrapper.wrapperClasses={AutoBetMenuWrapper:AutoBetMenuWrapper_1.AutoBetMenuWrapper,PaytableWrapper:PaytableWrapper_1.PaytableWrapper,HelpPageWrapper:HelpPageWrapper_1.HelpPageWrapper,PromoToolWrapper:PromoToolWrapper_1.PromoToolWrapper,MegaFlashScreenWrapper:MegaFlashScreenWrapper_1.MegaFlashScreenWrapper,WinnersRoundScreenWrapper:WinnersRoundScreenWrapper_1.WinnersRoundScreenWrapper,BetSlipWrapper:BetSlipWrapper_1.BetSlipWrapper,TicketGeneratorWrapper:TicketGeneratorWrapper_1.TicketGeneratorWrapper,FreeRoundsScreenWrapper:FreeRoundsScreenWrapper_1.FreeRoundsScreenWrapper,PromoScreenWrapper:PromoScreenWrapper_1.PromoScreenWrapper};ServiceWrapper.isTerminal=false;ServiceWrapper.m_IsGameSupportsSpaceForWhow=false;ServiceWrapper.m_ExternalError=false;ServiceWrapper.m_CdnPath="../";ServiceWrapper.m_IsSoundOn=true;ServiceWrapper.ShowDebugLogs=false;ServiceWrapper.debugLog=ServiceWrapper.IsDebugEnvironment;return ServiceWrapper}();exports.ServiceWrapper=ServiceWrapper;window.ServiceWrapper=ServiceWrapper},{"../DataManager":4,"../Events":7,"../ExternalComponents/ExternalComponents":8,"../ExternalComponents/Wrappers/AutoBetMenuWrapper":9,"../ExternalComponents/Wrappers/BetSlipWrapper":10,"../ExternalComponents/Wrappers/FreeRoundsScreenWrapper":11,"../ExternalComponents/Wrappers/HelpPageWrapper":12,"../ExternalComponents/Wrappers/MegaFlashScreenWrapper":13,"../ExternalComponents/Wrappers/PaytableWrapper":14,"../ExternalComponents/Wrappers/PromoScreenWrapper":15,"../ExternalComponents/Wrappers/PromoToolWrapper":16,"../ExternalComponents/Wrappers/TicketGeneratorWrapper":17,"../ExternalComponents/Wrappers/WinnersRoundScreenWrapper":18,"../GameEvents":20,"../Logger":21,"../Utilities":22,"../Versions":23,"./BalanceWrapper":25,"./BonusWrapper":26,"./BuyFeatureWrapper":27,"./CurrencyWrapper":29,"./ErrorWrapper":30,"./FreeSpinsPickerWrapper":31,"./GambleWrapper":33,"./GolWrapper":36,"./LogWrapper":37,"./PromoWrapper":39,"./RespinWrapper":40,"./StartTicketWrapper":42,"./TerminalWrapper":43,"./TickerWrapper":44,"./TicketEndWrapper":45,"./TicketWrapper":46}],42:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var GameConfig_1=require("../GameConfig");var Utilities_1=require("../Utilities");var BalanceWrapper_1=require("./BalanceWrapper");var ErrorWrapper_1=require("./ErrorWrapper");var GameEvents_1=require("../GameEvents");var GambleWrapper_1=require("./GambleWrapper");var GolWrapper_1=require("./GolWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var TicketEndWrapper_1=require("./TicketEndWrapper");var TicketWrapper_1=require("./TicketWrapper");var Events_1=require("../Events");var GET_FROM_URL_STRING="[get-from-url]";var StartTicketWrapper=function(){function StartTicketWrapper(){}StartTicketWrapper.CheckPerGameConfig=function(i_Result){var perGameConfig=ServiceWrapper_1.ServiceWrapper.PerGameConfig;if(perGameConfig&&i_Result.Result){if(typeof i_Result.Result.RtpVariantId!=="undefined"&&i_Result.Result.RtpVariantId!==null){if(perGameConfig&&perGameConfig.RTPVariants){var rtpObject=perGameConfig.RTPVariants.find(function(a){return a.Id===i_Result.Result.RtpVariantId});if(!rtpObject){rtpObject=perGameConfig.RTPVariants.find(function(a){return a.IsDefault})}if(rtpObject){if(rtpObject.RTP){perGameConfig.RTP=rtpObject.RTP;i_Result.Result.RTP=Number(perGameConfig.RTP)}if(rtpObject.BuyFeatureRTP){perGameConfig.BuyFeatureRTP=rtpObject.BuyFeatureRTP}if(rtpObject.MaxWinChance){perGameConfig.MaxWinChance=rtpObject.MaxWinChance}}}}if(i_Result.Result.ClassId&&perGameConfig.GameClassId&&i_Result.Result.ClassId!==perGameConfig.GameClassId){return ErrorWrapper_1.ErrorWrapper.ClassIdDoesNotMatchError}if(perGameConfig.RTP){if(typeof perGameConfig.RTP==="number"){i_Result.Result.RTP=perGameConfig.RTP}else if(typeof perGameConfig.RTP==="object"){i_Result.Result.RTP=perGameConfig.RTP.Max}}if(perGameConfig.BuyFeatureRTP){if(typeof perGameConfig.BuyFeatureRTP==="number"){i_Result.Result.BuyFeatureRTP=perGameConfig.BuyFeatureRTP}else if(typeof perGameConfig.BuyFeatureRTP==="object"){i_Result.Result.BuyFeatureRTP=perGameConfig.BuyFeatureRTP.Max}}if(perGameConfig.MaxWinChance){i_Result.Result.MaxWinChance=perGameConfig.MaxWinChance}if(perGameConfig.BigWinMultiplier){i_Result.Result.BigWin=perGameConfig.BigWinMultiplier}if(perGameConfig.MegaWinMultiplier){i_Result.Result.MegaWin=perGameConfig.MegaWinMultiplier}if(perGameConfig.SuperWinMultiplier){i_Result.Result.SuperWin=perGameConfig.SuperWinMultiplier}if(perGameConfig.EpicWinMultiplier){i_Result.Result.EpicWin=perGameConfig.EpicWinMultiplier}}return i_Result};StartTicketWrapper.AdjustInitResult=function(i_Result){if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment&&StartTicketWrapper.ForceStartTicketError){i_Result.Result=null;i_Result.ResultInfo={Action:null,Code:123456789,Message:"",DisplayMessage:StartTicketWrapper.ErrorType,Buttons:[]};StartTicketWrapper.ForceStartTicketError=false}if(i_Result!==null&&i_Result.ResultInfo!==null){if(i_Result.ResultInfo.Code===0){if(!i_Result.Result.Links){i_Result.Result.Links=[]}var additionalInfo=i_Result.Result.AdditionalInfo;if(additionalInfo){i_Result=this.AdjustResultIntegrationOrder(i_Result,additionalInfo)}i_Result=this.AdjustLinkHelp(i_Result);i_Result=this.AdjustBspot(i_Result);i_Result=this.AdjustLinkHistory(i_Result);this.AdjustExternalId(i_Result);this.AdjustCurrencyCode(i_Result);this.AdjustUrls(i_Result);i_Result=this.AdjustLinkHome(i_Result);i_Result=this.AdjustLinkCashier(i_Result);i_Result=this.AdjustLinkPlayForFun(i_Result);i_Result=this.AdjustLinkPlayForReal(i_Result);this.AdjustPlayerTokenId(i_Result);this.AdjustPlayerId(i_Result);i_Result=this.AdjustBspotLastTokens(i_Result);i_Result=this.AdjustSocialWins(i_Result);i_Result=this.AdjustLastData(i_Result)}if(i_Result.ResultInfo.Code>0||i_Result.Result&&typeof i_Result.Result.LastTicketInfo!=="undefined"&&i_Result.Result.LastTicketInfo){i_Result.ResultInfo=ErrorWrapper_1.ErrorWrapper.UpdateError(i_Result.ResultInfo,true)}}return i_Result};StartTicketWrapper.AdjustLastData=function(i_Result){var resumeBetAmount=null;if(i_Result.Result.LastData!==null&&typeof i_Result.Result.LastData!=="undefined"){if(typeof i_Result.Result.LastData.FreeTickets!=="undefined"&&i_Result.Result.LastData.FreeTickets!==null&&"Gamble"in i_Result.Result.LastData.FreeTickets&&i_Result.Result.LastData.FreeTickets.Gamble!==null){GambleWrapper_1.GambleWrapper.isActive=true}if(GameConfig_1.GameConfig.isGameSupportingStickyFix(i_Result)&&i_Result.Result.LastData.FreeTickets!==null&&i_Result.Result.LastData.StickyIcons!==null&&i_Result.Result.LastData.StickyIcons.length>0){if(i_Result.Result.LastData.FreeTickets.To===1){i_Result.Result.LastData.StickyIcons.forEach(function(icon){icon.IsNew=true})}else{TicketWrapper_1.TicketWrapper.handleSticky=true;i_Result.Result.LastData.StickyIcons=null}}if(i_Result.Result.LastData.Bet){resumeBetAmount=i_Result.Result.LastData.Bet*i_Result.Result.LastData.Lines}}if(!resumeBetAmount){resumeBetAmount=i_Result.Result.DefaultBetUnit*i_Result.Result.DefaultLines}if(ServiceWrapper_1.ServiceWrapper.Info&&ServiceWrapper_1.ServiceWrapper.Info.GameInfo){ServiceWrapper_1.ServiceWrapper.Info.GameInfo.Bet=resumeBetAmount}ServiceWrapper_1.ServiceWrapper.updateBetAmount(resumeBetAmount);if(typeof i_Result.Result.LastTicketInfo!=="undefined"&&i_Result.Result.LastTicketInfo){ServiceWrapper_1.ServiceWrapper.LastTicketURL=i_Result.Result.LastTicketInfo.LastTicketUrl;i_Result.ResultInfo.DisplayMessage=ErrorWrapper_1.IErrorDisplayMessages.RESUME_COMMUNICATION}return i_Result};StartTicketWrapper.AdjustSocialWins=function(i_Result){if(i_Result.Result&&ServiceWrapper_1.ServiceWrapper.isWhow){i_Result.Result.BigWin=10;i_Result.Result.MegaWin=15;i_Result.Result.SuperWin=25;i_Result.Result.EpicWin=40}return i_Result};StartTicketWrapper.AdjustBspotLastTokens=function(i_Result){if(ServiceWrapper_1.ServiceWrapper.IsBspot){i_Result=BSpotWrapper.readLastTokens(i_Result)}return i_Result};StartTicketWrapper.AdjustPlayerId=function(i_Result){if(i_Result.PlayerId){ServiceWrapper_1.ServiceWrapper.playerId=i_Result.PlayerId}};StartTicketWrapper.AdjustPlayerTokenId=function(i_Result){if(i_Result.Result&&i_Result.Result.ExternalId){ServiceWrapper_1.ServiceWrapper.playerTokenId=i_Result.Result.ExternalId}};StartTicketWrapper.AdjustLinkPlayForReal=function(i_Result){if(ServiceWrapper_1.ServiceWrapper.Info.Urls.PlayForRealUrl!==null){i_Result.Result.Links.push({Name:"PlayForRealUrl",Text:ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_PlayForReal,IsWarn:0})}return i_Result};StartTicketWrapper.AdjustLinkPlayForFun=function(i_Result){if(ServiceWrapper_1.ServiceWrapper.Info.Urls.PlayForFunUrl!==null){i_Result.Result.Links.push({Name:"PlayForFunUrl",Text:ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_PlayForFun,IsWarn:0})}return i_Result};StartTicketWrapper.AdjustLinkCashier=function(i_Result){if(typeof ServiceWrapper_1.ServiceWrapper.cashierUrl!=="undefined"&&ServiceWrapper_1.ServiceWrapper.cashierUrl!==null){i_Result.Result.Links.push({Name:"CashierUrl",Text:ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_Deposit,IsWarn:0})}return i_Result};StartTicketWrapper.AdjustLinkHome=function(i_Result){if(ServiceWrapper_1.ServiceWrapper.Info.Urls.HomeUrl!==null){i_Result.Result.Links.push({Name:"HomeUrl",Text:ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_Home,IsWarn:1})}return i_Result};StartTicketWrapper.AdjustUrls=function(i_Result){if(i_Result&&i_Result.Result){if(i_Result.Result.CurrencyCode){ServiceWrapper_1.ServiceWrapper.currency=i_Result.Result.CurrencyCode}if("Urls"in i_Result.Result){if(i_Result.Result.Urls.HomeUrl){ServiceWrapper_1.ServiceWrapper.paramJson.HomeUrl=i_Result.Result.Urls.HomeUrl;ServiceWrapper_1.ServiceWrapper.paramJson.homeUrl=i_Result.Result.Urls.HomeUrl;ServiceWrapper_1.ServiceWrapper.homeUrl=i_Result.Result.Urls.HomeUrl}if(i_Result.Result.Urls.CashierUrl){ServiceWrapper_1.ServiceWrapper.paramJson.CashierUrl=i_Result.Result.Urls.CashierUrl;ServiceWrapper_1.ServiceWrapper.cashierUrl=i_Result.Result.Urls.CashierUrl}if(i_Result.Result.Urls.HistoryUrl){ServiceWrapper_1.ServiceWrapper.historyUrl=i_Result.Result.Urls.HistoryUrl}}}};StartTicketWrapper.AdjustCurrencyCode=function(i_Result){if("CurrencyCode"in i_Result){ServiceWrapper_1.ServiceWrapper.currency=i_Result.CurrencyCode}};StartTicketWrapper.AdjustExternalId=function(i_Result){if("ExternalId"in i_Result){ServiceWrapper_1.ServiceWrapper.externalId=i_Result.ExternalId;ServiceWrapper_1.ServiceWrapper.Info.UrlVars.ExternalId=i_Result.ExternalId}};StartTicketWrapper.AdjustLinkHistory=function(i_Result){if(i_Result.Result.HistoryUrl!==null&&i_Result.Result.HistoryUrl!==""||ServiceWrapper_1.ServiceWrapper.historyUrl){if(!ServiceWrapper_1.ServiceWrapper.historyUrl){ServiceWrapper_1.ServiceWrapper.historyUrl=i_Result.Result.HistoryUrl}i_Result.Result.Links.push({Name:"HistoryUrl",Text:ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_History,IsWarn:0})}return i_Result};StartTicketWrapper.AdjustBspot=function(i_Result){if(ServiceWrapper_1.ServiceWrapper.IsBspot){i_Result=BSpotWrapper.adjustInit(i_Result)}return i_Result};StartTicketWrapper.AdjustLinkHelp=function(i_Result){if(ServiceWrapper_1.ServiceWrapper.HelpPageExists){i_Result.Result.Links.push({Name:"HelpUrl",Text:ExternalComponents_1.ExternalComponents.Languages.Labels.LABEL_Help,IsWarn:0});ServiceWrapper_1.ServiceWrapper.LogMessage("Help page link added to start ticket")}return i_Result};StartTicketWrapper.AdjustResultIntegrationOrder=function(i_Result,i_AdditionalInfo){for(var _i=0,_a=Object.entries(i_AdditionalInfo);_i<_a.length;_i++){var _b=_a[_i],key=_b[0],value=_b[1];if(value&&typeof value==="string"){i_AdditionalInfo[key]=decodeURIComponent(value)}}if(!i_Result.Result.Urls){i_Result.Result.Urls={}}i_Result=this.AdjustHomeUrl(i_Result,i_AdditionalInfo);i_Result=this.AdjustLobbyUrl(i_Result,i_AdditionalInfo);i_Result=this.AdjustCashierUrl(i_Result,i_AdditionalInfo);i_Result=this.AdjustHistoryUrl(i_Result,i_AdditionalInfo);i_Result=this.AdjustSupportUrl(i_Result,i_AdditionalInfo);i_Result=this.AdjustLogOutUrl(i_Result,i_AdditionalInfo);return i_Result};StartTicketWrapper.AdjustLogOutUrl=function(i_Result,i_AdditionalInfo){if(i_AdditionalInfo.LogOutUrl){i_Result.Result.Urls.LogoutUrl=i_AdditionalInfo.LogOutUrl}return i_Result};StartTicketWrapper.AdjustSupportUrl=function(i_Result,i_AdditionalInfo){if(i_AdditionalInfo.SupportUrl){i_Result.Result.Urls.SupportUrl=i_AdditionalInfo.SupportUrl}return i_Result};StartTicketWrapper.AdjustHistoryUrl=function(i_Result,i_AdditionalInfo){if(i_AdditionalInfo.HistoryUrl){var isCombine=i_AdditionalInfo.HistoryUrl.includes(GET_FROM_URL_STRING)&&ServiceWrapper_1.ServiceWrapper.historyUrl;if(isCombine){i_AdditionalInfo.HistoryUrl=i_AdditionalInfo.HistoryUrl.replace(GET_FROM_URL_STRING,ServiceWrapper_1.ServiceWrapper.historyUrl)}i_Result.Result.Urls.HistoryUrl=i_AdditionalInfo.HistoryUrl;i_Result.Result.HistoryUrl=i_AdditionalInfo.HistoryUrl}return i_Result};StartTicketWrapper.AdjustCashierUrl=function(i_Result,i_AdditionalInfo){if(i_AdditionalInfo.CashierUrl){var isCombine=i_AdditionalInfo.CashierUrl.includes(GET_FROM_URL_STRING)&&ServiceWrapper_1.ServiceWrapper.cashierUrl;if(isCombine){i_AdditionalInfo.CashierUrl=i_AdditionalInfo.CashierUrl.replace(GET_FROM_URL_STRING,ServiceWrapper_1.ServiceWrapper.cashierUrl)}if(!i_Result.Result.Urls.HomeUrl&&!ServiceWrapper_1.ServiceWrapper.homeUrl){i_Result.Result.Urls.HomeUrl=i_AdditionalInfo.CashierUrl}if(!ServiceWrapper_1.ServiceWrapper.cashierUrl||isCombine){i_Result.Result.Urls.CashierUrl=i_AdditionalInfo.CashierUrl}}return i_Result};StartTicketWrapper.AdjustLobbyUrl=function(i_Result,i_AdditionalInfo){if(i_AdditionalInfo.LobbyUrl){if(!i_Result.Result.Urls.HomeUrl&&!ServiceWrapper_1.ServiceWrapper.homeUrl){i_Result.Result.Urls.HomeUrl=i_AdditionalInfo.LobbyUrl}}return i_Result};StartTicketWrapper.AdjustHomeUrl=function(i_Result,i_AdditionalInfo){if(i_AdditionalInfo.HomeUrl){var isCombine=i_AdditionalInfo.HomeUrl.includes(GET_FROM_URL_STRING)&&ServiceWrapper_1.ServiceWrapper.homeUrl;if(isCombine){i_AdditionalInfo.HomeUrl=i_AdditionalInfo.HomeUrl.replace(GET_FROM_URL_STRING,ServiceWrapper_1.ServiceWrapper.homeUrl)}if(!ServiceWrapper_1.ServiceWrapper.homeUrl||isCombine){i_Result.Result.Urls.HomeUrl=i_AdditionalInfo.HomeUrl}}return i_Result};StartTicketWrapper.requestInitFromGame=function(action){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){if(ServiceWrapper_1.ServiceWrapper.paramJson.gameCode===""){ServiceWrapper_1.ServiceWrapper.onGameLoadingStart()}if(StartTicketWrapper.startTicket&&StartTicketWrapper.startTicket.ResultInfo&&StartTicketWrapper.startTicket.ResultInfo.Code===0&&ServiceWrapper_1.ServiceWrapper.Info.UrlVars.IsReal){BalanceWrapper_1.BalanceWrapper.activate()}Utilities_1.Utilities.SendC2Message(action,StartTicketWrapper.startTicket);return[2]})})};StartTicketWrapper.PassInfoAfterTicketReceived=function(i_Ticket){GameEvents_1.GameEvents.StartTicketReceived(i_Ticket);if(!i_Ticket.Result){return}i_Ticket.Result.IsPreview=0;i_Ticket.Result.IsPreviewAll=0;if(i_Ticket.Result.ResumeData&&i_Ticket.Result.ResumeData.MiniGame){TicketEndWrapper_1.TicketEndWrapper.latestWinAmount=i_Ticket.Result.ResumeData.MiniGame.Win}if(i_Ticket.Result.LastData&&i_Ticket.Result.LastData.BonusSpin){TicketEndWrapper_1.TicketEndWrapper.latestWinAmount=i_Ticket.Result.LastData.BonusSpin.LastWin}};Object.defineProperty(StartTicketWrapper,"startTicket",{get:function(){return this.m_StartTicket},set:function(i_Ticket){if(this.startTicket||!i_Ticket){return}if(ServiceWrapper_1.ServiceWrapper.Info.StartTicket){ServiceWrapper_1.ServiceWrapper.Info.StartTicket=null}i_Ticket=StartTicketWrapper.CheckPerGameConfig(i_Ticket);i_Ticket=StartTicketWrapper.AdjustInitResult(i_Ticket);if(GolWrapper_1.GolWrapper.isActive){GolWrapper_1.GolWrapper.adjustParams()}this.PassInfoAfterTicketReceived(i_Ticket);BalanceWrapper_1.BalanceWrapper.HandleParimatch();ServiceWrapper_1.ServiceWrapper.LogMessage("[StartTicketWrapper] start ticket: "+JSON.stringify(i_Ticket));this.m_StartTicket=i_Ticket;this.eOnStartTicketSet.Trigger()},enumerable:true,configurable:true});StartTicketWrapper.eOnStartTicketSet=new Events_1.GenericEvent;StartTicketWrapper.m_StartTicket=null;StartTicketWrapper.ForceStartTicketError=false;StartTicketWrapper.ErrorType="TEMPORARY_ERROR";return StartTicketWrapper}();exports.StartTicketWrapper=StartTicketWrapper},{"../Events":7,"../ExternalComponents/ExternalComponents":8,"../GameConfig":19,"../GameEvents":20,"../Utilities":22,"./BalanceWrapper":25,"./ErrorWrapper":30,"./GambleWrapper":33,"./GolWrapper":36,"./ServiceWrapper":41,"./TicketEndWrapper":45,"./TicketWrapper":46}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Utilities_1=require("../Utilities");var TerminalWrapper=function(){function TerminalWrapper(){}TerminalWrapper.togglePayTable=function(){Utilities_1.Utilities.SendC2Message("Ext_TogglePayTABLE",[])};TerminalWrapper.moveLeft=function(){if(TerminalWrapper.insideBonus){TerminalWrapper.bonusPlayed=true}Utilities_1.Utilities.SendC2Message("Ext_MoveLeft",[])};TerminalWrapper.moveRight=function(){if(TerminalWrapper.insideBonus){TerminalWrapper.bonusPlayed=true}Utilities_1.Utilities.SendC2Message("Ext_MoveRight",[])};TerminalWrapper.selectPosition=function(){if(TerminalWrapper.insideBonus){TerminalWrapper.bonusPlayed=true}Utilities_1.Utilities.SendC2Message("Ext_SelectPosition",[])};TerminalWrapper.maxBet=function(){Utilities_1.Utilities.SendC2Message("Ext_MaxBet",[])};TerminalWrapper.increaseBet=function(){Utilities_1.Utilities.SendC2Message("Ext_IncreaseBet",[])};TerminalWrapper.decreaseBet=function(){Utilities_1.Utilities.SendC2Message("Ext_DecreaseBet",[])};TerminalWrapper.toggleSound=function(){Utilities_1.Utilities.SendC2Message("Ext_ToggleSound",[])};TerminalWrapper.playAction=function(){Utilities_1.Utilities.SendC2Message("Ext_PlayAction",[])};TerminalWrapper.toggleAutoPlay=function(){Utilities_1.Utilities.SendC2Message("Ext_ToggleAutoPlay",[])};TerminalWrapper.autoPlayBonus=function(){Utilities_1.Utilities.SendC2Message("Ext_AutoPlayBonus",[])};TerminalWrapper.bonusStarted=function(){TerminalWrapper.insideBonus=true;setTimeout(function(){if(!TerminalWrapper.bonusPlayed){TerminalWrapper.autoPlayBonus()}},3e4)};TerminalWrapper.bonusEnded=function(){TerminalWrapper.insideBonus=false;TerminalWrapper.bonusPlayed=false};TerminalWrapper.setInsideSelectionScreen=function(flag){TerminalWrapper.insideSelectionScreen=flag};TerminalWrapper.emulateButtons=function(){TerminalWrapper.keyCodes=[{code:48,action:function(){TerminalWrapper.insideBonus?TerminalWrapper.selectPosition():TerminalWrapper.playAction()}},{code:13,action:function(){TerminalWrapper.playAction()}},{code:32,action:function(){TerminalWrapper.playAction()}},{code:51,action:function(){TerminalWrapper.insideBonus||TerminalWrapper.insideSelectionScreen?TerminalWrapper.moveRight():TerminalWrapper.maxBet()}},{code:52,action:function(){TerminalWrapper.insideBonus||TerminalWrapper.insideSelectionScreen?TerminalWrapper.moveLeft():TerminalWrapper.decreaseBet()}},{code:54,action:function(){TerminalWrapper.increaseBet()}},{code:55,action:function(){TerminalWrapper.togglePayTable()}},{code:49,action:function(){TerminalWrapper.toggleSound()}},{code:57,action:function(){TerminalWrapper.toggleAutoPlay()}}];var keyCodes=TerminalWrapper.keyCodes;$(document).keypress(function(event){var selectedCode=keyCodes.map(function(e){return e.code}).indexOf(event.keyCode);if(selectedCode!==-1){keyCodes[selectedCode].action()}})};TerminalWrapper.insideBonus=false;TerminalWrapper.bonusPlayed=false;TerminalWrapper.insideSelectionScreen=false;TerminalWrapper.keyCodes=[];return TerminalWrapper}();exports.TerminalWrapper=TerminalWrapper},{"../Utilities":22}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ServiceWrapper_1=require("./ServiceWrapper");var TickerWrapper=function(){function TickerWrapper(){}Object.defineProperty(TickerWrapper,"tickerPath",{get:function(){return ServiceWrapper_1.ServiceWrapper.ExternalComponentPath+"json_files/ticker/"+ServiceWrapper_1.ServiceWrapper.PerGameConfig.TickerJsonPath},enumerable:true,configurable:true});Object.defineProperty(TickerWrapper,"tickerJson",{get:function(){var _this=this;return new Promise(function(resolve){if(_this.m_Json){resolve(_this.m_Json);return}resolve(_this.loadJson)})},enumerable:true,configurable:true});Object.defineProperty(TickerWrapper,"loadJson",{get:function(){var _this=this;return new Promise(function(resolve){fetch(_this.tickerPath).then(function(response){if(!response.ok){throw new Error(response.statusText)}return response.json()}).then(function(json){resolve(json)}).catch(function(error){ServiceWrapper_1.ServiceWrapper.LogError(error);ServiceWrapper_1.ServiceWrapper.ThrowExternalComponentNotLoadedError();resolve(null)})})},enumerable:true,configurable:true});TickerWrapper.m_Json=null;return TickerWrapper}();exports.TickerWrapper=TickerWrapper},{"./ServiceWrapper":41}],45:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});var StartTicketWrapper_1=require("./StartTicketWrapper");var RespinWrapper_1=require("./RespinWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var TicketWrapper_1=require("./TicketWrapper");var TicketEndWrapper=function(){function TicketEndWrapper(){}Object.defineProperty(TicketEndWrapper,"isActive",{get:function(){return ServiceWrapper_1.ServiceWrapper.isWhow||ServiceWrapper_1.ServiceWrapper.Info&&ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo&&ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.IsCertified},enumerable:true,configurable:true});TicketEndWrapper.sendAjaxRequest=function(ticketId){return new Promise(function(resolve){var data={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage,ticketId:ticketId};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}var parameters=JSON.stringify(data);var requestPath=ServiceWrapper_1.ServiceWrapper.isWhow&&TicketEndWrapper.latestWinAmount===0?"TicketFinish":"TicketEnd";$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+requestPath,data:parameters,timeout:1e4,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){TicketEndWrapper.pendingEnd=false;TicketWrapper_1.TicketWrapper.trySendPendingSpin();resolve(result)},error:function(jqXHR,exception){if(jqXHR.status===0||jqXHR.status===500||exception==="timeout"){TicketEndWrapper.pendingEnd=false;TicketWrapper_1.TicketWrapper.trySendPendingSpin()}resolve(null)}})})};TicketEndWrapper.request=function(id){var _this=this;return new Promise(function(resolve){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(_a){if(ServiceWrapper_1.ServiceWrapper.IsBspot){BSpotWrapper.ticketEnd();TicketWrapper_1.TicketWrapper.pendingSpin=false;TicketEndWrapper.pendingEnd=false;resolve()}else if(TicketEndWrapper.isActive&&TicketEndWrapper.pendingEnd&&!RespinWrapper_1.ReSpinWrapper.isInsideRespin()){TicketEndWrapper.sendAjaxRequest(id).then(function(i_Result){resolve()})}else{resolve()}return[2]})})})};TicketEndWrapper.pendingEnd=false;TicketEndWrapper.latestWinAmount=0;return TicketEndWrapper}();exports.TicketEndWrapper=TicketEndWrapper},{"./RespinWrapper":40,"./ServiceWrapper":41,"./StartTicketWrapper":42,"./TicketWrapper":46}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Definitions_1=require("../Definitions");var ExternalComponents_1=require("../ExternalComponents/ExternalComponents");var GameConfig_1=require("../GameConfig");var Logger_1=require("../Logger");var Utilities_1=require("../Utilities");var BalanceWrapper_1=require("./BalanceWrapper");var ErrorWrapper_1=require("./ErrorWrapper");var GameEvents_1=require("../GameEvents");var GambleWrapper_1=require("./GambleWrapper");var GolWrapper_1=require("./GolWrapper");var StartTicketWrapper_1=require("./StartTicketWrapper");var RespinWrapper_1=require("./RespinWrapper");var ServiceWrapper_1=require("./ServiceWrapper");var TicketEndWrapper_1=require("./TicketEndWrapper");var FreeSpinsPickerWrapper_1=require("./FreeSpinsPickerWrapper");var Events_1=require("../Events");var TicketWrapper=function(){function TicketWrapper(){}TicketWrapper.AdjustTicketResult=function(data){if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment&&TicketWrapper.ForceNextTicketError){data.Result=null;data.ResultInfo={Action:null,Code:123456789,Message:"",DisplayMessage:TicketWrapper.ErrorType,Buttons:[]};TicketWrapper.ForceNextTicketError=false}if(data!=null&&data.ResultInfo!=null&&data.ResultInfo.Code>0){data.ResultInfo=ErrorWrapper_1.ErrorWrapper.UpdateError(data.ResultInfo)}else if(data!=null&&data.ResultInfo!=null&&data.ResultInfo.Code===0){TicketWrapper.lastTicketId=data.Result.UniqueIdentifier;if(data.Result.FreeTickets!=null&&"Gamble"in data.Result.FreeTickets&&data.Result.FreeTickets.Gamble!=null){GambleWrapper_1.GambleWrapper.isActive=true}if(TicketWrapper.handleSticky){TicketWrapper.handleSticky=false;if(data.Result.StickyIcons!=null&&data.Result.StickyIcons.length>0){for(var i=0;i<data.Result.StickyIcons.length;i++){data.Result.StickyIcons[i].IsNew=true}}}if(GameConfig_1.GameConfig.isGameSupportingStickyFix()&&data.Result.FreeTickets.To===GameConfig_1.GameConfig.StickyConfig.FreeTicketsTo&&data.Result.FreeTickets.Type===GameConfig_1.GameConfig.StickyConfig.FreeSpinsType){for(var i=0;i<data.Result.Slot.length;i++){if(data.Result.Slot[i]===GameConfig_1.GameConfig.StickyConfig.Item){data.Result.StickyIcons.push({Place:i,Icon:GameConfig_1.GameConfig.StickyConfig.Item,SuperSticky:GameConfig_1.GameConfig.StickyConfig.SuperSticky,IsNew:GameConfig_1.GameConfig.StickyConfig.IsNew,Movement:{MoveFrom:i,MoveTo:i,Direction:GameConfig_1.GameConfig.StickyConfig.Direction}})}}ServiceWrapper_1.ServiceWrapper.logMessage(GameConfig_1.GameConfig.StickyConfig.Message,JSON.stringify(data.Result))}if(StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId===Definitions_1.ClassId.SlotMachine_BuffaloRampage){if(data.Result.FreeTickets&&data.Result.FreeTickets.Type===6&&data.Result.FreeTickets.To===1){data.Result.FreeTickets.To=0;data.Result.FreeTickets.From=0}}}if(ServiceWrapper_1.ServiceWrapper.IsBspot){data=BSpotWrapper.readTicket(data)}if(RespinWrapper_1.ReSpinWrapper.IsEnteringReSpin(ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,data)){RespinWrapper_1.ReSpinWrapper.EnterReSpin(data);data=RespinWrapper_1.ReSpinWrapper.AdjustRespinSpots(data);RespinWrapper_1.ReSpinWrapper.reSpinIndex++}return data};TicketWrapper.trySendPendingSpin=function(){if(TicketWrapper.pendingSpin){TicketWrapper.sendData(TicketWrapper.lastParams,TicketWrapper.lastOnSuccess)}};TicketWrapper.sendData=function(parameters,onSuccess){if(TicketWrapper.hasError){if(GolWrapper_1.GolWrapper.isActive){TicketWrapper.isPendingResponse=true;GolWrapper_1.GolWrapper.onMachineError()}return}TicketWrapper.playedOnce=true;var isInsideRespin=RespinWrapper_1.ReSpinWrapper.isInsideRespin();if(!isInsideRespin&&TicketEndWrapper_1.TicketEndWrapper.pendingEnd){TicketWrapper.lastParams=parameters;TicketWrapper.lastOnSuccess=onSuccess;TicketWrapper.pendingSpin=true;return}else if(GolWrapper_1.GolWrapper.isActive&&GolWrapper_1.GolWrapper.pendingEnd){TicketWrapper.lastParams=parameters;TicketWrapper.lastOnSuccess=onSuccess;TicketWrapper.pendingSpin=true;return}else{TicketWrapper.lastParams=null;TicketWrapper.lastOnSuccess=null;TicketWrapper.pendingSpin=false}var callBackFunc=function(data){TicketWrapper.latestTicket=data;if(data!=null&&data.ResultInfo.Code===0&&data.Result&&data.Result.PendingEnd){TicketEndWrapper_1.TicketEndWrapper.pendingEnd=true}Utilities_1.Utilities.SendC2Message(onSuccess,data);if(data!=null&&data.ResultInfo!=null&&(data.ResultInfo.Code===5014||data.ResultInfo.Code===6011)){BalanceWrapper_1.BalanceWrapper.requestBalance()}};if(isInsideRespin){RespinWrapper_1.ReSpinWrapper.ShowNextRespin(onSuccess)}else if(ServiceWrapper_1.ServiceWrapper.IsBspot&&BSpotWrapper.isInsideMultiRound){BSpotWrapper.readInsideRounds()}else if(ServiceWrapper_1.ServiceWrapper.IsBspot){var startLines=void 0;if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result){startLines=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.Lines}BSpotWrapper.getResult(TicketWrapper.sendRequestAjax,parameters,callBackFunc,onSuccess,startLines)}else{TicketWrapper.sendRequestAjax(parameters,callBackFunc,onSuccess)}};TicketWrapper.sendRequestAjax=function(parameters,onSuccess,onError){FreeSpinsPickerWrapper_1.FreeSpinsPickerWrapper.LatestTicketResult=null;if(GambleWrapper_1.GambleWrapper.isActive){ServiceWrapper_1.ServiceWrapper.LogError("Shouldn't send ticket when gamble wrapper is active!")}if(ExternalComponents_1.ExternalComponents.PromoTool&&ExternalComponents_1.ExternalComponents.PromoTool.IsRefreshNeededForTournamentStart){onSuccess(ErrorWrapper_1.ErrorWrapper.TournamentStartErrorTicket);return}if(!TicketWrapper.isPendingResponse){TicketWrapper.isPendingResponse=true;var data_1={gameToken:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.GameToken,gameCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.GameCode,partnerId:ServiceWrapper_1.ServiceWrapper.Info.UrlVars.PartnerId,langCode:ServiceWrapper_1.ServiceWrapper.Info.GameInfo.LoadedGameLanguage};if(StartTicketWrapper_1.StartTicketWrapper.startTicket&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result&&StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId){data_1.classId=StartTicketWrapper_1.StartTicketWrapper.startTicket.Result.ClassId}if(ServiceWrapper_1.ServiceWrapper.playerId!==undefined){data_1.playerId=ServiceWrapper_1.ServiceWrapper.playerId}if(ServiceWrapper_1.ServiceWrapper.externalId!==undefined){data_1.externalId=ServiceWrapper_1.ServiceWrapper.externalId}if(ServiceWrapper_1.ServiceWrapper.platformId!==undefined){data_1.platformId=ServiceWrapper_1.ServiceWrapper.platformId}if(ServiceWrapper_1.ServiceWrapper.subPlatformId!==undefined){data_1.subPlatformId=ServiceWrapper_1.ServiceWrapper.subPlatformId}if(ServiceWrapper_1.ServiceWrapper.currency!==undefined){data_1.CurrencyCode=ServiceWrapper_1.ServiceWrapper.currency}if(ServiceWrapper_1.ServiceWrapper.lobbyToken!==undefined){data_1.lobbyToken=ServiceWrapper_1.ServiceWrapper.lobbyToken}if(ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode){data_1.originalLangCode=ServiceWrapper_1.ServiceWrapper.paramJson.originalLangCode}if(parameters.indexOf("&")!==-1){var dataParam=ServiceWrapper_1.ServiceWrapper.getParamsVars(parameters);data_1.autoPlay=dataParam["autoPlay"];data_1.bet=dataParam["bet"];data_1.fastPlay=dataParam["fastPlay"];data_1.forceTicket=dataParam["forceTicket"];if(parameters.indexOf("promotion")!==-1){data_1.promotion=dataParam["promotion"]}if(parameters.indexOf("lines")!==-1){data_1.lines=dataParam["lines"]}if(parameters.indexOf("subGameId")!==-1){data_1.subGameId=dataParam["subGameId"]}if(parameters.indexOf("betMultiplier")!==-1){data_1.betMultiplier=dataParam["betMultiplier"]}if(parameters.indexOf("freeTicket")!==-1){data_1.freeTicket=dataParam["freeTicket"]}if(parameters.indexOf("isRetroBetOn")!==-1){data_1.isRetroBetOn=dataParam["isRetroBetOn"]}if(parameters.indexOf("symbolVariation")!==-1){data_1.symbolVariation=dataParam["symbolVariation"]}}else{var jsonData=JSON.parse(parameters);data_1.autoPlay=jsonData.autoPlay;data_1.bet=jsonData.bet;data_1.fastPlay=jsonData.fastPlay;data_1.forceTicket=jsonData.forceTicket;if("promotion"in jsonData){data_1.promotion=jsonData.promotion}if("lines"in jsonData){data_1.lines=jsonData.lines}if("subGameId"in jsonData){data_1.subGameId=jsonData.subGameId}if("betMultiplier"in jsonData){data_1.betMultiplier=jsonData.betMultiplier}if("freeTicket"in jsonData){data_1.freeTicket=jsonData.freeTicket}if("RouletteInput"in jsonData){data_1.RouletteInput=jsonData.RouletteInput}if("isRetroBetOn"in jsonData){data_1.isRetroBetOn=jsonData.isRetroBetOn}if("symbolVariation"in jsonData){data_1.symbolVariation=jsonData.symbolVariation}}data_1.autoPlay=data_1.autoPlay===1||data_1.autoPlay==="1"||data_1.autoPlay===true;data_1.fastPlay=data_1.fastPlay===1||data_1.fastPlay==="1"||data_1.fastPlay===true;if(ServiceWrapper_1.ServiceWrapper.IsBspot){if(typeof BSpotWrapper.activeTokens!=="undefined"&&BSpotWrapper.activeTokens){var token=BSpotWrapper.activeTokens[0];if(typeof token!=="undefined"&&token){data_1.WinAmount=Number(token.value);data_1.TokenId=token.id}}if(typeof BSpotWrapper.balances!=="undefined"&&BSpotWrapper.balances&&BSpotWrapper.balances.availableGameplayBalance){data_1.AvailableBalance=Number(BSpotWrapper.balances.availableGameplayBalance)}}if(ServiceWrapper_1.ServiceWrapper.IsDebugEnvironment&&window.DebugWrapper){var ticket=window.DebugWrapper.getTicket();if(ticket){data_1.debugData=JSON.stringify(ticket);if(ticket.freeSpinAmount){FreeSpinsPickerWrapper_1.FreeSpinsPickerWrapper.forceAmountOfFreeSpin=ticket.freeSpinAmount}if(ticket.freeSpinType){FreeSpinsPickerWrapper_1.FreeSpinsPickerWrapper.forceResult=ticket.freeSpinType}if(ticket.gambleWinsNumber){GambleWrapper_1.GambleWrapper.forceResult=ticket.gambleWinsNumber}}}var action_1="ProcessSlotMachine";if(data_1.gameCode.startsWith("Table_")){action_1="ProcessTableGame"}else if(data_1.gameCode.startsWith("Lottery_")){action_1="ProcessLotteryGame"}if(ExternalComponents_1.ExternalComponents.PromoTool){if(ExternalComponents_1.ExternalComponents.PromoTool.BonusPlayerId){data_1.bonusPlayerId=ExternalComponents_1.ExternalComponents.PromoTool.BonusPlayerId}if(ExternalComponents_1.ExternalComponents.PromoTool.BonusCampaignToken){data_1.bonusCampaignToken=ExternalComponents_1.ExternalComponents.PromoTool.BonusCampaignToken}}if(GolWrapper_1.GolWrapper.isActive){data_1.balance=GolWrapper_1.GolWrapper.getBalance();data_1.IsGol=true}try{Logger_1.Logger.DefineAnalyticsRequest("ReadTicketData",data_1)}catch(err){}GameEvents_1.GameEvents.RoundStart(data_1.bet);if(ExternalComponents_1.ExternalComponents.PromoTool){ExternalComponents_1.ExternalComponents.PromoTool.OnSpin()}var betToDisplay=data_1.bet;if(data_1.lines){betToDisplay*=data_1.lines}if(ExternalComponents_1.ExternalComponents.BetSlip)ExternalComponents_1.ExternalComponents.BetSlip.Show(betToDisplay,ExternalComponents_1.ExternalComponents.Timer.GetLocaleString());var timeBeforeRequest_1=performance.now();$.ajax({url:ServiceWrapper_1.ServiceWrapper.baseUrl+action_1,data:JSON.stringify(data_1),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",timeout:3e4,success:function(result){var timeOnResponse=performance.now();var totalRequestTime=timeOnResponse-timeBeforeRequest_1;var onResult=function(){try{Logger_1.Logger.DefineAnalyticsResponse(onSuccess,result)}catch(err){}if("promotion"in data_1&&result!=null&&result.ResultInfo!=null&&result.ResultInfo.Code>0){result.ResultInfo.DisplayMessage="TEMPORARY_ERROR"}if(GolWrapper_1.GolWrapper.isActive&&result!=null&&result.ResultInfo.Code===0){GolWrapper_1.GolWrapper.OnProcessTicketReceived(action_1,result)}if(result.Result){GameEvents_1.GameEvents.RoundStarted(result.Result.CoinIn);TicketEndWrapper_1.TicketEndWrapper.latestWinAmount=result.Result.Win}result=TicketWrapper.AdjustTicketResult(result);onSuccess(result);GameEvents_1.GameEvents.BetPlaced(result.Result.TotalBetPlaced,"normal");if(typeof GameEvents_1.GameEvents.MessageTrigger==="function")GameEvents_1.GameEvents.MessageTrigger(result);TicketWrapper.isPendingResponse=false;GameEvents_1.GameEvents.TicketReceived(result);TicketWrapper.eOnProcessTicketReceived.Trigger(result)};if(ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo&&ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.MinSpinTime&&result.Result.TotalBetPlaced!=0){var ticketDelayTime=ServiceWrapper_1.ServiceWrapper.Info.EnvironmentInfo.MinSpinTime-totalRequestTime;if(!ticketDelayTime||ticketDelayTime<0){ticketDelayTime=0}setTimeout(function(){onResult()},ticketDelayTime)}else{onResult()}},error:function(jqXHR,exception,error){ErrorWrapper_1.ErrorWrapper.HandleError(jqXHR,exception,onError);if(jqXHR.status===0||jqXHR.status===500||exception==="timeout"){TicketWrapper.isPendingResponse=false;ServiceWrapper_1.ServiceWrapper.LogError(error)}}})}};TicketWrapper.eOnProcessTicketReceived=new Events_1.GenericEvent;TicketWrapper.pendingSpin=false;TicketWrapper.isPendingResponse=false;TicketWrapper.lastParams=null;TicketWrapper.latestTicket=null;TicketWrapper.lastOnSuccess=null;TicketWrapper.playedOnce=false;TicketWrapper.isAutoPlay=false;TicketWrapper.retryCounter=0;TicketWrapper.lastTicketId=0;TicketWrapper.handleSticky=false;TicketWrapper.ForceNextTicketError=false;TicketWrapper.ErrorType="TEMPORARY_ERROR";TicketWrapper.hasError=false;TicketWrapper.errorCode="";return TicketWrapper}();exports.TicketWrapper=TicketWrapper},{"../Definitions":5,"../Events":7,"../ExternalComponents/ExternalComponents":8,"../GameConfig":19,"../GameEvents":20,"../Logger":21,"../Utilities":22,"./BalanceWrapper":25,"./ErrorWrapper":30,"./FreeSpinsPickerWrapper":31,"./GambleWrapper":33,"./GolWrapper":36,"./RespinWrapper":40,"./ServiceWrapper":41,"./StartTicketWrapper":42,"./TicketEndWrapper":45}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var StartTicketWrapper_1=require("./StartTicketWrapper");var TimeWrapper=function(){function TimeWrapper(){var _this=this;this.FUN_MODE_DATE="0001-01-01T00:00:00";StartTicketWrapper_1.StartTicketWrapper.eOnStartTicketSet.Once(function(){var _a,_b;_this.OnStartTicketReceived((_b=(_a=StartTicketWrapper_1.StartTicketWrapper.startTicket)===null||_a===void 0?void 0:_a.Result)===null||_b===void 0?void 0:_b.StartDateTime)})}TimeWrapper.prototype.OnStartTicketReceived=function(i_TimeFromServer){if(i_TimeFromServer&&i_TimeFromServer!==this.FUN_MODE_DATE){this.m_StartDateFromServer=new Date(i_TimeFromServer)}this.m_PrevClientDate=new Date};TimeWrapper.prototype.GetCurrentTime=function(i_Format){var _this=this;return new Promise(function(resolve){if(!_this.m_StartDateFromServer){_this.m_StartDateFromServer=new Date;_this.m_PrevClientDate=new Date}var currentDate=new Date;var timePassed=currentDate.getTime()-_this.m_PrevClientDate.getTime();_this.m_StartDateFromServer=new Date(_this.m_StartDateFromServer.getTime()+timePassed);_this.m_PrevClientDate=new Date;var time=_this.m_StartDateFromServer.toTimeString().split(" ")[0];resolve(time.split(":")[0]+":"+time.split(":")[1])})};TimeWrapper.prototype.GetLocaleString=function(){var currentDate=new Date;var timePassed=currentDate.getTime()-this.m_PrevClientDate.getTime();if(!this.m_StartDateFromServer){this.m_StartDateFromServer=new Date}this.m_StartDateFromServer=new Date(this.m_StartDateFromServer.getTime()+timePassed);this.m_PrevClientDate=new Date;return this.m_StartDateFromServer.toLocaleString()};return TimeWrapper}();exports.TimeWrapper=TimeWrapper},{"./StartTicketWrapper":42}]},{},[2,41]);
